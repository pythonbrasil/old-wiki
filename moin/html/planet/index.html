<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Planeta PythonBrasil</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="generator" content="Planet/2.0 +http://www.planetplanet.org">
    <link rel="stylesheet" href="planet.css" type="text/css">
      <link rel="alternate" 
            href="http://wiki.python.org.br/planet/atom.xml"
	    title=""
	    type="application/atom+xml">
  </head>

<body>
  <h1>
    <span class="logo">
      <a href="http://www.python.org.br/" title="PythonBrasil">
        <img src="/pybr/img/pythonbrasil_logo.png" alt="PythonBrasil" />
      </a>
    </span>
Planeta PythonBrasil  </h1>

<div align="center">
<a href="http://2014.pythonbrasil.org.br/" title="PythonBrasil[10]"> 
<img src="https://pybr.s3.amazonaws.com/static/images/header/pybr_logo_pt-br.png" alt="PythonBrasil[10]" />
</a>
</div>

      <div class="daygroup">
      <h2>August 19, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://www.vinta.com.br/blog/category/python/"
	   title="Vinta's Blog Python Tag">
Vinta Software	</a>
      </h3>


    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/80PyBay 2019: Talking about Python in SF80"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2019/pybay-2019/">
PyBay 2019: Talking about Python in SF	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
We are back to San Francisco! Our team will be joining PyBay's conference, one of the biggest Python events in the Bay Area. For this year, we'll be giving the talk: Building effective Django queries with expressions.
PyBay has been a fantastic place to meet new people, connect with new ideas, and integrate this thriving community. 
Here is the sl      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2019/pybay-2019/">
19 de August de 2019 &#224;s 19:55	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 08, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://humberto.io/pt-br/tags/python/"
	   title="python on Humberto Rocha">
Humberto Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="https://humberto.io/pt-br/blog/libs-fantasticas/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://humberto.io/pt-br/blog/libs-fantasticas/">
Libs Fant&#225;sticas: pipx	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Estou come&#231;ando esta s&#233;rie para dar dicas sobre bibliotecas que podem ser muito &#250;teis no seu dia a dia, e tamb&#233;m para apresentar bibliotecas interessantes nas quais que voc&#234; deveria ficar de olho.
Uma das habilidades de um bom Programador &#233; ter a ferramenta certa para realizar seu trabalho, e nada mais apropriado que come&#231;ar esta s&#233;rie com uma ferramenta que instala outras ferramentas!
Quantas vezes voc&#234; j&#225; teve que instalar algum programa Python em uma virtualenv que voc&#234; acabou de criar?      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://humberto.io/pt-br/blog/libs-fantasticas/">
08 de August de 2019 &#224;s 03:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 07, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://www.vinta.com.br/blog/category/python/"
	   title="Vinta's Blog Python Tag">
Vinta Software	</a>
      </h3>


    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/120Happython 2019!120"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/happython-2019/">
Happython 2019!	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Happy PyHolidays and Happy New Year!
We are approaching the end of the year 2018! And as it turns out this was an incredible year for Python! Even though Guido stepped out of his role as BDFL (this alone is worth a couple of blogposts so this one will not extend the discussion), there are a lot of happy recollections from this year. In 2017 StackO      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/happython-2019/">
07 de August de 2019 &#224;s 21:37	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/116[pt-BR] PythonBrasil[14] talks116"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/pt-br-pythonbrasil14-talks/">
[pt-BR] PythonBrasil[14] talks	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Slides from talks given during the PythonBrasil[14] event will be posted here. This post and the slides are written in Brazilian Portuguese.

Como Programar seu Processo de Software

Palestrante: Robertson Novelino
Link dos Slides: Como Programar seu Processo de Software

Todos usamos um m&#233;todo para programar, uma forma que n&#243;s gostamos de fazer as      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/pt-br-pythonbrasil14-talks/">
07 de August de 2019 &#224;s 21:37	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/82PyGotham 2018 Talks82"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/pygotham-2018-talks/">
PyGotham 2018 Talks	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Critical Incidents: a guide for developers

Presenter: Lais Varej&#227;o
Slides: http://bit.ly/critical-incidents-guide

Pluggable Libs Through Design Patterns

Presenter: Filipe Ximenes
Video: https://www.youtube.com/watch?v=PfgEU3W0kyU
Slides: http://bit.ly/pluggable-libs
Examples: https://github.com/filipeximenes/talk-design-patterns

1 + 1 = 1 or Re      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/pygotham-2018-talks/">
07 de August de 2019 &#224;s 21:37	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 12, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://humberto.io/pt-br/tags/python/"
	   title="python on Humberto Rocha">
Humberto Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="https://humberto.io/pt-br/blog/tldr-gerando-secret-key-para-o-django/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://humberto.io/pt-br/blog/tldr-gerando-secret-key-para-o-django/">
TLDR: Gerando Secret Key para o Django	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Levante a m&#227;o quem nunca versionou a SECRET_KEY do Django no in&#237;cio de um projeto e precisou gerar uma nova na hora de subir pra produ&#231;&#227;o.
Este TLDR &#233; um lembrete r&#225;pido de como voc&#234; pode regerar uma secret key localmente, sem recorrer a sites na internet para gera-la para voc&#234;.
Como o Django gera a secret key no in&#237;cio de um projeto, j&#225; existe esta fun&#231;&#227;o implementada em seu c&#243;digo e voc&#234; pode acess&#225;-la desta forma:      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://humberto.io/pt-br/blog/tldr-gerando-secret-key-para-o-django/">
12 de July de 2019 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 07, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/trocando-forma-de-pensar-mudando-mindset-de-empres%C3%A1rio-para-empregado/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/xxGg2K_6G2Y/">
Trocando forma de pensar (mudando mindset) de empres&#225;rio para 'empregado'	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Se ainda n&#227;o me conhece empreendi desde 2011 at&#233; junho/2019 e resolvi voltar para o mercado de trabalho e n&#227;o &#233; por motivos que quebrei financeiramente, indo na contram&#227;o do hype de startups.
Acredito que surgiu diversas perguntas em sua cabe&#231;a ao ler o texto acima, acredite que na minha cabe&#231;a foram longos meses (quase 1 ano) refletindo sobre o assunto, colocando no papel os pr&#243;s e contras, imaginando como seria, como me portaria em algumas situa&#231;&#245;es at&#233; que por fim resolvi experimentar um ambiente novo, &#8220;desconhecido&#8221; e acredito que seja desafiador (pelo menos para mim).<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/xxGg2K_6G2Y" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/xxGg2K_6G2Y/">
07 de July de 2019 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>June 25, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://pythonclub.com.br/"
	   title="PythonClub">
PythonClub	</a>
      </h3>


    <div class="entrygroup"
         id="tag:pythonclub.com.br,2019-06-24:/tutorial-django-2.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://pythonclub.com.br/tutorial-django-2.html">
Tutorial Django 2.2	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Este tutorial &#233; baseado no <strong>Intro to Django</strong> que fica na parte de baixo da p&#225;gina <a href="https://www.djangoproject.com/start/">start</a> do Django project.</p>
<p>At&#233; a data deste post o Django est&#225; na vers&#227;o 2.2.2, e requer Python 3.</p>
<h2>O que voc&#234; precisa?</h2>
<p>Python 3.6 ou superior, pip e virtualenv.</p>
<p>Considere que voc&#234; tenha instalado Python 3.6 ou superior, <a href="https://pip.readthedocs.io/en/latest/">pip</a> e <a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>.</p>
<h2>Criando o ambiente</h2>
<p>Crie uma pasta com o nome <code>django2-pythonclub</code></p>
<div class="highlight"><pre><span></span>$ mkdir django2-pythonclub
$ <span class="nb">cd</span> django2-pythonclub
</pre></div>


<p>A partir de agora vamos considerar esta como a nossa pasta principal.</p>
<p>Considerando que voc&#234; est&#225; usando <strong>Python 3</strong>, digite</p>
<div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="p">.</span><span class="n">venv</span>
</pre></div>


<p>Lembre-se de colocar esta pasta no seu <code>.gitignore</code>, caso esteja usando.</p>
<div class="highlight"><pre><span></span><span class="n">echo</span> <span class="p">.</span><span class="n">venv</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="n">gitignore</span>
</pre></div>


<p>Depois ative o ambiente digitando</p>
<div class="highlight"><pre><span></span><span class="k">source</span> <span class="p">.</span><span class="n">venv</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>


<blockquote>
<p>Lembre-se, sempre quando voc&#234; for mexer no projeto, tenha certeza de ter ativado o <code>virtualenv</code>, executando o comando <code>source .venv/bin/activate</code>. Voc&#234; deve repetir esse comando toda a vez que voc&#234; abrir um novo terminal.</p>
</blockquote>
<h2>Instalando Django 2.2.2</h2>
<p>Basta digitar</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span><span class="o">==</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span>
</pre></div>


<p>Dica: se voc&#234; digitar <code>pip freeze</code> voc&#234; ver&#225; a vers&#227;o dos programas instalados.</p>
<p>&#201; recomend&#225;vel que voc&#234; atualize a vers&#227;o do <code>pip</code></p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">pip</span>
</pre></div>


<p>Se der erro ent&#227;o fa&#231;a:</p>
<div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="c1">--upgrade pip</span>
</pre></div>


<h2>Instalando mais depend&#234;ncias</h2>
<p>Eu gosto de usar o <a href="https://django-extensions.readthedocs.io/en/latest/">django-extensions</a> e o <a href="https://github.com/jazzband/django-widget-tweaks">django-widget-tweaks</a>, ent&#227;o digite</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span><span class="o">-</span><span class="n">extensions</span> <span class="n">django</span><span class="o">-</span><span class="n">widget</span><span class="o">-</span><span class="n">tweaks</span> <span class="n">python</span><span class="o">-</span><span class="n">decouple</span>
</pre></div>


<p><strong>Importante:</strong> voc&#234; precisa criar um arquivo <code>requirements.txt</code> para instala&#231;&#245;es futuras do projeto em outro lugar.</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="k">freeze</span> <span class="o">&gt;</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
</pre></div>


<p>Este &#233; o resultado do meu at&#233; o dia deste post:</p>
<div class="highlight"><pre><span></span><span class="p">(.</span><span class="n">venv</span><span class="p">):</span><span class="err">$</span> <span class="n">cat</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span> 

<span class="n">django</span><span class="o">-</span><span class="n">extensions</span><span class="o">==</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">6</span>
<span class="n">django</span><span class="o">-</span><span class="n">widget</span><span class="o">-</span><span class="n">tweaks</span><span class="o">==</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">3</span>
<span class="n">python</span><span class="o">-</span><span class="n">decouple</span><span class="o">==</span><span class="mi">3</span><span class="p">.</span><span class="mi">1</span>
<span class="n">pytz</span><span class="o">==</span><span class="mi">2018</span><span class="p">.</span><span class="mi">9</span>
<span class="n">six</span><span class="o">==</span><span class="mi">1</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">0</span>
</pre></div>


<h2>Escondendo a SECRET_KEY e trabalhando com vari&#225;veis de ambiente</h2>
<p>&#201; muito importante que voc&#234; n&#227;o deixe sua SECRET_KEY exposta. Ent&#227;o remova-o imediatamente do seu settings.py ANTES mesmo do primeiro commit. Espero que voc&#234; esteja usando Git.</p>
<p>Vamos usar o <a href="https://github.com/henriquebastos/python-decouple">python-decouple</a> escrito por <a href="https://henriquebastos.net/">Henrique Bastos</a> para gerenciar nossas vari&#225;veis de ambiente. Repare que j&#225; instalamos ele logo acima.</p>
<p>Em seguida voc&#234; vai precisar criar um arquivo <code>.env</code>, para isso rode o comando a seguir, ele vai criar uma pasta contrib e dentro dele colocar um arquivo <code>env_gen.py</code></p>
<div class="highlight"><pre><span></span><span class="k">if</span> [ <span class="o">!</span> <span class="o">-</span><span class="nv">d</span> <span class="nv">contrib</span> ]<span class="c1">; then mkdir contrib; fi; git clone https://gist.github.com/22626de522f5c045bc63acdb8fe67b24.git contrib/</span>
<span class="nv">rm</span> <span class="o">-</span><span class="nv">rf</span> <span class="nv">contrib</span><span class="o">/</span>.<span class="nv">git</span><span class="o">/</span>  # <span class="nv">remova</span> <span class="nv">a</span> <span class="nv">pasta</span> .<span class="nv">git</span> <span class="nv">que</span> <span class="nv">est</span>&#225; <span class="nv">dentro</span> <span class="nv">de</span> <span class="nv">contrib</span>.
</pre></div>


<p>Em seguida rode</p>
<div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">contrib</span><span class="o">/</span><span class="n">env_gen</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<p>que ele vai criar o arquivo <code>.env</code>.</p>
<p>Supondo que voc&#234; est&#225; versionando seu c&#243;digo com Git, &#233; importante que voc&#234; escreva isso dentro do seu arquivo <code>.gitignore</code>, fa&#231;a direto pelo terminal</p>
<div class="highlight"><pre><span></span><span class="n">echo</span> <span class="p">.</span><span class="n">env</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="n">gitignore</span>
<span class="n">echo</span> <span class="p">.</span><span class="n">venv</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="n">gitignore</span>
<span class="n">echo</span> <span class="s1">'*.sqlite3'</span> <span class="o">&gt;&gt;</span> <span class="p">.</span><span class="n">gitignore</span>
</pre></div>


<p>Pronto, agora voc&#234; pode dar o primeiro commit.</p>
<h2>Criando o projeto e a App</h2>
<p>Para criar o projeto digite</p>
<div class="highlight"><pre><span></span>$ django-admin startproject myproject .
</pre></div>


<p>repare no ponto no final do comando, isto permite que o arquivo <code>manage.py</code> fique nesta mesma pasta <em>django2-pythonclub</em> .</p>
<p>Agora vamos criar a <em>app</em> <strong>bands</strong>, mas vamos deixar esta <em>app</em> dentro da pasta <em>myproject</em>. Ent&#227;o entre na pasta</p>
<div class="highlight"><pre><span></span>$ <span class="nb">cd</span> myproject
</pre></div>


<p>e digite</p>
<div class="highlight"><pre><span></span>$ python ../manage.py startapp bands
</pre></div>


<p>A inten&#231;&#227;o &#233; que os arquivos tenham a seguinte hierarquia nas pastas:</p>
<div class="highlight"><pre><span></span><span class="p">.</span>
<span class="err">&#9500;&#9472;&#9472;</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9500;&#9472;&#9472;</span> <span class="n">myproject</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">bands</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="k">admin</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">apps</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">models</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">tests</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9492;&#9472;&#9472;</span> <span class="n">views</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">settings</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9500;&#9472;&#9472;</span> <span class="n">urls</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9474;&#160;&#160;</span> <span class="err">&#9492;&#9472;&#9472;</span> <span class="n">wsgi</span><span class="p">.</span><span class="n">py</span>
<span class="err">&#9492;&#9472;&#9472;</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
</pre></div>


<p>Agora permane&#231;a sempre na pasta <code>django2-pythonclub</code></p>
<div class="highlight"><pre><span></span><span class="n">cd</span> <span class="p">..</span>
</pre></div>


<p>e digite</p>
<div class="highlight"><pre><span></span>$ python manage.py migrate
</pre></div>


<p>para criar a primeira <em>migra&#231;&#227;o</em> (isto cria o banco de dados SQLite), e depois rode a aplica&#231;&#227;o com</p>
<div class="highlight"><pre><span></span>$ python manage.py runserver
</pre></div>


<p>e veja que a aplica&#231;&#227;o j&#225; est&#225; funcionando. Veja o endere&#231;o da url aqui</p>
<div class="highlight"><pre><span></span><span class="n">Django</span> <span class="k">version</span> <span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="k">using</span> <span class="n">settings</span> <span class="s1">'myproject.settings'</span>
<span class="n">Starting</span> <span class="n">development</span> <span class="n">server</span> <span class="k">at</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span>
<span class="n">Quit</span> <span class="n">the</span> <span class="n">server</span> <span class="k">with</span> <span class="n">CONTROL</span><span class="o">-</span><span class="k">C</span><span class="p">.</span>
</pre></div>


<h2>Editando settings.py</h2>
<p>Em <code>INSTALLED_APPS</code> acrescente as linhas abaixo.</p>
<div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">...</span>
    <span class="s1">'widget_tweaks'</span><span class="p">,</span>
    <span class="s1">'django_extensions'</span><span class="p">,</span>
    <span class="s1">'myproject.bands'</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>


<p>E mude tamb&#233;m o idioma.</p>
<p><code>LANGUAGE_CODE = 'pt-br'</code></p>
<p>E caso voc&#234; queira o mesmo hor&#225;rio de Bras&#237;lia-BR</p>
<p><code>TIME_ZONE = 'America/Sao_Paulo'</code></p>
<p>J&#225; que falamos do python-decouple, precisamos de mais alguns ajustes</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decouple</span> <span class="kn">import</span> <span class="n">config</span><span class="p">,</span> <span class="n">Csv</span>

<span class="c1"># SECURITY WARNING: keep the secret key used in production secret!</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">'SECRET_KEY'</span><span class="p">)</span>

<span class="c1"># SECURITY WARNING: don't run with debug turned on in production!</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">'DEBUG'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">'ALLOWED_HOSTS'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[],</span> <span class="n">cast</span><span class="o">=</span><span class="n">Csv</span><span class="p">())</span>
</pre></div>


<p>Veja que &#233; importante manter sua SECRET_KEY bem guardada (em outro lugar).</p>
<p>Ent&#227;o crie um arquivo <code>.env</code> e guarde sua SECRET_KEY dentro dele, exemplo:</p>
<div class="highlight"><pre><span></span><span class="n">SECRET_KEY</span><span class="o">=</span><span class="n">your_secret_key</span>
<span class="n">DEBUG</span><span class="o">=</span><span class="k">True</span>
<span class="n">ALLOWED_HOSTS</span><span class="o">=</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,.</span><span class="n">localhost</span>
</pre></div>


<h2>Editando models.py</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>


<span class="k">class</span> <span class="nc">Band</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A model of a rock band.&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">can_rock</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'name'</span><span class="p">,)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s1">'band'</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s1">'bands'</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># retorna a url no formato /bands/1/</span>
        <span class="k">return</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'band_detail'</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">'pk'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">get_members_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># count members by band</span>
        <span class="c1"># conta os membros por banda</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">band</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Member</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A model of a rock band member.&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;Member's name&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">instrument</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">(</span>
        <span class="p">(</span><span class="s1">'g'</span><span class="p">,</span> <span class="s2">&quot;Guitar&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'b'</span><span class="p">,</span> <span class="s2">&quot;Bass&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="s2">&quot;Drums&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'v'</span><span class="p">,</span> <span class="s2">&quot;Vocal&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'p'</span><span class="p">,</span> <span class="s2">&quot;Piano&quot;</span><span class="p">),</span>
    <span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="n">band</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;Band&quot;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">'band'</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'name'</span><span class="p">,)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s1">'member'</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s1">'members'</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</pre></div>


<p>Tem algumas coisas que eu n&#227;o estou explicando aqui para o tutorial ficar curto, mas uma coisa importante &#233; que, como n&#243;s editamos o models.py vamos precisar criar um arquivo de migra&#231;&#227;o do novo modelo. Para isso digite</p>
<div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">makemigrations</span>
<span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">migrate</span>
</pre></div>


<p>O primeiro comando cria o arquivo de migra&#231;&#227;o e o segundo o executa, criando as tabelas no banco de dados.</p>
<h2>Editando urls.py</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">myproject.bands</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">v</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s1">'bands'</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'home'</span><span class="p">),</span>
    <span class="c1"># path('bands/', v.band_list, name='bands'),</span>
    <span class="c1"># path('bands/&lt;int:pk&gt;/', v.band_detail, name='band_detail'),</span>
    <span class="c1"># path('bandform/', v.BandCreate.as_view(), name='band_form'),</span>
    <span class="c1"># path('memberform/', v.MemberCreate.as_view(), name='member_form'),</span>
    <span class="c1"># path('contact/', v.band_contact, name='contact'),</span>
    <span class="c1"># path('protected/', v.protected_view, name='protected'),</span>
    <span class="c1"># path('accounts/login/', v.message),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">'admin/'</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Obs: deixei as demais urls comentada porque precisa da fun&#231;&#227;o em views.py para que cada url funcione. Descomente cada url somente depois que voc&#234; tiver definido a fun&#231;&#227;o em classe em views.py a seguir.</p>
<h2>Editando views.py</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="kn">import</span> <span class="n">login_required</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">CreateView</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Band</span><span class="p">,</span> <span class="n">Member</span>
<span class="c1"># from .forms import BandContactForm, BandForm, MemberForm</span>
</pre></div>


<p>Obs: Deixei a &#250;ltima linha comentada porque ainda n&#227;o chegamos em forms.</p>
<p>A fun&#231;&#227;o a seguir retorna um <strong>HttpResponse</strong>, ou seja, uma mensagem simples no navegador.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">'Welcome to the site!'</span><span class="p">)</span>
</pre></div>


<p>A pr&#243;xima fun&#231;&#227;o (use uma ou outra) renderiza um template, uma p&#225;gina html no navegador.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'home.html'</span><span class="p">)</span>
</pre></div>


<p>A fun&#231;&#227;o <code>band_list</code> retorna todas as bandas.</p>
<p>Para fazer a <strong>busca</strong> por nome de banda usamos o comando <code>search = request.GET.get('search_box')</code>, onde <code>search_box</code> &#233; o nome do campo no template <strong>band_list.html</strong>.</p>
<p>E os nomes s&#227;o retornados a partir do comando <code>bands = bands.filter(name__icontains=search)</code>. Onde <code>icontains</code> procura um texto que cont&#233;m a palavra, ou seja, voc&#234; pode digitar o nome incompleto (ignora mai&#250;sculo ou min&#250;sculo).</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">band_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A view of all bands. &quot;&quot;&quot;</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">search</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'search_box'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">search</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="n">bands</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__icontains</span><span class="o">=</span><span class="n">search</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'bands/band_list.html'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'bands'</span><span class="p">:</span> <span class="n">bands</span><span class="p">})</span>
</pre></div>


<p>Em urls.py pode descomentar a linha a seguir:</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">'bands/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">band_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'bands'</span><span class="p">),</span>
</pre></div>


<p>A fun&#231;&#227;o <code>band_contact</code> mostra como tratar um formul&#225;rio na view. Esta fun&#231;&#227;o requer <code>BandContactForm</code>, explicado em forms.py.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">band_contact</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A example of form &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">'POST'</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">BandContactForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">BandContactForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'bands/band_contact.html'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'form'</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</pre></div>


<p>Em urls.py pode descomentar a linha a seguir:</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">'contact/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">band_contact</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'contact'</span><span class="p">),</span>
</pre></div>


<p>A fun&#231;&#227;o <code>band_detail</code> retorna todos os membros de cada banda, usando o <code>pk</code> da banda junto com o comando <code>filter</code> em members.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">band_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A view of all members by bands. &quot;&quot;&quot;</span>
    <span class="n">band</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
    <span class="n">members</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">band</span><span class="o">=</span><span class="n">band</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'members'</span><span class="p">:</span> <span class="n">members</span><span class="p">,</span> <span class="s1">'band'</span><span class="p">:</span> <span class="n">band</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'bands/band_detail.html'</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>


<p>Em urls.py pode descomentar a linha a seguir:</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">'bands/&lt;int:pk&gt;/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">band_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'band_detail'</span><span class="p">),</span>
</pre></div>


<p><code>BandCreate</code> e <code>MemberCreate</code> usam o <a href="https://docs.djangoproject.com/en/2.2/ref/class-based-views/">Class Based View</a> para tratar formul&#225;rio de uma forma mais simplificada usando a classe <code>CreateView</code>. O <code>reverse_lazy</code> serve para tratar a url de retorno de p&#225;gina.</p>
<p>As classes a seguir requerem <code>BandForm</code> e <code>MemberForm</code>, explicado em forms.py.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BandCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Band</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">BandForm</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'bands/band_form.html'</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'bands'</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MemberCreate</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Member</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">MemberForm</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'bands/member_form.html'</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'bands'</span><span class="p">)</span>
</pre></div>


<p>Em urls.py pode descomentar a linha a seguir:</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">'bandform/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">BandCreate</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'band_form'</span><span class="p">),</span>
<span class="n">path</span><span class="p">(</span><span class="s1">'memberform/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">MemberCreate</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'member_form'</span><span class="p">),</span>
</pre></div>


<p>A pr&#243;xima fun&#231;&#227;o requer que voc&#234; entre numa p&#225;gina somente quando estiver logado.</p>
<p><code>[@login_required](https://docs.djangoproject.com/en/2.2/topics/auth/default/#the-login-required-decorator)</code> &#233; um <strong>decorator</strong>.</p>
<p><code>login_url='/accounts/login/'</code> &#233; p&#225;gina de erro, ou seja, quando o usu&#225;rio n&#227;o conseguiu logar.</p>
<p>E <code>render(request, 'bands/protected.html',...</code> &#233; p&#225;gina de sucesso.</p>
<div class="highlight"><pre><span></span><span class="nd">@login_required</span><span class="p">(</span><span class="n">login_url</span><span class="o">=</span><span class="s1">'/accounts/login/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">protected_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A view that can only be accessed by logged-in users &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">'bands/protected.html'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'current_user'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">})</span>
</pre></div>


<p><code>HttpResponse</code> retorna uma mensagem simples no navegador sem a necessidade de um template.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Message if is not authenticated. Simple view! &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">'Access denied!'</span><span class="p">)</span>
</pre></div>


<p>Em urls.py pode descomentar a linha a seguir:</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">'protected/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">protected_view</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'protected'</span><span class="p">),</span>
<span class="n">path</span><span class="p">(</span><span class="s1">'accounts/login/'</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">message</span><span class="p">),</span>
</pre></div>


<h2>Comandos b&#225;sicos do manage.py</h2>
<p>Para criar novas migra&#231;&#245;es com base nas altera&#231;&#245;es feitas nos seus modelos</p>
<p><code>$ python manage.py makemigrations bands</code></p>
<p>Obs: talvez d&#234; erro porque est&#225; faltando coisas de forms.py, explicado mais abaixo.</p>
<p>Para aplicar as migra&#231;&#245;es</p>
<p><code>$ python manage.py migrate</code></p>
<p>Para criar um usu&#225;rio e senha para o admin</p>
<p><code>$ python manage.py createsuperuser</code></p>
<p>Para rodar a aplica&#231;&#227;o localmente</p>
<p><code>$ python manage.py runserver</code></p>
<p>Ap&#243;s criar um super usu&#225;rio voc&#234; pode entrar em localhost:8000/admin</p>
<p>Obs: Se voc&#234; entrar agora em localhost:8000 vai faltar o template home.html. Explicado mais abaixo.</p>
<h2>shell_plus</h2>
<p>&#201; o <strong>interpretador interativo do python</strong> rodando <strong>via terminal</strong> direto na aplica&#231;&#227;o do django.</p>
<p>Com o comando a seguir abrimos o shell do Django.</p>
<p><code>$ python manage.py shell</code></p>
<p>Mas se voc&#234; est&#225; usando o django-extensions (mostrei como configur&#225;-lo no settings.py), ent&#227;o basta digitar</p>
<p><code>$ python manage.py shell_plus</code></p>
<p>Veja a seguir como inserir dados direto pelo shell.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">myproject.bands.models</span> <span class="kn">import</span> <span class="n">Band</span><span class="p">,</span> <span class="n">Member</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Com django-extensions n&#227;o precisa fazer o import</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># criando o objeto e salvando</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Metallica'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span><span class="o">.</span><span class="n">name</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span><span class="o">.</span><span class="n">can_rock</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span><span class="o">.</span><span class="n">id</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># criando uma instancia da banda a partir do id</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">band</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># criando uma instancia do Membro e associando o id da banda a ela</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Member</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'James Hetfield'</span><span class="p">,</span> <span class="n">instrument</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">name</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># retornando o instrumento</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">instrument</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">get_instrument_display</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">band</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># salvando</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># listando todas as bandas</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># listando todos os membros</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># criando mais uma banda</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'The Beatles'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'The Beatles'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">band</span><span class="o">.</span><span class="n">id</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">band</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># criando mais um membro</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Member</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'John Lennon'</span><span class="p">,</span> <span class="n">instrument</span><span class="o">=</span><span class="s1">'v'</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># listando tudo novamente</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Band</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">exit</span><span class="p">()</span>
</pre></div>


<h2>Criando os templates</h2>
<p>Voc&#234; pode criar os templates com os comandos a seguir...</p>
<div class="highlight"><pre><span></span>$ mkdir -p myproject/bands/templates/bands
$ touch myproject/bands/templates/<span class="o">{</span>menu,base,home<span class="o">}</span>.html
$ touch myproject/bands/templates/bands/<span class="o">{</span>band_list,band_detail,band_form,band_contact,member_form,protected<span class="o">}</span>.html
</pre></div>


<p>... ou pegar os templates j&#225; prontos direto do Github.</p>
<div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">base</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">home</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">menu</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">band_contact</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">band_detail</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">band_form</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">band_list</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">member_form</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">protected</span><span class="p">.</span><span class="n">html</span> <span class="o">-</span><span class="n">P</span> <span class="n">myproject</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">bands</span><span class="o">/</span>
</pre></div>


<h2>forms.py</h2>
<p><code>$ touch myproject/bands/forms.py</code></p>
<p>Edite o forms.py.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Band</span><span class="p">,</span> <span class="n">Member</span>


<span class="k">class</span> <span class="nc">BandContactForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">)</span>
    <span class="n">sender</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
    <span class="n">cc_myself</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BandForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Band</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="s1">'__all__'</span>


<span class="k">class</span> <span class="nc">MemberForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Member</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="s1">'__all__'</span>
</pre></div>


<p>Lembra que eu deixei o c&#243;digo comentado em views.py?</p>
<p>Descomente ele por favor</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">BandContactForm</span><span class="p">,</span> <span class="n">BandForm</span><span class="p">,</span> <span class="n">MemberForm</span>
</pre></div>


<h2>admin.py</h2>
<p>Criamos uma customiza&#231;&#227;o para o admin onde em members aparece um filtro por bandas.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Band</span><span class="p">,</span> <span class="n">Member</span>


<span class="k">class</span> <span class="nc">MemberAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Customize the look of the auto-generated admin for the Member model.&quot;&quot;&quot;</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'instrument'</span><span class="p">)</span>
    <span class="n">list_filter</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'band'</span><span class="p">,)</span>


<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Band</span><span class="p">)</span>  <span class="c1"># Use the default options</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Member</span><span class="p">,</span> <span class="n">MemberAdmin</span><span class="p">)</span>  <span class="c1"># Use the customized options</span>
</pre></div>


<h2>Carregando dados de um CSV</h2>
<p>Vamos baixar alguns arquivos para criar os dados no banco a partir de um CSV.</p>
<div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">create_data</span><span class="p">.</span><span class="n">py</span>
<span class="n">mkdir</span> <span class="n">fix</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">fix</span><span class="o">/</span><span class="n">bands</span><span class="p">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">P</span> <span class="n">fix</span><span class="o">/</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">rg3915</span><span class="o">/</span><span class="n">django2</span><span class="o">-</span><span class="n">pythonclub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">fix</span><span class="o">/</span><span class="n">members</span><span class="p">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">P</span> <span class="n">fix</span><span class="o">/</span>
</pre></div>


<p>Estando na pasta principal, rode o comando</p>
<div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">create_data</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<p>que ele vai carregar alguns dados pra voc&#234;.</p>
<p>Veja o c&#243;digo de <a href="https://github.com/rg3915/django2-pythonclub/blob/master/create_data.py">create_data.py</a>.</p>
<p>Veja o c&#243;digo completo em https://github.com/rg3915/django2-pythonclub</p>
<p><code>git clone https://github.com/rg3915/django2-pythonclub.git</code></p>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://pythonclub.com.br/tutorial-django-2.html">
	    por Regis da Silva em
25 de June de 2019 &#224;s 01:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>April 15, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/formando-desenvolvedores-de-alta-performance/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/1342EcODmfs/">
Formando desenvolvedores de alta performance	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Estou a mais de 1 ano treinando para meu primeiro triathlon (IRONMAN 70.3) e nos &#250;ltimos 7 meses treinando com time de alta performance que faz triathlon profissionalmente a muitos anos. O ano de 2018 foi um ano de muito aprendizado em uma &#225;rea que nunca imaginei que entraria, para contextualizar segue o conte&#250;do abaixo:
1. Pivotei minha carreira profissional para &#225;rea de #esporte
2. Estou escrevendo o meu primeiro #livro, minha sa&#237;da de 180kg a treinar para meu primeiro #ironman (#Triathlon)<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/1342EcODmfs" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/1342EcODmfs/">
15 de April de 2019 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>April 12, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://brunorocha.org/"
	   title="BrunoRocha.org | Python web development | Tag pyplanet | feed">
Bruno Cezar Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="http://brunorocha.org/python/from-dynaconf-import-settings.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://brunorocha.org/python/from-dynaconf-import-settings.html">
from dynaconf import settings	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Often when starting a new Python project we need to spend some time thinking about how to manage the settings, decide on which module the configuration manager will be written, decide which name to give to this module, create a class or function to store the configuration keys, create the conditions for multiple environments and still need to worry about where these keys will be stored and in which file format?</p>
<p>No more! now you have <a href="http://github.com/rochacbruno/dynaconf">Dynaconf</a>!</p>
<p>Spend your precious time developing your application, run <code>pip install dynaconf</code> and let Dynaconf take care of your settings.</p>
<h2>Quick start.</h2>
<pre><code class="lang-python">from dynaconf import settings
</code></pre>
<p>And that's it!</p>
<p>That is the only line of code you need, no complicated boilerplate, no <a href="https://i.imgur.com/rxxTUoe.jpg">hadouken-ifs</a>, no need to maintain config classes.</p>
<p>You must be wondering - <strong>"What magic is this? Where does the setting values come from?"</strong></p>
<p>Well, there is no magic, and the values can come from wherever you want, by default and following the recommendations of the <a href="http://brunorocha.org/tag/pyplanet.atom">12 factor apps</a> Dynaconf has preference for environment variables.</p>
<pre><code class="lang-bash"># optionally you can save it in .env file
export DYNACONF_DEBUG=true
export DYNACONF_NAME=Bruno
</code></pre>
<pre><code class="lang-python"># app.py
from dynaconf import settings
if settings.DEBUG is True:
    print(settings.NAME)
</code></pre>
<pre><code class="lang-bash">$ python3 app.py
Bruno
</code></pre>
<blockquote><p>And the environment variables for Dynaconf are typed using the <code>toml</code> format so<code>true</code> has been evaluated to boolean <code>True</code> and this makes it possible to export lists, dictionaries, floats, booleans, and so on.</p>
</blockquote>
<p><a href="https://dynaconf.readthedocs.io/en/latest/guides/environment_variables.html">Read more about envvars</a></p>
<h2>More than environment variables</h2>
<p>Well, that's cool, but your project will not have settings coming from just the environment variables, I'm sure you want to have a settings file where you can set  default values.</p>
<p>Dynaconf can read multiple file formats, out of the box it supports <code>.py</code>, <code>.toml</code>, <code>.ini</code> and <code>.json</code>. If <code>PyYAML</code> is installed then it will also support <code>.yaml</code> and you don't have to take care of finding and opening the files. The preferred format is <code>.toml</code> because it is currently the best configuration format, widely addopted, and you can use whatever file format you want.</p>
<pre><code class="lang-toml"># settings.toml
[default]
name = &quot;Bruno&quot;

[development]
debug = true

[production]
debug = false
</code></pre>
<pre><code class="lang-python"># app.py
from dynaconf import settings
if settings.DEBUG is True:
    print(settings.NAME)
</code></pre>
<pre><code class="lang-bash">$ python3 app.py
Bruno
</code></pre>
<p>And as you can see now using <code>settings.</code> file we can have separate <code>[environments]</code> by default dynaconf will always work on <code>[development]</code> which means only <code>[default]</code> and <code>[development]</code> variables will be loaded. At any time you can do <code>export ENV_FOR_DYNACONF=production</code> and then it starts using the values from <code>[production]</code> environment.</p>
<blockquote><p>If you don't want to have that separation by environment, you can simply put everything under <code>[default]</code> section.</p>
</blockquote>
<p>Read more about <a href="https://dynaconf.readthedocs.io/en/latest/guides/usage.html#working-environments">environments and settings file</a></p>
<h2>Some values are secrets</h2>
<p>A good practice is to not store your <strong>secrets</strong> like <strong>passwords</strong> and <strong>tokens</strong> directly on settings files, because you can make a mistake and commit that to a public git repository, so there are some alternatives to store <strong>secrets</strong></p>
<h3>Environment Variables</h3>
<blockquote><p>Not recommended</p>
</blockquote>
<p>There are some people who <a href="https://diogomonica.com/2017/03/27/why-you-shouldnt-use-env-variables-for-secret-data/">disagrees</a> and it is really a point of security failure. However, if you are sure that your machine is protected, you can leave the secrets in the variables, at your own risk, Dynaconf can read it normally.</p>
<h3>Secret files</h3>
<p>This is a simple level of security for keeping secrets, and it is specially useful to keep <code>development</code> secrets. That <strong>token</strong> you use to access the development API etc.</p>
<p>It is very simple, together with your normal <code>settings.toml</code> you put a new file called <code>.secrets.toml</code> and store your sensitive data there. Dynaconf will read it after the read of the <code>settings.toml</code></p>
<p>Wait.. how does it solve my security problem?</p>
<p>Well it does not (yet) but it make your life easier in 2 ways.</p>
<ol>
<li>Put <code>.secrets.*</code> in your <code>~/.gitignore</code> so you will never commit the mistake of sending that data to a public git repository.</li>
<li>Dynaconf can output debug information when <code>DEBUG_LEVEL_FOR_DYNACON=DEBUG</code> is exported, all loaded values are printed but if the values comes from a <code>.secrets.*</code> file, then only the key is printed and the value is masked. It is useful to use on public CI.</li>
<li>You can setup a step on your Ansible deployment playbook that will safely copy or generate the secrets file to store there on your production environment.</li>
</ol>
<p>You can also tell Dynaconf to load that file from somewhere else <code>export SECRETS_FOR_DYNACONF=/path/to/secrets/location/.secrets.yaml</code> (very useful for CI like Jenkins)</p>
<h3>Vault Project from Hashicorp</h3>
<blockquote><p>Recommended!</p>
</blockquote>
<p>Now we are really talking about <strong>true security</strong></p>
<p>Using <strong>Vault</strong> is the better way to protect your secrets dynaconf has built-in support:</p>
<pre><code class="lang-bash">export VAULT_ENABLED_FOR_DYNACONF=true
export VAULT_URL_FOR_DYNACONF=https://..../
export OTHER_VAULT_CONFIGS
</code></pre>
<p>And then if have for example the <code>TOKEN</code> stores on your vault server you can simply do:</p>
<pre><code class="lang-python">from dynaconf import settings
perform_your_authentication(settings.TOKEN)
</code></pre>
<p>Vault has lots of features like leases and sealed vaults.</p>
<p><a href="https://dynaconf.readthedocs.io/en/latest/guides/sensitive_secrets.html">Read More</a></p>
<h2>Are you using Django or Flask?</h2>
<p>Dynaconf provides extensions for those 2 frameworks, with 2 lines of code you enable it and then your framework will start reading settings from Dynaconf.</p>
<h3>Django</h3>
<pre><code class="lang-python"># settings.py
import dynaconf  # noqa
settings = dynaconf.DjangoDynaconf(__name__, **options)
</code></pre>
<p>Now you if you do <code>export DJANGO_FOO=BAR</code> you can access inside your app via <code>django.conf.settings.FOO</code></p>
<p><a href="https://dynaconf.readthedocs.io/en/latest/guides/django.html">read more</a></p>
<h3>Flask</h3>
<pre><code class="lang-python"># app.py
from dynaconf import FlaskDynaconf
FlaskDynaconf(app, **options)
</code></pre>
<p>Now you if you do <code>export FLASK_FOO=BAR</code> you can access inside your app via <code>app.config['FOO']</code></p>
<p><a href="https://dynaconf.readthedocs.io/en/latest/guides/flask.html">read more</a></p>
<h2>What if you are using a different settings file format? a different framework and a different external storage?</h2>
<blockquote><p>You can extend Dynaconf adding new loaders!</p>
</blockquote>
<p>Dynaconf already provides loaders for:</p>
<ul>
<li><code>.py</code></li>
<li><code>.json</code></li>
<li><code>.yaml</code></li>
<li><code>.toml</code></li>
<li><code>.ini</code></li>
<li>Redis Server</li>
<li>Vault Server</li>
<li><code>.env</code> files</li>
<li>Environment variables</li>
</ul>
<p>But if this is not a fit for your project you can still <a href="https://dynaconf.readthedocs.io/en/latest/guides/extend.html">create your own loader</a></p>
<h2>Conclusion</h2>
<blockquote><p>Dynaconf is the only thing you need to manage your settings!</p>
</blockquote>
<ul>
<li>Well tested</li>
<li>Trusted by companies like Red Hat, Seek, Catho and others</li>
<li>Well tested both on Linux and Windows environment</li>
<li>Strict separation of settings from code (following <a href="https://12factor.net/config">12-factor applications</a> Guide).</li>
<li>Define comprehensive default values.</li>
<li>Store parameters in multiple file formats (<strong>.toml</strong>, .json, .yaml, .ini and .py).</li>
<li>Sensitive <strong>secrets</strong> like tokens and passwords can be stored in safe places like <code>.secrets</code> file or <code>vault server</code>.</li>
<li>Parameters can optionally be stored in external services like Redis server.</li>
<li>Simple <strong>feature flag</strong> system.</li>
<li>Layered <strong>[environment]</strong> system.</li>
<li>Environment variables can be used to override parameters.</li>
<li>Support for <code>.env</code> files to automate the export of environment variables.</li>
<li>Correct data types (even for environment variables).</li>
<li>Have <strong>only one</strong> canonical settings module to rule all your instances.</li>
<li>Drop in extension for <strong>Flask</strong> <code>app.config</code> object.</li>
<li>Drop in extension for <strong>Django</strong> <code>conf.settings</code> object.</li>
<li>Powerful <strong>$ dynaconf</strong> CLI to help you manage your settings via console.</li>
<li>Customizable <strong>Validation</strong> System to ensure correct config parameters.</li>
<li>Allow the change of <strong>dyna</strong>mic parameters on the fly without the need to redeploy your application.</li>
</ul>
<h2>Read the docs</h2>
<blockquote><p>Settings are simple but Dynaconf provides even more features like <strong>Feature Flags</strong>, <strong>Settings Context Managers</strong>, <strong>Plugin Settings</strong> etc..</p>
</blockquote>
<p><strong>Documentation</strong>: <a href="http://dynaconf.readthedocs.io/">http://dynaconf.readthedocs.io/</a></p>
<p>Dynaconf is waiting for your <a href="https://github.com/rochacbruno/dynaconf/issues/155">feedback</a> and <a href="https://github.com/rochacbruno/dynaconf/issues">Contribution</a></p>
<p>:)</p>
<pre><code class="lang-python">from dynaconf import settings
settings.THANKS_FOR_READING
</code></pre>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://brunorocha.org/python/from-dynaconf-import-settings.html">
	    por Bruno Rocha em
12 de April de 2019 &#224;s 14:38	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>March 20, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://pythonologia.org"
	   title="Pythonologia">
Osvaldo Santana Neto	</a>
      </h3>


    <div class="entrygroup"
         id="http://pythonologia.org/?p=33"
	   lang="en-US"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://pythonologia.org/learn-python/how-to-create-a-variable-in-python/">
How to create a variable in Python	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Hello there, in this post we are going to learning about creating a variable in Python. The process is very simple like creating a variable in other languages but if you are new to programming don&#8217;t worry I&#8217;ll explain each step in details. What is Python variable: A Python variable is used to store some information/value that we can use in our program. It can be anything; a number, string, function, or a variable itself. Well, this is how a Python variable look like: website = "Pythonologia" Let me explain... <span class="more"><a class="more-link" href="http://pythonologia.org/learn-python/how-to-create-a-variable-in-python/">Read More</a></span>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://pythonologia.org/learn-python/how-to-create-a-variable-in-python/">
	    por Deepak Jangra em
20 de March de 2019 &#224;s 03:14	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>March 10, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://pythonologia.org"
	   title="Pythonologia">
Osvaldo Santana Neto	</a>
      </h3>


    <div class="entrygroup"
         id="http://pythonologia.org/?p=23"
	   lang="en-US"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://pythonologia.org/how-to/how-to-install-lemp-stack-on-digital-ocean/">
How to install LEMP stack on Digital Ocean	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Hello and welcome everybody. I&#8217;m Deepak and today we are going to looking at How to install LEMP stack on Digital Ocean. Before installing LEMP stack on Digital Ocean you must have an Digital Ocean account. For creating the Digital Ocean account. Visit this link and sign up there by using this link you will get $100 free credit for 2 months that means you can use a live hosting for free for 2 months. Disclaimer: The link mentioned above is an affiliate link. It will help Pythonologia to continue... <span class="more"><a class="more-link" href="http://pythonologia.org/how-to/how-to-install-lemp-stack-on-digital-ocean/">Read More</a></span>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://pythonologia.org/how-to/how-to-install-lemp-stack-on-digital-ocean/">
	    por Deepak Jangra em
10 de March de 2019 &#224;s 22:59	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>February 17, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://junglecoders.blogspot.com/search/label/python"
	   title="JungleCoders">
JungleCoders	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-3893718475893359926"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2007/10/one-laptop-per-child.html">
One Laptop per Child	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2007-10-27-one-laptop-per-child/">Leia no novo blog</a><br /><br />Eu me tornei professor por acidente. No col&#233;gio, como era bom em matem&#225;tica, sempre ensinava algu&#233;m... depois a coisa foi ficando mais s&#233;ria. Comecei a ensinar matem&#225;tica particular ainda no primeiro grau... aos 18 anos eu j&#225; era instrutor de cursos de programa&#231;&#227;o. Acho que no primeiro curso eu ensinei Clipper :-)<br /><br />Em 1994, virei professor de l&#243;gica e t&#233;cnica de programa&#231;&#227;o e tamb&#233;m de linguagens de programa&#231;&#227;o I e II. Professor de algoritmos, Cobol e C. Desde ent&#227;o passei a me interessar seriamente por educa&#231;&#227;o e a me impressionar com a velocidade que as pessoas aprendem. Confesso que ensinar a  programar n&#227;o &#233; f&#225;cil, aprender tamb&#233;m n&#227;o. Com um pouco de pr&#225;tica se melhora, mas nunca fiquei contente... continuo procurando novas formas de ensinar programa&#231;&#227;o. Nos &#250;ltimos anos, eu ensinei Python. Uma linguagem que gosto muito e uso no meu dia a dia.<br /><br />Esta semana tamb&#233;m ca&#237; por acidente na p&#225;gina do <a href="http://laptop.org/">projeto One Laptop per Child</a>. Eu j&#225; escutei muito sobre este projeto e resolvi ler um pouco mais. A comunidade t&#233;cnica sempre reclama que n&#227;o se pode fazer quase nada com o tal notebook entre outras coisas. Eles procuram desenvolvedores para a plataforma, que &#233; Linux, mas rodando em uma m&#225;quina muito enxuta para os padr&#245;es de hoje. N&#227;o resisti, baixei a imagem e fiquei testando. Lembrei dos dias negros do Linux ao tentar configurar o teclado belga no X. Fazia tempo que n&#227;o tinha tanto trabalho para configurar uma coisa t&#227;o besta. Depois de ignorar o texto da <a href="http://wiki.laptop.org/go/Home">Wiki do projeto</a> e de rodar o Qemu corretamente, a imagem funcionou com rede, mas ainda sem som. Bem, o som ainda n&#227;o est&#225; funcionando, mas eu n&#227;o conseguia mais esperar para testar o <a href="http://invasores.sourceforge.net/">Invasores</a> no OLPC, ou na imagem dele. E n&#227;o &#233; que funcionou sem alterar uma s&#243; linha!<br /><br />Mais um ponto para o Python. Tamb&#233;m, o OLPC &#233; baseado no Fedora, mas usa uma interface gr&#225;fica diferente, o <a href="http://wiki.laptop.org/go/Sugar">Sugar</a>. Ainda estou resolvendo alguns problemas com o tamanho da tela do jogo, mas mesmo n&#227;o rodando em tela cheia, o jogo funciona sem problema algum. Eu vou fazer um release s&#243; para o OLPC em breve.<br /><br />Voltando ao OLPC, eles precisam de kits de programa&#231;&#227;o, incluindo a cria&#231;&#227;o de jogos simples. Como os fontes do Invasores s&#227;o em portugu&#234;s, tomara que ajude algu&#233;m a entender como fazer um jogo extremamente simples.<br /><br />Algumas pessoas tem criticado o OLPC, resumindo o projeto a tecnologia do notebook. Mas lendo a wiki deles, percebe-se que a tecnologia &#233; o foco atual, mas o objetivo do projeto &#233; proporcionar uma melhor educa&#231;&#227;o a milh&#245;es de exclu&#237;dos. Muitos est&#227;o preocupados com problemas mais s&#233;rios, como a falta de professores nas escolas, energia el&#233;trica e &#225;gua pot&#225;vel. Isso tamb&#233;m &#233; real e muito importante. Minha &#250;nica cr&#237;tica &#233; a busca incessante por balas de prata. O OLPC n&#227;o pretende e nem vai resolver todos os problemas do mundo. Este projeto &#233; mais uma contribui&#231;&#227;o, outras a&#231;&#245;es devem ser realizadas para melhorar a vida de todos.<br /><br />Eu me identifiquei com o projeto, porque uma vez, conversando com amigos, nos perguntamos quantos talentos se perdiam com a mis&#233;ria. Imagine s&#243;: voc&#234; um g&#234;nio da programa&#231;&#227;o, mas o &#250;nico equipamento a que voc&#234; tem acesso &#233; um carrinho de m&#227;o. Qual &#233; chance de por acidente descobrir seu talento? Quantos matem&#225;ticos, qu&#237;micos, f&#237;sicos e bi&#243;logos n&#227;o perdemos com estas faltas de oportunidade?<br /><br />Um computador para cada crian&#231;a dar&#225; uma chance para milhares de crian&#231;as conhecerem a Internet, textos, sons e gr&#225;ficos. Isto por si s&#243; j&#225; justificaria o projeto para mim. Se apenas 0,1% das crian&#231;as que receberem o notebook mudarem de vida, significa que precisar&#237;amos de 1000 notebooks para salvar uma crian&#231;a.  Calculando os custos disso, vejamos US$250,00 x 1000,00 = US$250.000,00. Um quarto de milh&#227;o para integrar ou reaproximar uma pessoa da sociedade moderna.   Uma pessoa com acesso a educa&#231;&#227;o e trabalho pode reverter o ciclo de pobreza de v&#225;rias gera&#231;&#245;es, eu j&#225; vi isso ocorrer v&#225;rias vezes no Brasil. Eu tamb&#233;m acredito que consigamos um sucesso bem maior que 0,1%. Para mim, muito promissor. Ainda que muitos notebooks caiam no mercado negro, sejam roubados ou simplesmente danificados em curto espa&#231;o de tempo, acredito que ser&#225; uma marca na vida dessas crian&#231;as.<br /><br />Uma coisa que deixou preocupado &#233; a falta de Internet no Brasil. Os &#250;ltimos n&#250;meros que li, traziam algo como 14 ou 20 milh&#245;es de internautas no pa&#237;s. Embora este n&#250;mero venha crescendo, ainda demonstra nosso atraso e m&#225; distribui&#231;&#227;o de renda. Quantas escolas p&#250;blicas temos com acesso &#224; Internet? Na d&#233;cada de 90, o problema era ter telefone. Agora &#233; conseguir Internet. Em Manaus, a situa&#231;&#227;o &#233; cr&#237;tica. Ainda se vendem planos de 200 ou 300Kb/s como banda larga. Precisamos urgentemente de Internet nas escolas. O OLPC sem Internet vai ficar bem limitado, mas isso n&#227;o invalidar&#225; os poss&#237;veis ganhos do projeto. Precisamos de mais educa&#231;&#227;o e de mais acesso a Internet. Um grande pa&#237;s tem grandes problemas. Meu sonho megaloman&#237;aco &#233; de transformar o Amazonas em uma nova &#205;ndia :-)<br /><br />Como disse, n&#227;o resolver&#225; todos os problemas do mundo, mas &#233; um esfor&#231;o positivo. &#201; muito importante criticar, vis&#245;es diferentes sempre s&#227;o bem-vindas. S&#243; n&#227;o esque&#231;a que o projeto &#233; sobre crian&#231;as e educa&#231;&#227;o. O laptop &#233; s&#243; um detalhe.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2007/10/one-laptop-per-child.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 17:11	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-1471972930842803146"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2007/04/python-your-life.html">
Python your life	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2007-04-17-python-your-life/">Leia no novo blog</a><br /><br />Eu sou um cara esquecido. Eu realmente n&#227;o lembro certas coisas, mas outras eu n&#227;o esque&#231;o.<br />Uma vez, ainda no final dos anos 90, <span class="blsp-spelling-error" id="SPELLING_ERROR_0">putz</span> esqueci em que ano foi... um amigo de faculdade comentou sobre uma tal linguagem "<span><span class="blsp-spelling-error" id="SPELLING_ERROR_1">p&#237;ton</span></span>". Ele disse ser super pr&#225;tica, muito boa, mesmo sendo script.<br /><br />Na &#233;poca eu j&#225; trabalhava com Linux e qualquer coisa para ajudar era bem vinda. Baixei o tal do <span class="blsp-spelling-error" id="SPELLING_ERROR_2">Python</span> e fiz o tradicional imprima os primos, usando listas, claro! Depois um aplicativo para procurar arquivos repetidos no <span class="blsp-spelling-error" id="SPELLING_ERROR_3">HD</span>. Foi o suficiente para me libertar de Perl, at&#233; ent&#227;o a melhor coisa do mundo <span class="blsp-spelling-error" id="SPELLING_ERROR_4">script</span> para mim.<br /><br />Passei um tempo sem usar a linguagem. Acho que at&#233; 2002, quando um grupo de amigos do trabalho iniciou uma discuss&#227;o sobre jogos de computador. Como todos eram t&#233;cnicos, o assunto n&#227;o era o jogo em si, mas a tecnologia por tr&#225;s de um jogo. Especificamente, o que mais interessava ao grupo era escolher a melhor linguagem para se codificar um jogo. Como esse tipo de coisa &#233; t&#227;o <span class="blsp-spelling-error" id="SPELLING_ERROR_5">exato</span> quanto religi&#227;o ou pol&#237;tica... resolvi sugerir que cada um tentasse fazer um jogo simples, com a linguagem que achasse melhor.<br /><br />Eu n&#227;o gostava de Java, depois explico o por qu&#234;. <span class="blsp-spelling-corrected" id="SPELLING_ERROR_6">Comecei</span> a brincar com <span class="blsp-spelling-error" id="SPELLING_ERROR_7">Delphi</span>, que estava a m&#227;o na &#233;poca. Sempre programei em C e n&#227;o precisava de outro teste para saber o que eu j&#225; sabia: C &#233; bom, mas tem coisa melhor hoje em dia. Lembrei da tal linguagem da cobra, o <span class="blsp-spelling-error" id="SPELLING_ERROR_8">Python</span> (segundo o criador da linguagem, <a href="http://pt.wikipedia.org/wiki/Guido_van_Rossum"><span class="blsp-spelling-error" id="SPELLING_ERROR_9">Guido</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_10">van</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_11">Rossum</span></a>, pronuncia-se "<span class="blsp-spelling-error" id="SPELLING_ERROR_12">Paiton</span>" <a href="http://www.ibiblio.org/pub/multimedia/video/obp/IntroducingPython.mpg">filme</a> <a href="http://www.pythonbrasil.com.br/moin.cgi/VideoIntroducingPython?action=AttachFile&do=get&target=IntroducingPython.sub">legenda</a>).<br /><br />Usando <span class="blsp-spelling-error" id="SPELLING_ERROR_13">Python</span> e <span class="blsp-spelling-error" id="SPELLING_ERROR_14">Pygame</span>, iniciei um pequeno "<span><span class="blsp-spelling-error" id="SPELLING_ERROR_15">shoot</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_16">them</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_17">up</span></span>", tipo <span><span class="blsp-spelling-error" id="SPELLING_ERROR_18">Space</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_19">Invaders</span></span>, afinal era pra ser um jogo simples. E se o <span class="blsp-spelling-error" id="SPELLING_ERROR_20">Space</span><span> </span><span class="blsp-spelling-error" id="SPELLING_ERROR_21">Invaders</span> original rodava num <span class="blsp-spelling-error" id="SPELLING_ERROR_22">Atari</span> com 1 <span class="blsp-spelling-error" id="SPELLING_ERROR_23">MHz</span>... rodaria em qualquer linguagem <span class="blsp-spelling-error" id="SPELLING_ERROR_24">script</span> s&#233;ria.<br /><br />Comecei desconfiado, testando a performance do pequeno monstro que estava criando. Fiquei surpreso ao constatar que a performance era mais que suficiente para o que eu queria.<br /><br />A linguagem &#233; realmente interessante: f&#225;cil de aprender, <span class="blsp-spelling-error" id="SPELLING_ERROR_25">multiplataforma</span>, <span class="blsp-spelling-error" id="SPELLING_ERROR_26">com acesso a todo tipo de </span> bibliotecas de sistema, banco de dados e  at&#233; jogos! Continuei fazendo o pequeno jogo. Gr&#225;ficos, sons, suporte a <span class="blsp-spelling-error" id="SPELLING_ERROR_27">joystick</span>, altera&#231;&#227;o din&#226;mica de resolu&#231;&#227;o e suporte a v&#225;rias l&#237;nguas. Um jogo realmente simples. Voc&#234; pode ver o que eu criei em <a href="http://invasores.sourceforge.net/">http://invasores.sourceforge.net/</a>.<br /><br />Quanto aos outros colegas, um iniciou um jogo em Java, acho que at&#233; foi em J2ME... mas n&#227;o chegou a ter cores. Outras tentativas n&#227;o deixaram rastros. Agora eu tinha provas que <span class="blsp-spelling-error" id="SPELLING_ERROR_28">Python</span> era boa, n&#227;o pela superioridade pura e simples de sua simplicidade, mas porque com ela eu podia fazer mais em menos tempo. Produtividade enfim.<br /><br />Antes eu havia usado o <span class="blsp-spelling-error" id="SPELLING_ERROR_29">Python</span> para converter banco de dados e realizar opera&#231;&#245;es com arquivos. Desde a experi&#234;ncia com o jogo, eu uso <span class="blsp-spelling-error" id="SPELLING_ERROR_30">Python</span> para todo pequeno utilit&#225;rio que eu preciso. E n&#227;o me <span class="blsp-spelling-corrected" id="SPELLING_ERROR_31">surpreendo</span> quando acho outros programas muito bons escritos na linguagem. Esses tempos mesmo, escrevi utilit&#225;rios para fazer a carga de arquivos CSV para um banco <span class="blsp-spelling-error" id="SPELLING_ERROR_33">MySql</span> e gerar tabelas em Latex.<br /><br />Al&#233;m do poder da linguagem, sua clareza &#233; realmente impressionante. Os tais blocos por <span class="blsp-spelling-error" id="SPELLING_ERROR_34">identa&#231;&#227;o</span> atenderam a um desejo que eu tinha h&#225; muito tempo. Misturar <span class="blsp-spelling-error" id="SPELLING_ERROR_35">tabs</span> e espa&#231;os &#233; complicado, eu sei, mas quando se consegue fazer certo... consegue-se um programa limpo e f&#225;cil de ler. Se voc&#234; consegue ler, consegue aprender.<br /><br />Eu ensinei l&#243;gica de programa&#231;&#227;o para alunos do ensino m&#233;dio e para algumas pessoas na faculdade. Era terr&#237;vel ler um programa "desdentado". Mais dif&#237;cil ainda convencer as criaturas da import&#226;ncia de um c&#243;digo limpo. Esse problema n&#227;o existe com <span class="blsp-spelling-error" id="SPELLING_ERROR_36">Python</span>. Ser&#225; executado como l&#225; est&#225; escrito, ou melhor, como se v&#234;. Eu realmente gosto da linguagem.<br /><br />Al&#233;m disso tudo, a linguagem vem com todos os acess&#243;rios, incluindo-se uma ativa comunidade lus&#243;fona em<a href="http://www.pythonbrasil.com.br/moin.cgi/"> PythonBrasil</a>. S&#243; n&#227;o aprende quem n&#227;o quer.<br /><br />Eu continuo programando em C++ e Java, mas a outra &#233; Python.<br /><br />Cada um sabe onde seu calo aperta. <span class="blsp-spelling-error" id="SPELLING_ERROR_37">Python</span> n&#227;o &#233; bala de prata. Mas como n&#227;o existe lobisomem... Python your life!      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2007/04/python-your-life.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 17:09	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-2604927099342089232"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2010/12/livro-de-introducao-programacao-com.html">
Livro de Introdu&#231;&#227;o Programa&#231;&#227;o com Python j&#225; est&#225; venda	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2010-12-02-livro-de-introducao-programacao-com-python-ja-esta-venda/">Leia no novo blog</a><br /><br />Nada como uma noite fria e cheia de neve para colocar o blog em dia!<br />Meu livro de programa&#231;&#227;o foi publicado pela Editora Novatec e j&#225; est&#225; dispon&#237;vel para venda.<br />Eu criei uma p&#225;gina sobre o livro, com links para livrarias e emails de contato:<br /><br /><a href="http://www.nilo.pro.br/iprog/">http://www.nilo.pro.br/iprog/</a><br /><br />O livro foi escrito de forma a apresentar novos conceitos gradualmente, com exemplos e exerc&#237;cios. &nbsp; Quando comecei a dar aulas, eu ensinava Basic e Pascal. Com o Basic, tinha o problema dos n&#250;meros de linha. Com o Pascal os ponto-e-v&#237;rgula... era muita coisa para escrever antes de come&#231;ar a programar. Nestes casos, o uso de um pseudo-c&#243;digo claro e simples, livre de s&#237;mbolos em excesso era interessante.&nbsp;Eu evitei usar pseudo-c&#243;digo ou fluxogramas, pois acredito que ao se aprender a programar, o melhor &#233; ir direto ao ponto.&nbsp;Com a linguagem Python, isso tudo fica muito mais simples. Escrever em pseudo-c&#243;digo pode at&#233; ser mais complicado que escrever em Python!<br />O leitor/aluno precisa ver algo acontecer para continuar estudando. O importante &#233; saber ler o programa e entender o que vai acontecer quando o programa for executado. Eu realmente acredito que o aluno deve saber se o programa est&#225; correto antes de execut&#225;-lo. A execu&#231;&#227;o &#233; apenas uma confirma&#231;&#227;o. Uma se&#231;&#227;o sobre rastreamento foi inclu&#237;da no livro, para preservar esta importante etapa no aprendizado de programa&#231;&#227;o.<br /><br />A clareza e simplicidade da linguagem s&#227;o realmente muito importantes para facilitar o aprendizado. Python torna a programa&#231;&#227;o acess&#237;vel par estudantes de outras &#225;reas e n&#227;o apenas de computa&#231;&#227;o e engenharia.<br />Outra caracter&#237;stica do Python &#233; que ela permite usar quase tudo que temos no computador. Uma vez aprendendo a programar em Python, pode-se continuar estudando outras linguagens de programa&#231;&#227;o ou partir diretamente para aplica&#231;&#245;es web, jogos, banco de dados, etc. O caminho &#233; mais suave e sem interrup&#231;&#245;es. N&#227;o serve apenas de linguagem introdut&#243;ria, mas do dia a dia.<br /><br />Escrever um livro era algo que eu sempre quis fazer. D&#225; muito trabalho, tem que ler, reler, re-escrever e corrigir in&#250;meras vezes. O trabalho de revis&#227;o &#233; realmente incr&#237;vel, principalmente com a nova ortografia e com os desafios de escrever um livro t&#233;cnico para leigos. Ter uma editora ajuda muito nesta tarefa, pois sozinhos n&#243;s come&#231;amos a n&#227;o perceber mais os erros. Digo n&#243;s porque minha esposa ajudou na revis&#227;o.<br /><br /><br /><span class="Apple-style-span">T&#237;tulo: Introdu&#231;&#227;o &#224; Programa&#231;&#227;o com Python</span><br /><span class="Apple-style-span">Autor: Nilo Ney Coutinho Menezes</span><br /><span class="Apple-style-span">ISBN: 978-85-7522-250-8<br />P&#225;ginas: 224</span><br /><span class="Apple-style-span">Editora: <a href="http://novatec.com.br/livros/intropython/">Novatec</a><br />Ano: 2010</span><br /><br />Resenha do Livro:<br /><br /><span class="Apple-style-span"></span><br /><div><span class="Apple-style-span">Este livro &#233; orientado ao iniciante em programa&#231;&#227;o. Os conceitos b&#225;sicos de programa&#231;&#227;o, como express&#245;es, vari&#225;veis, repeti&#231;&#245;es, decis&#245;es, listas, fun&#231;&#245;es e arquivos, s&#227;o apresentados um a um com exemplos e exerc&#237;cios. A obra visa explorar a programa&#231;&#227;o de computadores como ferramenta do dia a dia. Ela pode ser lida durante um curso de introdu&#231;&#227;o &#224; programa&#231;&#227;o de computadores e usada como guia de estudo para autodidatas. Para aproveitamento pleno do conte&#250;do, conhecimentos b&#225;sicos de inform&#225;tica, como digitar textos, abrir e salvar arquivos, s&#227;o suficientes. Todo software utilizado no livro pode ser baixado gratuitamente, sendo executado em Windows, Linux e Mac OS X.</span></div><div><span class="Apple-style-span">Embora a linguagem Python (vers&#227;o 3.x) seja muito poderosa e repleta de recursos modernos de programa&#231;&#227;o, este livro n&#227;o pretende ensinar a linguagem em si, mas ensinar a programar. Alguns recursos da linguagem n&#227;o foram utilizados para privilegiar os exerc&#237;cios de l&#243;gica de programa&#231;&#227;o e oferecer uma prepara&#231;&#227;o mais ampla ao leitor para outras linguagens. Essa escolha n&#227;o impediu a apresenta&#231;&#227;o de recursos poderosos da linguagem, embora o livro n&#227;o seja fundamentalmente uma obra de refer&#234;ncia.</span></div><br /><a href="http://novatec.com.br/livros/intropython/sumario9788575222508.pdf">Sum&#225;rio (PDF)</a>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2010/12/livro-de-introducao-programacao-com.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:53	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-690196842800813519"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2014/06/python-asyncio-metodos-assincronos-em.html">
Python asyncio - M&#233;todos ass&#237;ncronos em Python	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2014-06-28-python-asyncio-metodos-assincronos-em-python/">Leia no novo blog</a><br /><br />Com a sa&#237;da do Python 3.4, eu atualizei o livro de <a href="http://python.nilo.pro.br/index.html" target="_blank">Introdu&#231;&#227;o &#224; Programa&#231;&#227;o com Python</a>. Alguns assuntos fogem ao escopo do livro que &#233; destinado a iniciantes. Eu vou come&#231;ar a escrever uma s&#233;rie de posts curtos sobre alguns t&#243;picos que acho interessantes e quem sabe at&#233; podem virar base para um novo livro.<br /><br />Uma das novidades do Python 3.4 &#233; o m&#243;dulo <a href="https://docs.python.org/3/library/asyncio.html" target="_blank">asyncio</a> que traz v&#225;rias rotinas para chamada de m&#233;todos ass&#237;ncronos em Python. A programa&#231;&#227;o ass&#237;ncrona &#233; um pouco diferente do que normalmente estamos habituados a escrever em Python, mas &#233; uma excelente alternativa a utiliza&#231;&#227;o de threads e uma boa escolha para resolver problemas com muitas entras ou sa&#237;das (<i>I/O</i>).<br /><br /><pre class="brush:python">import asyncio<br /><br />def print_and_repeat(loop):<br />    print('Hello World')<br />    loop.call_later(2, print_and_repeat, loop)<br /><br />loop = asyncio.get_event_loop()<br />loop.call_soon(print_and_repeat, loop)<br />loop.run_forever()<br /></pre><br />O mecanismo usado no exemplo &#233; bem simples. A vari&#225;vel <b>loop</b> cont&#233;m o loop de eventos, uma vez que chamamos <b>asyncio.get_event_loop()</b> e esta retorna o <b>loop</b> de eventos atual. Na linha seguinte, chamamos o m&#233;todo <b>call_soon</b> para agendar a chamada de um m&#233;todo. <b>call_soon</b> adiciona a chamada da fun&#231;&#227;o <b>print_and_repeat</b>, definida anteriormente. O segundo par&#226;metro de <b>call_soon</b> &#233; na realidade o par&#226;metro para <b>print_and_repeat</b>. Desta forma, <b>loop.call_soon(print_and_repeat, loop)</b> adiciona ao loop de eventos uma chamada a fun&#231;&#227;o <b>print_and_repeat</b>, passando <b>loop</b> como primeiro par&#226;metro. Confuso? Vamos ver o que acontece ao executarmos:<br /><br /><pre>Z:\artigos&gt;c:\python34\python asyncio1.py<br />Hello World<br />Hello World<br />Hello World<br />Hello World<br /></pre><br />O programa executa e fica na linha do <b>loop.run_forever()</b>. O m&#233;todo <b>run_forever()</b> processa os eventos e &#233; necess&#225;rio para o bom funcionamento do nosso programa. Experimente remover esta linha e veja que nada &#233; impresso na tela, com o programa finalizando logo em seguida. Isto acontece porque sem <b>run_forever</b>, os eventos n&#227;o s&#227;o processados e o Python executa o script at&#233; o fim, finalizando sem nunca ter chamado <b>print_and_repeat</b>, ou seja, sem processar a lista de eventos.  <br />Voltando ao nosso exemplo, voc&#234; entendeu como <i>Hello Word</i> foi impresso v&#225;rias vezes? Como se estivesse dentro de um for ou while? Isto acontece na &#250;ltima linha de <b>print_and_repeat</b>, onde com o m&#233;todo <b>call_later</b> agendamos uma pr&#243;xima chamada a <b>print_and_repeat</b> depois de 2 segundos. Logo, o primeiro par&#226;metro de <b>call_later</b> &#233; o tempo a esperar antes de chamar a fun&#231;&#227;o, o segundo a fun&#231;&#227;o em si, seguido dos par&#226;metros a passar a esta fun&#231;&#227;o, como fizemos na chamada de <b>call_soon </b>anteriormente.<br /><br />O c&#243;digo equivalente, sem utilizar eventos seria algo como:<br /><br /><pre class="brush:python">import time<br /><br />while True:<br />    print("Hello World")<br />    time.sleep(2)<br /></pre><br />Se &#233; t&#227;o simples, por que complicar? Eventos facilitam a execu&#231;&#227;o de c&#243;digo alternadamente, algo dif&#237;cil de realizar sem utilizarmos threads. Basicamente, solicitamos ao loop de eventos para executar nossas fun&#231;&#245;es de acordo com sua disponibilidade, como se pass&#225;ssemos em nosso programa uma lista de tarefas a executar. O loop de eventos atualiza constantemente a lista de tarefas e isto permite a execu&#231;&#227;o de tarefas em ordem diferente da que estas foram inclu&#237;das. <br />Vejamos um outro exemplo, com <b>call_later</b>:<br /><br /><pre class="brush:python">import asyncio<br />import time<br />import random<br /><br />def faz_algo(loop):<br />    espera = random.random()<br />    print("Fazendo algo... espera = %f" % espera)<br />    loop.call_later(espera, faz_algo, loop)<br /><br />def print_and_repeat(loop):<br />    global &#250;ltimo<br />    agora = time.time()<br />    print('Al&#244; - Tempo decorrido: %f' % (agora - &#250;ltimo))<br />    &#250;ltimo = agora<br />    loop.call_later(2, print_and_repeat, loop)<br /><br />&#250;ltimo = time.time()<br />loop = asyncio.get_event_loop()<br />loop.call_soon(print_and_repeat, loop)<br />loop.call_soon(faz_algo, loop)<br />loop.run_forever()<br /></pre><br />Que ao executar nos exibe: <br /><br /><pre>Z:\artigos&amp;gt;c:\python34\python asyncio2.py<br />Al&#244; - Tempo decorrido: 0.007002<br />Fazendo algo... espera = 0.360861<br />Fazendo algo... espera = 0.411369<br />Fazendo algo... espera = 0.788518<br />Fazendo algo... espera = 0.253137<br />Fazendo algo... espera = 0.193489<br />Al&#244; - Tempo decorrido: 2.003724<br />Fazendo algo... espera = 0.142127<br />Fazendo algo... espera = 0.523892<br />Fazendo algo... espera = 0.250166<br />Fazendo algo... espera = 0.467522<br />Fazendo algo... espera = 0.304402<br />Fazendo algo... espera = 0.831368<br />Al&#244; - Tempo decorrido: 1.988947<br />Fazendo algo... espera = 0.647338<br />Fazendo algo... espera = 0.378327<br />Fazendo algo... espera = 0.013393<br />Fazendo algo... espera = 0.284973<br />Fazendo algo... espera = 0.368350<br />Al&#244; - Tempo decorrido: 2.002417<br />Fazendo algo... espera = 0.257536<br /></pre><br />Os valores de espera podem variar de uma execu&#231;&#227;o a outra, o importante &#233; observar que chamamos a fun&#231;&#227;o <b>faz_algo</b> e <b>print_and_repeat</b> s&#227;o chamadas alternadamente, ou melhor, quase que ao mesmo tempo, como se estiv&#233;ssemos utilizando threads. O que o novo programa faz &#233; executar <b>print_and_repeat</b> como no primeiro exemplo, mas tamb&#233;m a fun&#231;&#227;o <b>faz_algo</b>. A fun&#231;&#227;o <b>faz_algo</b> gera um tempo de espera aleat&#243;rio, usando <b>random.random()</b> para agendar a pr&#243;xima execu&#231;&#227;o. Como <b>print_and_repeat</b> executa apenas a cada 2 segundos, o loop de eventos fica livre para executar outras tarefas, o que podemos ver na sa&#237;da de nosso programa.<br />O programa equivalente, sem o loop de eventos ficaria parecido com:<br /><br /><pre class="brush:python">import time<br />import random<br /><br />def faz_algo():<br />    espera = random.random()<br />    print("Fazendo algo... espera = %f" % espera)<br />    time.sleep(espera)<br /><br />def print_and_repeat():<br />    global &#250;ltimo<br />    agora = time.time()<br />    print('Al&#244; - Tempo decorrido: %f' % (agora - &#250;ltimo))<br />    &#250;ltimo = agora    <br /><br />&#250;ltimo = 0<br />while True:<br />   agora = time.time()<br />   if agora - &#250;ltimo &gt;= 2:<br />      print_and_repeat()<br />   else:<br />      faz_algo()<br /></pre><br />Que produz uma sa&#237;da semelhante: <br /><br /><pre>Z:\artigos&gt;c:\python34\python asyncio3.py<br />Al&#244; - Tempo decorrido: 1403984084.967565<br />Fazendo algo... espera = 0.233725<br />Fazendo algo... espera = 0.309948<br />Fazendo algo... espera = 0.551685<br />Fazendo algo... espera = 0.835331<br />Fazendo algo... espera = 0.008247<br />Fazendo algo... espera = 0.140163<br />Al&#244; - Tempo decorrido: 2.081037<br />Fazendo algo... espera = 0.597524<br />Fazendo algo... espera = 0.004582<br />Fazendo algo... espera = 0.054279<br />Fazendo algo... espera = 0.037356<br />Fazendo algo... espera = 0.951933<br />Fazendo algo... espera = 0.003549<br />Fazendo algo... espera = 0.856917<br />Al&#244; - Tempo decorrido: 2.506460<br />Fazendo algo... espera = 0.435528<br />Fazendo algo... espera = 0.599356<br />Fazendo algo... espera = 0.798355<br />Fazendo algo... espera = 0.594801<br /></pre><br />O importante &#233; notar que quanto mais tarefas temos a realizar, mais complicado ficaria escrever o programa equivalente, sem o loop de eventos. Um conceito a tamb&#233;m observar &#233; que apenas uma das fun&#231;&#245;es roda de cada vez. Este detalhe permite construir nossos programas como fazemos normalmente, sem nos preocuparmos com threads. Outro detalhe &#233; o m&#243;dulo <b>asyncio</b> traz v&#225;rias outras classes que ajudam a trabalhar de forma ass&#237;ncrona com arquivos e sockets, por exemplo. A programa&#231;&#227;o com loop de eventos n&#227;o resolve todos os tipos de problema. Vejamos uma fun&#231;&#227;o chamada <b>calcula_algo</b> que utiliza o processador para realizar um c&#225;lculo relativamente demorado. Veja o programa abaixo: <br /><br /><pre class="brush:python">import asyncio<br />import time<br />import random<br /><br />def calcula_algo(loop, id):<br />    limite = random.randint(30000,50000)<br />    print("Calculando %d" % id)<br />    z=1<br />    for x in range(1,limite):<br />        z*=x<br />    print("Fim do C&#225;lculo %d" % id)<br />    loop.call_soon(calcula_algo, loop, id+2)<br /><br />def faz_algo(loop):<br />    espera = random.random()<br />    print("Fazendo algo... espera = %f" % espera)<br />    loop.call_later(espera, faz_algo, loop)<br /><br />def print_and_repeat(loop):<br />    global &#250;ltimo<br />    agora = time.time()<br />    print('Al&#244; - Tempo decorrido: %f' % (agora - &#250;ltimo))<br />    &#250;ltimo = agora<br />    loop.call_later(2, print_and_repeat, loop)<br /><br />&#250;ltimo = time.time()<br />loop = asyncio.get_event_loop()<br />loop.call_soon(print_and_repeat, loop)<br />loop.call_soon(faz_algo, loop)<br />loop.call_soon(calcula_algo, loop, 1)<br />loop.call_soon(calcula_algo, loop, 2)<br />loop.run_forever()<br /></pre><br />Que produz como sa&#237;da: <br /><br /><pre>Z:\artigos&gt;c:\python34\python asyncio4.py<br />Al&#244; - Tempo decorrido: 0.007003<br />Fazendo algo... espera = 0.761420<br />Calculando 1<br />Fim do C&#225;lculo 1<br />Calculando 2<br />Fim do C&#225;lculo 2<br />Calculando 3<br />Fim do C&#225;lculo 3<br />Calculando 4<br />Fim do C&#225;lculo 4<br />Fazendo algo... espera = 0.395006<br />Al&#244; - Tempo decorrido: 6.790526<br />Calculando 5<br />Fim do C&#225;lculo 5<br />Calculando 6<br />Fim do C&#225;lculo 6<br />Calculando 7<br />Fim do C&#225;lculo 7<br />Calculando 8<br />Fim do C&#225;lculo 8<br />Fazendo algo... espera = 0.540093<br />Al&#244; - Tempo decorrido: 5.859909<br />Calculando 9<br />Fim do C&#225;lculo 9<br />Calculando 10<br />Fim do C&#225;lculo 10<br />Calculando 11<br />Fim do C&#225;lculo 11<br />Calculando 12<br />Fim do C&#225;lculo 12<br />Fazendo algo... espera = 0.174978<br />Al&#244; - Tempo decorrido: 6.830562<br />Calculando 13<br />Fim do C&#225;lculo 13<br />Calculando 14<br /></pre><br />Veja que o atraso para chamar as outras fun&#231;&#245;es &#233; agora muito mais importante, ultrapassando os 6 segundos entre as chamadas de <b>print_and_repeat</b> e tendo um atraso consider&#225;vel tamb&#233;m no processamento de <b>faz_algo</b>. Bem, este comportamento &#233; esperado, uma vez que a fun&#231;&#227;o <b>calcula_algo</b> &#233; o que se chama de <i>CPU bound</i>, ou seja, &#233; uma fun&#231;&#227;o que precisa mais da aten&#231;&#227;o do processador do computador que uma opera&#231;&#227;o de cria&#231;&#227;o de arquivo (<i>I/O bound</i>). <br /><br />Para utilizar corretamente seu computador, voc&#234; deve come&#231;ar a separar seus problemas em <i>CPU bound</i> e <i>I/O bound</i>. No caso de problemas <i>CPU bound</i>, threads oferecem a melhor performance, pois temos v&#225;rios processadores no mesmo computador. J&#225; para problemas <i>I/O bound</i>, ou seja, que precisam acessar o disco ou a rede (ou entrada de dados vinda do teclado), o loop de eventos ass&#237;ncrono &#233; mais r&#225;pido e f&#225;cil de programar. Em problemas mistos, onde temos c&#243;digo <i>CPU bound</i> e c&#243;digo<i> I/O bound</i> a executar, uma solu&#231;&#227;o mista precisa ser aplicada.<br /><br />Por exemplo, threads s&#227;o relativamente caros para serem criados e s&#227;o dif&#237;ceis de controlar e programar. Nos pr&#243;ximos posts, abordarei outros detalhes do m&#243;dulo asyncio. Antes de continuarmos com m&#233;todos ass&#237;ncronos, vamos comparar o tempo de execu&#231;&#227;o entre as solu&#231;&#245;es ass&#237;ncronas, m&#250;ltiplos threads e com m&#250;ltiplos processos. Vamos avaliar vers&#245;es modificadas da fun&#231;&#227;o <b>calcula_algo</b> para cada um dessas formas de paraleliza&#231;&#227;o. O problema testado ser&#225; o tempo de total de execu&#231;&#227;o de 20 chamadas a <b>calcula_algo</b>.<br /><br />Antes de come&#231;armos, vamos remover a parte aleat&#243;ria da fun&#231;&#227;o e transformar o valor de limite em uma constante. Desta forma as compara&#231;&#245;es ser&#227;o mais justas e n&#227;o depender&#227;o do n&#250;mero obtido por <b>randint()</b>.<br /><br /><pre class="brush:python">import asyncio<br />import time<br /><br />def calcula_algo(loop, id):<br />    limite = 40000<br />    print("Calculando %d" % id)<br />    z=1<br />    for x in range(1,limite):<br />        z*=x<br />    print("Fim do C&#225;lculo %d" % id)<br />    if id &lt; 20:<br />        loop.call_soon(calcula_algo, loop, id+1)<br />    else:<br />        loop.stop()<br /><br />inicio = time.time()<br />loop = asyncio.get_event_loop()<br />loop.call_soon(calcula_algo, loop, 1)<br />loop.run_forever()<br />fim = time.time()<br />print("Tempo total: %f s" % (fim-inicio))<br /></pre><br />Execute o programa e veja que o c&#225;lculo foi feito de forma sequencial, ou seja, uma chamada ap&#243;s a outra. Em meu computador o teste executou em aproximadamente 30.37 s. O tempo em seu computador pode e vai variar, pois depende do seu processador e do que sua m&#225;quina est&#225; fazendo durante os testes. <br /><br /><pre class="brush:python">import time<br />import threading<br /><br />def calcula_algo(id):<br />    limite = 40000<br />    print("Calculando %d" % id)<br />    z=1<br />    for x in range(1,limite):<br />        z*=x<br />    print("Fim do C&#225;lculo %d" % id)<br /><br />inicio = time.time()<br />ativos = []<br />for x in range(20):<br />    t = threading.Thread(target=calcula_algo, args=(x,))<br />    t.start()<br />    ativos.append(t)<br />for t in ativos:<br />    t.join()<br />fim = time.time()<br />print("Tempo total: %f s" % (fim-inicio))<br /></pre><br />Compare a sa&#237;da do programa com m&#250;ltiplos threads com a sa&#237;da do programa ass&#237;ncrono. Veja que as chamadas foram iniciadas quase que ao mesmo tempo e que terminaram em uma ordem aleat&#243;ria. Esta falta de previsibilidade de threads &#233; uma das raz&#245;es de evitarmos seu uso, especialmente em Python. Devido a uma caracter&#237;stica do interpretador Python, que utiliza um lock global, o famoso GIL, programas com m&#250;ltiplos thread em Python n&#227;o s&#227;o eficientes, pois apenas um thread executa de cada vez, o que nos faz voltar ao problema do programa ass&#237;ncrono adicionado ao tempo de cria&#231;&#227;o e execu&#231;&#227;o dos threads. Em meus testes, este programa teve um desempenho um pouco pior que o programa ass&#237;ncrono, terminando em 30.67 s. Se voc&#234; executar novamente este programa, ver&#225; que a utiliza&#231;&#227;o de CPU n&#227;o chega nem perto de 100%. Em meu sistema Core i7 que possui 8 cores (4 reais + 4 hyperthreaded), a utiliza&#231;&#227;o n&#227;o passou de 20%. <br />Vejamos uma solu&#231;&#227;o mais Pythonica, utilizando m&#250;ltiplos processos e o excelente m&#243;dulo multiprocessing. <br /><br /><pre class="brush:python">import sys<br />import time<br />from multiprocessing import Pool<br /><br />def calcula_algo(id):<br />    limite = 40000<br />    print("Calculando %d" % id)<br />    z=1<br />    for x in range(1,limite):<br />        z*=x<br />    print("Fim do C&#225;lculo %d" % id)<br /><br />if __name__ == '__main__':<br />    nproc = int(sys.argv[1])<br />    print("Executando com %d processos.")<br />    inicio = time.time()<br />    processos = Pool(nproc)<br />    processos.map(calcula_algo,list(range(20)))<br />    fim = time.time()<br />    print("Tempo total: %f s" % (fim-inicio))<br /></pre><br />Execute o programa v&#225;rias vezes, passando a cada execu&#231;&#227;o, um dos par&#226;metros 1, 2, 4, 8 e 20. O par&#226;metro indica quantos processos teremos em nosso pool. Um pool de processos &#233; um conjunto de processos inicializados pelo m&#243;dulo multiprocessing. Estes processos ficam dispon&#237;veis para o nosso programa e s&#227;o processos do sistema operacional e n&#227;o simples threads. Toda a comunica&#231;&#227;o entre processos &#233; gerenciada pelo m&#243;dulo multiprocessing. Este m&#243;dulo &#233; muito interessante, pois realizar este tipo de tarefa em outras linguagens &#233; bem mais complicado. Uma das vantagens do multiprocessing &#233; que cada processo roda seu pr&#243;prio interpretador Python e assim s&#227;o capazes de rodar simultaneamente, sem os problemas do GIL que falamos anteriormente. Veja no Gerenciador de Tarefas de seu sistema operacional que m&#250;ltiplos processos python (ou python.exe no Windows) rodam ao mesmo tempo durante a execu&#231;&#227;o de nosso programa e que agora voc&#234; deve ter obtido 100% de utiliza&#231;&#227;o durante alguns momentos. Veja o resultado da execu&#231;&#227;o de todos os testes em meu computador no gr&#225;fico abaixo (passe o mouse sobre as colunas para ver seu valor):<br /><br />    <br /><div id="chart_div"></div><br />A solu&#231;&#227;o com o multiprocessing melhora ao adicionarmos processos, mas esta melhoria se estabiliza em volta do n&#250;mero de processadores de sua m&#225;quina e come&#231;a a piorar um pouco depois disso. <br /><br />O mau desempenho do m&#243;dulo asyncio &#233; apenas um exemplo de m&#225; utiliza&#231;&#227;o :-D. Os m&#233;todos ass&#237;ncronos devem ser utilizados com fun&#231;&#245;es que n&#227;o bloqueiam e que terminam rapidamente. Usar m&#233;todos ass&#237;ncronos com fun&#231;&#245;es <i>CPU bound</i> n&#227;o pode trazer bons resultados. No entanto, devido aos problemas com o GIL, m&#233;todos ass&#237;ncronos podem simplificar o trabalho de programa&#231;&#227;o e manter a performance de m&#250;ltiplos threads. Pois a execu&#231;&#227;o sequencial das fun&#231;&#245;es evita a necessidade de sincronizar seus dados. Mesmo com os problemas de GIL, programas em Python que usam threads devem se preparar para execu&#231;&#227;o simult&#226;nea de fun&#231;&#245;es, pois a execu&#231;&#227;o salta de um thread a outro durante a execu&#231;&#227;o das fun&#231;&#245;es. Veremos uma outra compara&#231;&#227;o entre threads e m&#233;todos ass&#237;ncronos em outro posto, usando arquivos.<br /><br />Isto &#233; s&#243; uma pequena amostra do que podemos fazer em Python. Em outro post, abordaremos exemplos mais pr&#225;ticos. O importante &#233; saber a diferen&#231;a entre a execu&#231;&#227;o ass&#237;ncrona, com threads e com m&#250;ltiplos processos. Veremos tamb&#233;m como usar como usar um pool de threads em Python e assim combinar as vantagens de threads e m&#233;todos ass&#237;ncronos.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2014/06/python-asyncio-metodos-assincronos-em.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:40	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-3214520847251526783"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2014/08/asyncio-e-corotinas.html">
Asyncio e corotinas	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2014-08-10-asyncio-e-corotinas/">Leia no novo blog</a><br /><br />Continuando a s&#233;rie sobre o m&#243;dulo <a href="https://docs.python.org/3/library/asyncio.html" target="_blank">asyncio</a>&nbsp;do Python 3.4, vou apresentar as corotinas e como elas simplificam a escrita de nossos programas com o <b>loop</b> de eventos. Com a sa&#237;da do Python 3.4, eu atualizei o livro de <a href="http://python.nilo.pro.br/index.html" target="_blank">Introdu&#231;&#227;o &#224; Programa&#231;&#227;o com Python</a>. Alguns assuntos fogem ao escopo do livro que &#233; destinado a iniciantes. Eu estou continuando uma s&#233;rie de posts curtos sobre alguns t&#243;picos que acho interessantes e quem sabe at&#233; podem virar base para um novo livro. <a href="http://junglecoders.blogspot.be/2014/06/python-asyncio-metodos-assincronos-em.html" target="_blank">Clique aqui</a> para ler o primeiro artigo.<br /><br />No artigo anterior, apresentamos uma chamada ao <b>loop</b> de eventos bem simples: <br /><pre class="brush:python">import asyncio<br /><br />def print_and_repeat(loop):<br />    print('Hello World')<br />    loop.call_later(2, print_and_repeat, loop)<br /><br />loop = asyncio.get_event_loop()<br />loop.call_soon(print_and_repeat, loop)<br />loop.run_forever()<br /></pre><br />Vejamos como reescrever este exemplo simples usando corotinas: <br /><pre class="brush:python">import asyncio<br /><br />@asyncio.coroutine<br />def print_and_repeat(loop):<br />    while True:<br />        print('Hello World')<br />        yield from asyncio.sleep(2)<br /><br />loop = asyncio.get_event_loop()<br />try:<br /> loop.run_until_complete(print_and_repeat(loop))<br />finally:<br /> loop.close()<br /></pre><br />Este exemplo foi extra&#237;do da <a href="https://docs.python.org/3/library/asyncio-task.html#example-hello-world-coroutine" target="_blank">documenta&#231;&#227;o do Python</a>, vamos ver o que mudou. A principal mudan&#231;a no in&#237;cio do programa &#233; o uso do decorador&nbsp;<b>@asyncio.coroutine</b>. Este decorador transforma nossa fun&#231;&#227;o em uma corotina e permite a utiliza&#231;&#227;o do <b>yield from</b>, como definido na <a href="http://legacy.python.org/dev/peps/pep-0380/" target="_blank">PEP380</a>. Veja que o cabe&#231;alho da fun&#231;&#227;o n&#227;o foi alterado, mas que substitu&#237;mos a chamada de <b>loop.call_later</b> pela combina&#231;&#227;o de um <b>while True</b> com um <b>yield from</b> no final. Uma corotina pode ser suspensa e esperar o processamento de uma outra corotina. No caso, <b>asyncio.sleep(2)</b> &#233; uma corotina do m&#243;dulo <b>asyncio</b> que suspende a execu&#231;&#227;o da fun&#231;&#227;o pelo n&#250;mero de segundos passados como par&#226;metro. Na realidade, esta chamada retorna uma corotina que &#233; marcada como completa ap&#243;s os 2 segundos. Isto pode ser realizado pois no <b>yield from</b>, criamos a nova corotina e indicamos ao <b>loop</b> que n&#227;o continue a executar <b>print_and_repeat</b> at&#233; que a nova corotina esteja conclu&#237;da. A partir deste ponto, a execu&#231;&#227;o volta ao <b>loop</b> de eventos que monitora a conclus&#227;o da nova corotina criada, suspendendo a execu&#231;&#227;o da anterior. Uma vez que o a corotina do <b>sleep</b> &#233; conclu&#237;da, ap&#243;s 2 segundos, o <b>loop</b> reativa a chamada suspensa de <b>print_and_repeat</b> e a execu&#231;&#227;o continua, voltando para o <b>while</b>. Parece complicado, mas veja como ficou f&#225;cil de escrevermos a fun&#231;&#227;o. Fica bem mais claro nossa inten&#231;&#227;o de realizar uma repeti&#231;&#227;o do <b>print('Hello World')</b> a cada 2 segundos.<br /><br />Modificamos tamb&#233;m a chamada de execu&#231;&#227;o da corotina, pois agora utilizamos <b>loop.run_until_complete</b> para iniciar nossa corotina principal. Aproveitamos para colocar tudo entre um <b>try...finally</b> para terminar a execu&#231;&#227;o do <b>loop</b> corretamente (mesmo em caso de exce&#231;&#227;o). Perceba que no exemplo anterior, com <b>call_soon</b>, passamos a fun&#231;&#227;o e seus par&#226;metros, mas n&#227;o executamos a fun&#231;&#227;o em si. No caso de <b>run_until_complete</b>, estamos passando o retorno da chamada de <b>print_and_repeat</b> que &#233; uma corotina, uma vez que a marcamos com o decorador&nbsp;<b>@asyncio.coroutine</b>.<br /><br />No post anterior comparamos a velocidade de execu&#231;&#227;o entre as v&#225;rias formas de se executar c&#243;digo em paralelo com Python. Agora veremos como usar o <b>asyncio</b> para criar uma aplica&#231;&#227;o pr&#225;tica, como um cliente e um servidor TCP/IP, mas indo al&#233;m dos exemplos da documenta&#231;&#227;o do Python. &#201; preciso lembrar que o m&#243;dulo <b>asyncio</b> ainda &#233; muito novo e que tanto a documenta&#231;&#227;o quanto a implementa&#231;&#227;o de algumas funcionalidades ainda est&#227;o sendo alteradas.<br /><br />Vamos come&#231;ar pelo servidor. Um servidor TCP/IP &#233; um exemplo cl&#225;ssico de programa chato a escrever. Normalmente, voc&#234; pode escolher utilizar <b>threads</b> ou se aventurar com <b>select</b> e chamadas n&#227;o bloqueantes para gerenciar v&#225;rias conex&#245;es. Este problema se agrava em aplica&#231;&#245;es mais complexas, onde algum processamento precisa ser realizado antes de se gerar a resposta, por exemplo, a um comando do usu&#225;rio. Usando o m&#243;dulo <b>asyncio</b>, esta tarefa fica bem mais f&#225;cil. Primeiro, porque o tratamento de dados &#233; gerenciado por uma classe, respons&#225;vel pelo protocolo. Esta classe traz m&#233;todos que s&#227;o chamados em situa&#231;&#245;es comuns ao programarmos um servidor TCP/IP, como chegada de uma nova conex&#227;o, desconex&#227;o, chegada de dados para leitura entre outras. Al&#233;m disso, o <b>asyncio</b> tamb&#233;m traz classes especializadas em quebrar os dados em linhas, o que facilita a implementa&#231;&#227;o de protocolos com comandos em formato texto, terminados por enter (CR).<br /><br />O servidor &#233; controlado por uma classe chamada <b>EchoServer</b>, pois o desenvolvi a partir do servidor de Echo dado como exemplo na documenta&#231;&#227;o, mas com alguns detalhes que observei no c&#243;digo do m&#243;dulo <b>asyncio</b>. O protocolo implementado &#233; bem simples, a cada linha, a data e hora atuais s&#227;o enviadas. Se o cliente enviar sair a conex&#227;o &#233; terminada. Vamos ver o programa completo e discutir parte por parte.<br /><br /><pre class="brush:python">import asyncio<br />import time<br />from common import *<br /><br />class EchoServer(asyncio.streams.FlowControlMixin):    <br />    ativas = 0<br />    def connection_made(self, transporte):        <br />        peername = transporte.get_extra_info('peername')<br />        print('Conex&#227;o de {}'.format(peername))<br />        EchoServer.ativas+=1<br />        print("Conex&#245;es ativas: {}".format(EchoServer.ativas))<br />        self.transporte = transporte<br />        self.leitor = asyncio.StreamReader()<br />        self.leitor.set_transport(self.transporte)<br />        self.escritor = asyncio.StreamWriter(transport=self.transporte, protocol=self, reader=self.leitor, loop=asyncio.get_event_loop())        <br />        asyncio.async(self.gerencia())<br />    <br />    @asyncio.coroutine<br />    def gerencia(self):        <br />        while True:<br />            dados = yield from self.leitor.readline()                        <br />            self.escritor.write(strToByte(time.strftime("%c")+"\r\n"))            <br />            yield from self.escritor.drain()<br />            comando = byteToStr(dados).strip().lower()<br />            if(comando == "sair"):<br />                self.transporte.close()<br />                return<br /><br />    def connection_lost(self, exp):                <br />        EchoServer.ativas-=1<br />        print("Conex&#245;es ativas: {}".format(EchoServer.ativas))<br />        super().connection_lost(exp)<br /><br />    def data_received(self, dados):                <br />        print('data received: {0}'.format(byteToHex(dados)))<br />        print('     received: {0}'.format(strPrintable(dados)))<br />        print('       string: {0}'.format(byteToStr(dados)))<br />        self.leitor.feed_data(dados)<br />        <br /><br />loop = asyncio.get_event_loop()<br />coro = loop.create_server(EchoServer, '127.0.0.1', 8888)<br />servidor = loop.run_until_complete(coro)<br />print('Escutando {}'.format(servidor.sockets[0].getsockname()))<br /><br />try:<br />    loop.run_forever()<br />except KeyboardInterrupt:<br />    print("exit")<br />finally:<br />    servidor.close()    <br />    loop.close()<br /></pre><br />A classe <b>EchoServer</b> herda de uma classe fornecida em <b>asyncio.streams</b>, chamada <b>FlowControlMixin</b>. A classe <b>FlowControlMixin</b> &#233; por sua vez derivada de <b>Protocols</b>, tamb&#233;m fornecida pelo m&#243;dulo <b>asyncio</b>. A ideia desta classe &#233; implementar um <i>protocol factory</i>, ou seja, um construtor de inst&#226;ncias respons&#225;veis pela implementa&#231;&#227;o da gest&#227;o de cada nova conex&#227;o. Um protocolo normal, precisa herdar apenas de <b>Protocols</b>, mas para utilizar alguns m&#233;todos para leitura buferizada de linhas, especialmente o <b>write.drain</b> que veremos logo ap&#243;s, a implementa&#231;&#227;o contida em <b>FlowControlMixin</b> &#233; interessante.<br /><br />Aproveitamos a nova classe para contar o n&#250;mero de conex&#245;es ativas. Cada nova conex&#227;o recebida por nosso servidor TCP/IP chama o construtor de nossa classe e o m&#233;todo <b>connection_made</b>, passando o transporte (entenda como o <i>socket</i> j&#225; conectado) como par&#226;metro.<br /><br />Utilizando o par&#226;metro <b>transporte</b>, chamamos o m&#233;todo <b>get_extra_info('peername')</b> para obter o endere&#231;o do cliente que acabou de se conectar ao servidor. Logo em seguida, incrementamos o n&#250;mero de conex&#245;es. Veja que como o c&#243;digo que roda no <b>loop</b> de eventos n&#227;o &#233; <i>multi-threaded</i>, n&#227;o precisamos de <i>locks</i> ou de outros mecanismos de controle, j&#225; que apenas uma fun&#231;&#227;o roda a cada vez. O resto do m&#233;todo <b>connection_made</b> prepara as inst&#226;ncias do leitor e do escritor, objetos das classes <b>StreamReader</b> e <b>StreamWriter</b> respectivamente. Estes objetos v&#227;o fornecer corotinas &#250;teis para ler e escrever os dados de forma n&#227;o bloqueante. Veja que passamos <b>transporte</b> tanto para o escritor quanto para o leitor e que uma s&#233;rie de par&#226;metros s&#227;o necess&#225;rios para a inicializa&#231;&#227;o do escritor.<br /><br />No fim de <b>connection_made</b>, usamos a fun&#231;&#227;o <b>asyncio.async</b> para iniciar o processamento da corotina <b>self.gerencia</b>, dentro do <b>loop</b> de eventos. Veja que o m&#233;todo <b>gerencia</b> foi marcado com o decorador&nbsp;<b>@asyncio.coroutine</b>.<br /><br />O m&#233;todo gerencia cont&#233;m uma estrutura de repeti&#231;&#227;o <b>while</b> que espera uma linha do cliente. Veja que utilizamos <b>yield from</b> para suspender a execu&#231;&#227;o de <b>gerencia</b> enquanto <b>self.leitor.readline()</b> n&#227;o terminar. Neste ponto, a execu&#231;&#227;o volta para o <b>loop</b> de eventos e retorna apenas quando <b>self.leitor.readline()</b> cont&#233;m uma linha enviada pelo cliente ou caso uma exce&#231;&#227;o tenha ocorrido. O uso do <b>yield from</b> &#233; fundamental, pois caso o <b>readline()</b> esperasse o cliente enviar a linha para continuar a execu&#231;&#227;o, todo o <b>loop</b> de eventos seria bloqueado. Como o uso do <b>yield from</b>, a execu&#231;&#227;o volta para o <b>loop</b> que &#233; livre para executar outros m&#233;todos e outras corotinas. O objetivo &#233; n&#227;o fazer o computador esperar por dados ou resultados que demoram muito tempo (ou um tempo desconhecido, possivelmente longo, para retornar). Outra caracter&#237;stica de <b>yield from</b> &#233; que o resultado do <b>self.leitor.readline()</b> &#233; retornado e no caso, armazenado na vari&#225;vel dados.<br /><br />A execu&#231;&#227;o segue normalmente e nosso servidor envia a hora e a data atual, veja que uma linha foi acrescentada ao final da string. Este fim de linha &#233; importante, pois como nosso protocolo &#233; em formato texto e orientado a linhas, esperamos o enter (CR) para processar o comando ou a resposta.<br />Depois de escrever a resposta, usamos <b>self.escritor.drain()</b> que &#233; uma outra corotina. Esta nova corotina n&#227;o completa at&#233; o que o <i>buffer</i> de escrita seja enviado. Desta forma, podemos garantir que os dados foram enviados (ainda que n&#227;o possamos ter certeza se estes foram recebidos pelo cliente) antes de continuarmos. Como usamos <b>yield from</b> com esta corotina, a execu&#231;&#227;o &#233; suspensa at&#233; que o <b>drain</b> seja completado.<br /><br />Como usamos Python 3.4, os dados s&#227;o do tipo <b>byte</b> e n&#227;o string. A fun&#231;&#227;o <b>byteToStr</b> converte de bytes para string, usando a codifica&#231;&#227;o UTF-8. Esta fun&#231;&#227;o ser&#225; apresentada no programa <b>common.py</b>, compartilhando rotinas &#250;teis tanto para nosso cliente quanto para nosso servidor. Para facilitar o processamento de comandos, retiramos os espa&#231;os em branco do in&#237;cio e fim do comando, inclusive enter (CR) e LF, e convertemos o resultado para min&#250;sculas com <b>lower</b>. Se o comando for igual a "sair", chamamos o m&#233;todo <b>close</b> de <b>self.transporte</b> para encerarmos a conex&#227;o. Veja que ao fecharmos a conex&#227;o, finalmente retornamos como em uma fun&#231;&#227;o normal, utilizando <b>return</b> e terminando assim a execu&#231;&#227;o de nossa corotina <b>gerencia</b>.<br /><br />O m&#233;todo <b>connection_lost</b> &#233; chamado quando a desconex&#227;o do cliente &#233; detectada. O n&#250;mero de conex&#245;es ativas &#233; decrementado e o m&#233;todo <b>connection_lost</b> da superclasse &#233; chamado. O par&#226;metro <b>exp</b> cont&#233;m <b>None</b> caso seja uma desconex&#227;o normal ou a exce&#231;&#227;o em caso de erro. Neste exemplo n&#227;o estamos tratando os poss&#237;veis erros para nos concentrarmos no <b>asyncio</b>.<br /><br />J&#225; o m&#233;todo <b>data_received</b> &#233; chamado sempre que dados forem recebidos pelo transporte. Os dados recebidos s&#227;o passados como par&#226;metro (<b>dados</b>). Aqui, inclu&#237; algumas fun&#231;&#245;es de <i>debug</i> que exibem os dados em formato hexadecimal, string e UTF-8. Estas fun&#231;&#245;es s&#227;o necess&#225;rias para verificarmos se os dados est&#227;o chegando no formato esperado. Voc&#234; pode executar um teste com um programa de telnet cl&#225;ssico, como o Putty no Windows, mas n&#227;o esque&#231;a de desativar a op&#231;&#227;o de negocia&#231;&#227;o do protocolo, para evitar que comandos que n&#227;o interpretamos sejam enviados, ou simplesmente, teste com o cliente que &#233; apresentado logo abaixo.<br /><br />Um detalhe muito importante de <b>data_received</b> &#233; a chamada do m&#233;todo <b>self.leitor.feed_data</b>, que envia os dados para o <b>leitor</b>, respons&#225;vel por quebrar os dados em linhas.<br /><br />Em nosso programa principal, obtemos o <b>loop</b> de eventos com <b>get_event_loop()</b> e criamos uma corotina que inicializa nosso servidor com <b>loop.create_server</b>. Em <b>create_server</b>, informamos o endere&#231;o que nosso servidor ir&#225; escutar (ip e porta). Veja que a classe <b>EchoServer</b> foi passada como <i>protocol factory</i>.<br /><br />Ao chamarmos <b>loop.run_until_complete(coro)</b>, o <b>loop</b> de eventos roda at&#233; que a corotina criada pelo <b>create_server</b> termine, retornando um objeto servidor, utilizado para parar o servidor e para ter acesso a todas as conex&#245;es, mas isso fica para outro post.<br /><br />Chamamos <b>loop.run_forever()</b> para ativar nosso servidor. Para desativ&#225;-lo, digite CTRL+C.<br /><br />Neste ponto, o endere&#231;o 127.0.0.1, porta 8888 estar&#225; recebendo conex&#245;es. Quando uma conex&#227;o for recebida, uma nova inst&#226;ncia de <b>EchoServer</b> ser&#225; criada. Ao se estabelecer a conex&#227;o o m&#233;todo <b>connection_made</b> ser&#225; chamado e ativar&#225; uma corotina <b>gerencia</b> para gerenciar a recep&#231;&#227;o e o envio de linhas de comandos. O m&#233;todo <b>data_received</b> &#233; chamado sempre que novos dados forem recebidos (seja uma linha completa ou n&#227;o). O m&#233;todo <b>connection_lost</b> &#233; chamado quando o cliente se desconectar.<br /><br />Vejamos o c&#243;digo fonte de <b>common.py</b>:<br /><br /><pre class="brush:python">import string<br /><br />def byteToHex(data, sep=" "):<br />    return sep.join("{0:02X}".format(x) for x in data)<br /><br />def strPrintable(data, sep=" "):<br />    return sep.join("{0:2s}".format(chr(s) if chr(s) in string.printable and s&gt;30 else ".") for s in data)<br /><br />def strToByte(s, encoding ="utf-8"):<br />    return s.encode(encoding)<br /><br />def byteToStr(data, encoding ="utf-8"):<br />    return data.decode(encoding, errors="replace")<br /></pre><br />E o c&#243;digo fonte de nosso cliente.py:<br /><br /><pre class="brush:python">import asyncio<br />import time<br />from common import *<br /><br />class EchoClient(asyncio.streams.FlowControlMixin):        <br />    def connection_made(self, transporte):        <br />        peername = transporte.get_extra_info('peername')<br />        print('Conectado &#224; {}'.format(peername))                <br />        self.transporte = transporte<br />        self.leitor = asyncio.StreamReader()<br />        self.leitor.set_transport(self.transporte)<br />        self.escritor = asyncio.StreamWriter(transport=self.transporte, protocol=self, reader=self.leitor, loop=asyncio.get_event_loop())        <br />        asyncio.async(self.gerencia())<br />        self.feito = asyncio.Future()<br />    <br />    @asyncio.coroutine<br />    def gerencia(self):        <br />        for x in range(10):                        <br />            self.escritor.write(strToByte("Al&#244;\r\n"))<br />            yield from self.escritor.drain()<br /><br />            dados = yield from self.leitor.readline()            <br />        self.escritor.write(strToByte("sair\r\n"))<br />        yield from self.escritor.drain()                                         <br />        self.transporte.close()<br />        self.feito.set_result(True)<br /><br />    def connection_lost(self, exp):        <br />        print("Conex&#227;o perdida")<br />        super().connection_lost(exp)<br /><br />    def data_received(self, dados):                <br />        print('dados recebidos: {0}'.format(byteToHex(dados)))<br />        print('      recebidos: {0}'.format(strPrintable(dados)))<br />        print('         string: {0}'.format(byteToStr(dados)))<br />        self.leitor.feed_data(dados)<br /><br />        <br />loop = asyncio.get_event_loop()<br />coro = loop.create_connection(EchoClient, '127.0.0.1', 8888)<br />transporte, protocolo = loop.run_until_complete(coro)<br /><br />try:<br />    loop.run_until_complete(protocolo.feito)<br />except KeyboardInterrupt:<br />    pass<br />finally:    <br />    loop.close()<br /></pre><br />Execute o servidor e depois o cliente, cada em uma janela ou terminal diferente. Veja que o cliente termina sua execu&#231;&#227;o ap&#243;s enviar 10 vezes o comando Al&#244; e sair. Execute v&#225;rias vezes o cliente e veja que o servidor continua ativo. Experimente aumentar o n&#250;mero de comandos de 10 para 100 no cliente e reexecute. Tente executar a partir de uma terceira janela outro cliente simultaneamente. Observe que conseguimos implementar um cliente e um servidor TCP/IP em um pouco mais de 100 linhas de c&#243;digo em Python. Um servidor capaz de atender v&#225;rios clientes sem utilizar m&#250;ltiplos threads. Voc&#234; pode comentar ou remover os <b>prints</b> que n&#227;o precisar, eles servem apenas para <i>debugar</i>.<br /><br />O c&#243;digo do cliente &#233; muito parecido com o c&#243;digo do servidor. A principal mudan&#231;a &#233; o m&#233;todo <b>gerencia</b> e o atributo <b>self.feito</b>, criado com <b>asyncio.Future()</b>. Vejamos a cria&#231;&#227;o da inst&#226;ncia de nosso cliente. A fun&#231;&#227;o <b>create_conection</b> &#233; na realidade uma corotina que recebe o protocolo (no caso <b>EchoClient</b>), o ip e a porta do servidor. Ao chamarmos <b>loop.run_until_complete(coro)</b>, uma tupla com o <b>transporte</b> e o <b>protocolo</b>&nbsp;&#233; retornada. Este retorno &#233; importante, pois precisamos ter acesso a inst&#226;ncia de <b>EchoClient</b> criada para gerenciar nossa conex&#227;o, no caso protocolo. Com a inst&#226;ncia de <b>EchoClient</b> retornada em <b>protocolo</b>, podemos rodar o <b>loop</b> at&#233; que feito seja marcada como finalizada: <b>loop.run_until_complete(protocolo.feito)</b>. Esta etapa &#233; importante, pois devemos executar o <b>loop</b> at&#233; que o cliente tenha tempo para terminar seu trabalho. Veja que no final de <b>gerencia</b>, marcamos <b>self.feito</b> como conclu&#237;da: <b>self.feito.set_result(True)</b>.<br /><br />Se voc&#234; quiser testar o servidor com v&#225;rios clientes simultaneamente, adicione a seguinte fun&#231;&#227;o ao c&#243;digo de <b>cliente.py</b> e modifique o programa principal para:<br /><br /><pre class="brush:python">@asyncio.coroutine<br />def roda_varias(vezes):<br />    pendente = []<br />    for t in range(vezes):<br />        pendente.append(asyncio.async(loop.create_connection(EchoClient, '127.0.0.1', 8888)))<br />    for y in pendente:            <br />        transporte, protocolo = yield from y<br />        yield from asyncio.wait_for(protocolo.feito, None)<br /><br />loop = asyncio.get_event_loop()<br />coro = loop.create_connection(EchoClient, '127.0.0.1', 8888)<br />client = loop.run_until_complete(coro)<br /><br />try:<br />    loop.run_until_complete(roda_varias(100))<br />except KeyboardInterrupt:<br />    pass<br />finally:    <br />    loop.close()<br /></pre><br />Voc&#234; tamb&#233;m pode utilizar <b>start_server</b> e <b>open_connection</b> para receber diretamente uma tupla com <b>StreamReader</b> e <b>StreamWriter</b>, mas estes exemplos voc&#234; pode encontrar na documenta&#231;&#227;o do Python.<br /><br />No pr&#243;ximo artigo, uma nova classe comum ser&#225; usada para gerenciar os protocolos e outra forma de instancia&#231;&#227;o ser&#225; passada para realizar uma comunica&#231;&#227;o entre v&#225;rios clientes.<br /><br /><br /><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2014/08/asyncio-e-corotinas.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:40	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-7377949371106894912"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2014/08/asyncio-lendo-o-teclado.html">
Asyncio - Lendo o teclado	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2014-08-23-asyncio-lendo-o-teclado/">Leia no novo blog</a><br /><br />Continuando a s&#233;rie sobre o m&#243;dulo <b>asyncio</b> do Python 3.4, vamos ver como criar um jogo simples, em modo texto. O objetivo do jogo &#233; simplesmente mostrar um labirinto e deixar o jogador se mover utilizando o teclado num&#233;rico (4 - esquerda, 6 - direita, 8 - cima, 2 - baixo e S para sair). Para exercitar nossos m&#250;sculos da &#233;poca do DOS com programa&#231;&#227;o ass&#237;ncrona, vamos exibir o rel&#243;gio na &#250;ltima linha. O resultado final deve se parecer com a imagem abaixo:<br /><br /><div class="separator"><a href="http://3.bp.blogspot.com/-UNULglFnVEE/U_i2AyqGLNI/AAAAAAAAAv8/jbaSKYudnGY/s1600/labirinto.png"><img border="0" height="216" src="https://3.bp.blogspot.com/-UNULglFnVEE/U_i2AyqGLNI/AAAAAAAAAv8/jbaSKYudnGY/s1600/labirinto.png" width="400" /></a></div><br />Voc&#234; precisa instalar o <a href="https://github.com/lskbr/colorconsole" target="_blank">colorconsole</a> e o Python 3.4.1 para executar este programa.<br /><br /><pre class="brush:python">from random import shuffle, randrange<br />from colorconsole import terminal<br />from concurrent.futures import ThreadPoolExecutor<br />import datetime<br />import asyncio<br /><br /># Colorconsole: https://github.com/lskbr/colorconsole<br /># Make_make: http://rosettacode.org/wiki/Maze_generation#Python<br />def make_maze(w = 16, h = 8):<br />    vis = [[0] * w + [1] for _ in range(h)] + [[1] * (w + 1)]<br />    ver = [["|  "] * w + ['|'] for _ in range(h)] + [[]]<br />    hor = [["+--"] * w + ['+'] for _ in range(h + 1)]<br /> <br />    def walk(x, y):<br />        vis[y][x] = 1<br /> <br />        d = [(x - 1, y), (x, y + 1), (x + 1, y), (x, y - 1)]<br />        shuffle(d)<br />        for (xx, yy) in d:<br />            if vis[yy][xx]: continue<br />            if xx == x: hor[max(y, yy)][x] = "+  "<br />            if yy == y: ver[y][max(x, xx)] = "   "<br />            walk(xx, yy)<br /> <br />    walk(randrange(w), randrange(h))<br />    maze = []<br />    for (a, b) in zip(hor, ver):<br />        maze.append("".join(a))<br />        maze.append("".join(b))<br />    return maze<br /> <br />class Jogo:<br />    LARGURA = 24<br />    ALTURA = 11<br />    def __init__(self):        <br />        self.tela = terminal.get_terminal(conEmu=False)<br />        self.tela.enable_unbuffered_input_mode()<br />        self.labirinto_cores = (terminal.colors["RED"],terminal.colors["BLACK"])<br />        self.jogador_carac = (terminal.colors["WHITE"],terminal.colors["BLUE"],'*')<br />        self.labirinto = make_maze(Jogo.LARGURA,Jogo.ALTURA)<br />        self.loop = asyncio.get_event_loop()<br />        self.tpool = ThreadPoolExecutor(max_workers=2)<br />        while True:<br />            self.x = randrange(Jogo.LARGURA*3)<br />            self.y = randrange(Jogo.ALTURA*2)<br />            if self.pode_mover(self.x, self.y):<br />                break<br />        self.jogando = True<br /><br />    def fim_do_jogo(self):<br />        self.jogando = False<br />        self.loop.stop()<br /><br />    @asyncio.coroutine<br />    def le_teclado(self):<br />        while self.jogando:            <br />            key = yield from self.loop.run_in_executor(self.tpool, self.tela.getch)            <br />            if(key!=None):<br />                nx, ny = self.x, self.y<br />                if key == b'4':<br />                    if nx &gt; 1:<br />                        nx-=1<br />                elif key == b'6':<br />                    if nx &lt; Jogo.LARGURA*3-1:<br />                        nx+=1<br />                elif key == b'8':<br />                    if ny &gt; 0:<br />                        ny -=1<br />                elif key == b'2':<br />                    if ny &lt; Jogo.ALTURA*2:                        <br />                        ny +=1<br />                elif key == b"S":<br />                    self.fim_do_jogo()<br />                    break<br />            if self.pode_mover(nx,ny) and (nx, ny) != (self.x,self.y):<br />                self.x, self.y = nx, ny<br />                self.desenha()           <br /><br />    def pode_mover(self, x,y):<br />        return self.labirinto[y][x]==' '<br /><br />    def desenha(self):<br />        self.tela.set_color(*self.labirinto_cores)<br />        #self.tela.clear()<br />        self.tela.gotoXY(0,0)<br />        self.tela.set_title("Labirinto") <br />        for linha in self.labirinto:<br />            print(linha)<br />        self.tela.gotoXY(self.x, self.y)<br />        self.tela.cprint(*self.jogador_carac)<br /><br />    @asyncio.coroutine<br />    def relogio(self):<br />        while self.jogando:<br />            self.tela.print_at(10,23,datetime.datetime.now().strftime("%d/%m/%y %H:%M:%S"))<br />            yield from asyncio.sleep(1)<br /><br />    def execute(self):<br />        self.tela.clear()<br />        self.desenha()<br />        try:<br />            asyncio.async(self.le_teclado())<br />            asyncio.async(self.relogio())<br />            self.loop.run_forever()<br />        except KeyboardInterrupt:<br />            print("exit")<br />        finally:<br />            self.tpool.shutdown()<br />            self.loop.close()<br />            self.tela.restore_buffered_mode()<br /><br />jogo = Jogo()<br />jogo.execute()<br /><br /></pre>Para adicionar um pouco de varia&#231;&#227;o ao jogo, eu baixei uma fun&#231;&#227;o que gera labirintos <a href="http://rosettacode.org/wiki/Maze_generation#Python" target="_blank">deste site</a>. O programa foi modificado para retornar uma lista de strings, que &#233; utilizada para detectar as paredes do labirinto.<br /><br />O loop de eventos &#233; parecido com o dos artigos anteriores, mas desta vez um ThreadPool est&#225; sendo criado. Um thread extra &#233; necess&#225;rio, pois vamos bloquear a rotina at&#233; que uma tecla seja pressionada. Esta constru&#231;&#227;o funciona com v&#225;rias rotinas bloqueantes que n&#227;o podem ser utilizadas com asyncio, pois interromperiam a execu&#231;&#227;o de todas as outras corotinas.<br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def le_teclado(self):<br />        while self.jogando:            <br />            key = yield from self.loop.run_in_executor(self.tpool, self.tela.getch)            <br />            if(key!=None):<br />                nx, ny = self.x, self.y<br />                if key == b'4':<br />                    if nx &gt; 1:<br />                        nx-=1<br />                elif key == b'6':<br />                    if nx &lt; Jogo.LARGURA*3-1:<br />                        nx+=1<br />                elif key == b'8':<br />                    if ny &gt; 0:<br />                        ny -=1<br />                elif key == b'2':<br />                    if ny &lt; Jogo.ALTURA*2:                        <br />                        ny +=1<br />                elif key == b"S":<br />                    self.fim_do_jogo()<br />                    break<br />            if self.pode_mover(nx,ny) and (nx, ny) != (self.x,self.y):<br />                self.x, self.y = nx, ny<br />                self.desenha()<br /></pre><br />Criamos <b>le_teclado</b> como uma corotina, mas como o m&#243;dulo <b>colorconsole</b> n&#227;o foi criado para trabalhar com corotinas, precisamos chamar <b>self.tela.getch</b> usando um <b><a href="https://docs.python.org/3/library/concurrent.futures.html#executor-objects" target="_blank">Executor</a></b>, no caso, nosso <b><a href="https://docs.python.org/3/library/concurrent.futures.html#threadpoolexecutor" target="_blank">ThreadPool</a></b>. Desta forma, nossa chamada bloqueante ser&#225; executada em um <i>thread</i> do ThreadPool e nosso loop de eventos vai continuar a executar normalmente. Quando pressionarmos uma tecla, a fun&#231;&#227;o <b>self.tela.getch</b> vai retornar e a partir da&#237;, trabalharemos com o resultado no <b>yield from</b>. O resto do m&#233;todo verifica se a tecla &#233; de movimento ou de sa&#237;da do jogo. No final, verificamos se o jogador se mexeu ou se a nova posi&#231;&#227;o seria a de uma parede. Caso a posi&#231;&#227;o seja alterada, redesenhamos a tela, para que a nova posi&#231;&#227;o do jogador seja vis&#237;vel.<br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def relogio(self):<br />        while self.jogando:<br />            self.tela.print_at(10,23,datetime.datetime.now().strftime("%d/%m/%y %H:%M:%S"))<br />            yield from asyncio.sleep(1)<br /></pre><br />A corotina <b>relogio</b> exibe a data e hora atuais a cada 1 segundo na tela. Esta execu&#231;&#227;o ocorre mesmo se nada pressionarmos no teclado, confirmado a correta execu&#231;&#227;o de nosso loop de eventos. Este programa pode ser executado para conter inimigos e mov&#234;-los em outra corotina, similar a do rel&#243;gio.<br /><br />Testado no Windows 8.1 com Python 3.4.1, colorconsole 0.7.1.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2014/08/asyncio-lendo-o-teclado.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:40	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-8807868321782707887"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2014/08/servidor-de-chat-com-websockets-e.html">
Servidor de Chat com websockets e asyncio	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2014-08-30-servidor-de-chat-com-websockets-e-asyncio/">Leia no novo blog</a><br /><br />J&#225; &#233; hora de escrever sobre um projeto mais completo. Aproveito para mostrar o m&#243;dulo <a href="https://github.com/aaugustin/websockets/tree/master/websockets" target="_blank">websockets</a>&nbsp;para Python 3.4 que funciona muito bem com asyncio. Para n&#227;o ter problemas de interface, eu resolvi escrever o cliente do chat em JavaScript. O cliente de exemplo foi <a href="http://www.websocket.org/echo.html" target="_blank">baixado daqui</a>. Como quase sempre, os exemplos s&#227;o muito simples e nos deixam com &#225;gua na boca sobre o que poder&#237;amos realmente fazer. Quem j&#225; tentou escrever um chat em JavaScript sabe que WebSockets s&#227;o uma m&#227;o na roda.<br /><br />Este artigo faz parte de uma s&#233;rie que escrevo sobre o asyncio do Python 3.4. Voc&#234; pode ler os outros artigos clicando aqui: <a href="http://junglecoders.blogspot.be/2014/06/python-asyncio-metodos-assincronos-em.html" target="_blank">Python e asyncio</a>, <a href="http://junglecoders.blogspot.be/2014/08/asyncio-e-corotinas.html" target="_blank">Asyncio e corotinas</a> e o <a href="http://junglecoders.blogspot.be/2014/08/asyncio-lendo-o-teclado.html" target="_blank">Lendo o teclado</a>.<br /><br />A ideia de usarmos WebSockets visa demonstrar a facilidade do m&#243;dulo websockets que deve ser instalado no Python 3.4:<br /><br /><pre class="brush:shell">pip install websockets<br /></pre><br />Uma vez instalado o m&#243;dulo, podemos criar um servidor, como o mostrado na documenta&#231;&#227;o do <a href="http://aaugustin.github.io/websockets/#module-websockets.http" target="_blank">m&#243;dulo</a>:<br /><br /><pre class="brush:python">import asyncio<br />import websockets<br /><br />@asyncio.coroutine<br />def hello(websocket, path):<br />    name = yield from websocket.recv()<br />    print("&lt; {}".format(name))<br />    greeting = "Hello {}!".format(name)<br />    yield from websocket.send(greeting)<br />    print("&gt; {}".format(greeting))<br /><br />start_server = websockets.serve(hello, 'localhost', 8765)<br /><br />asyncio.get_event_loop().run_until_complete(start_server)<br />asyncio.get_event_loop().run_forever()<br /></pre><br />Execute o servidor com:<br /><pre class="brush:shell">py -3 server.py<br /></pre><br />Para testar este programa, precisaremos de uma p&#225;gina com nosso cliente de chat. Eu preparei uma p&#225;gina com todo o c&#243;digo html e javascript necess&#225;rio. Baixe a p&#225;gina <a href="http://static.nilo.pro.br/artigos/cliente.html">cliente.html aqui</a>. Salve o arquivo e abra-o com seu browser preferido: Chrome, Firefox ou o IE (&gt;10).<br /><br />Como o servidor &#233; muito simples, tudo que podemos fazer &#233; enviar uma mensagem e receb&#234;-la de volta, j&#225; que &#233; um servidor do tipo Echo (eco). Veja tamb&#233;m que o servidor de WebSockets &#233; inicializado como nossos outros servidores com o m&#243;dulo asyncio, mas que este n&#227;o obedece uma interface com m&#233;todos definidos para conex&#227;o, recebimento de dados etc. O objeto retornado pelo m&#243;dulo websockets &#233; um objeto com o cliente j&#225; conectado. Vejamos primeiramente como criar o servidor:<br /><br /><pre class="brush:python">start_server = websockets.serve(hello, 'localhost', 8765)</pre><br />A linha acima cria nosso servidor, chamando a fun&#231;&#227;o&nbsp;<b>hello</b> sempre que um novo cliente for executado. O nome <b>localhost</b> se refere a nosso computador e 8765 &#233; a porta que utilizaremos para receber as conex&#245;es. Vejamos&nbsp;a fun&#231;&#227;o&nbsp;<b>hello</b>. Quando uma nova conex&#227;o for recebida,&nbsp;a fun&#231;&#227;o&nbsp;<b>hello</b> ser&#225; chamado com dois par&#226;metros: o primeiro &#233; o cliente j&#225; conectado e pronto para ser utilizado; e o segundo &#233; o <b>path</b> ou o caminho usado (veremos isso depois em outro artigo). Na realidade, a corotina <b>hello</b> &#233; respons&#225;vel pelo tempo de vida e gest&#227;o da conex&#227;o do cliente. Quando a corotina <b>hello</b> termina, o cliente &#233; desconectado. Veja tamb&#233;m que usamos o <b>yield from</b> para enviar e receber dados. O uso do <b>yield from</b> permite que escrevamos nosso c&#243;digo como se sua execu&#231;&#227;o fosse sequencial, como j&#225; discutimos nos outros artigos.<br /><br />Um detalhe importante a notar &#233; que a interface do m&#243;dulo websockets j&#225; entrega os dados no formato de mensagem (como definido pelo protocolo). Diferentemente de um socket TCP/IP comum que trabalha com streams, entregando bytes. Quando o m&#233;todo <b>recv</b> retorna, uma mensagem inteira foi recebida, pouca importa quantos <b>read</b> foram feitos para completar esta tarefa. Esta caracter&#237;stica vai facilitar muito a implementa&#231;&#227;o do servidor de chat, uma vez que n&#227;o precisaremos inventar um delimitador de mensagem, nem separar as mensagens manualmente em nosso c&#243;digo.<br /><br />Em rela&#231;&#227;o a nosso servidor de chat, o servidor de exemplo &#233; bem limitado. A maior limita&#231;&#227;o &#233; n&#227;o permitir a comunica&#231;&#227;o entre clientes. A ideia do servidor de chat &#233; enviar mensagens a todos os clientes conectados. Desta forma, o servidor deve ser informado sobre e registrar todas as conex&#245;es e desconex&#245;es do sistema. Vamos manter a lista dos clientes conectados com uma lista. Nossos clientes ser&#227;o controlados por uma classe <b>Cliente</b> que veremos mais tarde. Observe a implementa&#231;&#227;o parcial da classe <b>Servidor</b>:<br /><br /><pre class="brush:python">class Servidor:<br />    def __init__(self):<br />        self.conectados = []<br />    <br />    @property<br />    def nconectados(self):<br />        return len(self.conectados)<br />    <br />    @asyncio.coroutine<br />    def conecta(self, websocket, path):<br />        cliente = Cliente(self, websocket, path)<br />        if cliente not in self.conectados:<br />            self.conectados.append(cliente)<br />            print("Novo cliente conectado. Total: {0}".format(self.nconectados))<br />        yield from cliente.gerencia()<br /><br />    def desconecta(self, cliente):<br />        if cliente in self.conectados:<br />            self.conectados.remove(cliente)<br />        print("Cliente {1} desconectado. Total: {0}".format(self.nconectados, cliente.nome))<br /></pre><br />Veja que apenas <b>conecta</b> &#233; uma corotina. Na realidade, todo o trabalho &#233; feito na classe <b>Cliente</b>, que disponibiliza o m&#233;todo <b>gerencia</b> como uma corotina. O importante agora &#233; entender a manuten&#231;&#227;o da lista de conex&#245;es ativas.<br /><br />Vejamos a classe <b>Cliente</b> (parcial):<br /><br /><pre class="brush:python">class Cliente:    <br />    def __init__(self, servidor, websocket, path):<br />        self.cliente = websocket<br />        self.servidor = servidor<br />        self.nome = None        <br />    <br />    @property<br />    def conectado(self):<br />        return self.cliente.open<br /><br />    @asyncio.coroutine<br />    def gerencia(self):<br />        try:<br />            yield from self.envia("Bem vindo ao servidor de chat escrito em Python 3.4 com asyncio e WebSockets. Identifique-se com /nome SeuNome")<br />            while True:<br />                mensagem = yield from self.recebe()<br />                if mensagem:<br />                    print("{0} &lt; {1}".format(self.nome, mensagem))<br />                    yield from self.processa_comandos(mensagem)                                            <br />                else:<br />                    break<br />        except Exception:<br />            print("Erro")<br />            raise        <br />        finally:<br />            self.servidor.desconecta(self)<br /></pre><br />Como cada cliente tem seu pr&#243;prio websocket e precisa se comunicar com o servidor, guardaremos estas refer&#234;ncias como atributos. J&#225; preparamos tamb&#233;m a gest&#227;o de nomes, embora tenhamos inicializado o nome do <b>Cliente</b> com <b>None</b>. O m&#233;todo <b>gerencia</b>, que &#233; uma corotina, envia uma mensagem de boas vindas ao cliente e como no exemplo anterior, utiliza <b>yield from</b> para realizar o envio no loop de eventos. Uma vez que a mensagem inicial &#233; enviada, entramos em um loop infinito que espera uma mensagem do cliente. Quando a conex&#227;o &#233; fechada ou acontece um erro, o valor de mensagem &#233; igual a <b>None</b>, por isso, testamos o valor de mensagem para sair do loop infinito criado pelo <b>while True</b>. Da mesma forma que no primeiro servidor de exemplo, nosso cliente &#233; desconectado quando a corotina <b>gerencia</b> termina. Aproveitamos o fim da corotina para informar ao servidor que este cliente est&#225; se desconectado.<br /><br />Ao recebermos uma mensagem, iniciamos o processamento da mesma, utilizando o m&#233;todo corotina <b>processa_comandos</b> da classe <b>Cliente</b>:<br /><pre class="brush:python">    @asyncio.coroutine<br />    def processa_comandos(self, mensagem):        <br />        if mensagem.strip().startswith("/"):<br />            comandos=shlex.split(mensagem.strip()[1:])<br />            if len(comandos)==0:<br />                yield from self.envia("Comando inv&#225;lido")<br />                return<br />            print(comandos)<br />            comando = comandos[0].lower()            <br />            if comando == "horas":<br />                yield from self.envia("Hora atual: " + time.strftime("%H:%M:%S"))<br />            elif comando == "data":<br />                yield from self.envia("Data atual: " + time.strftime("%d/%m/%y"))<br />            elif comando == "clientes":<br />                yield from self.envia("{0} clientes conectados".format(self.servidor.nconectados))<br />            elif comando == "nome":<br />                yield from self.altera_nome(comandos)<br />            elif comando == "apenas":<br />                yield from self.apenas_para(comandos)<br />            else:<br />                yield from self.envia("Comando desconhecido")<br />        else:<br />            if self.nome:<br />                yield from self.servidor.envia_a_todos(self, mensagem)<br />            else:<br />                yield from self.envia("Identifique-se para enviar mensagens. Use o comando /nome SeuNome")<br /></pre><br />Lembrando os bons velhos tempos do IRC, o m&#233;todo <b>processa_comandos</b> reconhece comandos iniciados pela barra <b>/</b>. Desta forma, caso um cliente envie para o servidor <b>/horas</b>, este retornar&#225; a hora atual do servidor. Implementamos tamb&#233;m os comandos:<br /><b><br /></b><br /><ul><li><b>/data</b> que envia a data atual;</li><li><b>/clientes</b> que envia quantos clientes est&#227;o conectados ao servidor,&nbsp;</li><li><b>/nome</b> e <b>/apenas</b> que veremos mais adiante.&nbsp;</li></ul><br /><br />Utilizamos o m&#243;dulo <b>shlex</b> para simplificar o processamento dos comandos, uma vez que a fun&#231;&#227;o <b>shlex.split</b> permite processar uma linha de texto como uma linha de comandos do bash, reconhecendo valores entre aspas e retirando os espa&#231;os em branco entre os par&#226;metros. Caso o usu&#225;rio envie uma mensagem que n&#227;o se inicia por uma barra, esta mensagem ser&#225; enviada a todos os outros usu&#225;rios conectados.<br /><br />Para melhorar nosso chat, utilizamos o comando <b>/nome</b> para configurar nosso nome. O servidor cuida para que apenas um usu&#225;rio utilize cada nome, retornando uma mensagem de erro, caso o nome desejado j&#225; esteja em uso. Este comando &#233; processado pelo m&#233;todo <b>altera_nome</b> da classe <b>Cliente</b>:<br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def altera_nome(self, comandos):                <br />        if len(comandos)&gt;1 and self.servidor.verifica_nome(comandos[1]):<br />            self.nome = comandos[1]<br />            yield from self.envia("Nome alterado com sucesso para {0}".format(self.nome))<br />        else:<br />            yield from self.envia("Nome em uso ou inv&#225;lido. Escolha um outro.")<br /></pre><br />O m&#233;todo <b>altera_nome</b> simplesmente verifica se passamos um par&#226;metro depois do comando <b>/nome</b>, pois comandos &#233; uma lista onde cada elemento &#233; um par&#226;metro (mas o primeiro &#233; o nome do comando em si). Usando o m&#233;todo <b>verifica_nome</b> do servidor, checamos se o nome &#233; &#250;nico e enviamos uma mensagem de confirma&#231;&#227;o ou de erro dependendo do resultado. O m&#233;todo <b>verifica_nome</b> da classe <b>Servidor</b> &#233; apresentado abaixo:<br /><br /><pre class="brush:python">    def verifica_nome(self, nome):<br />        for cliente in self.conectados:<br />            if cliente.nome and cliente.nome == nome:<br />                return False<br />        return True<br /></pre><br />A verifica&#231;&#227;o percorre toda a lista com os clientes conectados e verifica se um nome igual j&#225; foi registrado. Caso n&#227;o encontre o nome na lista dos clientes j&#225; conectados, retorna <b>True</b>, permitindo o registro do nome pelo cliente que o solicitou.<br /><br />Um outro comando interessante &#233; o &nbsp;<b>/apenas</b> que permite enviarmos uma mensagem apenas para determinado cliente. Vejamos a implementa&#231;&#227;o do m&#233;todo <b>apenas_para</b> no cliente:<br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def apenas_para(self, comandos):<br />        if len(comandos)&lt;3:<br />            yield from self.envia("Comando incorreto. /apenas Destinat&#225;rio mensagem")<br />            return<br />        destinatario = comandos[1]<br />        mensagem = " ".join(comandos[2:])<br />        enviado = yield from self.servidor.envia_a_destinatario(self, mensagem, destinatario)<br />        if not enviado:<br />            yield from self.envia("Destinat&#225;rio {0} n&#227;o encontrado. Mensagem n&#227;o enviada.".format(destinatario))<br /></pre><br />E do m&#233;todo que realiza o envio na classe <b>Servidor</b>:  <br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def envia_a_destinatario(self, origem, mensagem, destinatario):        <br />        for cliente in self.conectados:            <br />            if cliente.nome == destinatario and origem != cliente and cliente.conectado:<br />                print("Enviando de &lt;{0}&gt; para &lt;{1}&gt;: {2}".format(origem.nome, cliente.nome, mensagem))<br />                yield from cliente.envia("PRIVADO de {0} &gt;&gt; {1}".format(origem.nome, mensagem))<br />                return True<br />        return False<br /></pre><br />Um outro m&#233;todo importante &#233; o que envia uma mensagem a todos os clientes conectados:<br /><br /><pre class="brush:python">    @asyncio.coroutine<br />    def envia_a_todos(self, origem, mensagem):<br />        print("Enviando a todos")<br />        for cliente in self.conectados:            <br />            if origem != cliente and cliente.conectado:<br />                print("Enviando de &lt;{0}&gt; para &lt;{1}&gt;: {2}".format(origem.nome, cliente.nome, mensagem))<br />                yield from cliente.envia("{0} &gt;&gt; {1}".format(origem.nome, mensagem))<br /></pre><br />Veja que enviamos a mensagem a todos da lista, mas que tomamos o cuidado para n&#227;o enviar a mensagem ao mesmo cliente que a enviou, pois esta seria impressa uma segunda vez e nosso cliente Javascript j&#225; fez este trabalho por n&#243;s.  A listagem completa abaixo:  <br /><br /><pre class="brush:python">import asyncio<br />import websockets<br />import time<br />import shlex<br /><br />class Servidor:<br />    def __init__(self):<br />        self.conectados = []<br />    <br />    @property<br />    def nconectados(self):<br />        return len(self.conectados)<br />    <br />    @asyncio.coroutine<br />    def conecta(self, websocket, path):<br />        cliente = Cliente(self, websocket, path)<br />        if cliente not in self.conectados:<br />            self.conectados.append(cliente)<br />            print("Novo cliente conectado. Total: {0}".format(self.nconectados))            <br />        yield from cliente.gerencia()<br /><br />    def desconecta(self, cliente):<br />        if cliente in self.conectados:<br />            self.conectados.remove(cliente)<br />        print("Cliente {1} desconectado. Total: {0}".format(self.nconectados, cliente.nome))            <br /><br />    @asyncio.coroutine<br />    def envia_a_todos(self, origem, mensagem):<br />        print("Enviando a todos")<br />        for cliente in self.conectados:            <br />            if origem != cliente and cliente.conectado:<br />                print("Enviando de &lt;{0}&gt; para &lt;{1}&gt;: {2}".format(origem.nome, cliente.nome, mensagem))<br />                yield from cliente.envia("{0} &gt;&gt; {1}".format(origem.nome, mensagem))<br /><br />    @asyncio.coroutine<br />    def envia_a_destinatario(self, origem, mensagem, destinatario):        <br />        for cliente in self.conectados:            <br />            if cliente.nome == destinatario and origem != cliente and cliente.conectado:<br />                print("Enviando de &lt;{0}&gt; para &lt;{1}&gt;: {2}".format(origem.nome, cliente.nome, mensagem))<br />                yield from cliente.envia("PRIVADO de {0} &gt;&gt; {1}".format(origem.nome, mensagem))<br />                return True<br />        return False<br /><br />    def verifica_nome(self, nome):<br />        for cliente in self.conectados:<br />            if cliente.nome and cliente.nome == nome:<br />                return False<br />        return True<br /><br /><br />class Cliente:    <br />    def __init__(self, servidor, websocket, path):<br />        self.cliente = websocket<br />        self.servidor = servidor<br />        self.nome = None        <br />    <br />    @property<br />    def conectado(self):<br />        return self.cliente.open<br /><br />    @asyncio.coroutine<br />    def gerencia(self):<br />        try:<br />            yield from self.envia("Bem vindo ao servidor de chat escrito em Python 3.4 com asyncio e WebSockets. Identifique-se com /nome SeuNome")<br />            while True:<br />                mensagem = yield from self.recebe()<br />                if mensagem:<br />                    print("{0} &lt; {1}".format(self.nome, mensagem))<br />                    yield from self.processa_comandos(mensagem)                                            <br />                else:<br />                    break<br />        except Exception:<br />            print("Erro")<br />            raise        <br />        finally:<br />            self.servidor.desconecta(self)<br /><br />    @asyncio.coroutine<br />    def envia(self, mensagem):<br />        yield from self.cliente.send(mensagem)<br /><br />    @asyncio.coroutine<br />    def recebe(self):<br />        mensagem = yield from self.cliente.recv()<br />        return mensagem<br /><br />    @asyncio.coroutine<br />    def processa_comandos(self, mensagem):        <br />        if mensagem.strip().startswith("/"):<br />            comandos=shlex.split(mensagem.strip()[1:])<br />            if len(comandos)==0:<br />                yield from self.envia("Comando inv&#225;lido")<br />                return<br />            print(comandos)<br />            comando = comandos[0].lower()            <br />            if comando == "horas":<br />                yield from self.envia("Hora atual: " + time.strftime("%H:%M:%S"))<br />            elif comando == "data":<br />                yield from self.envia("Data atual: " + time.strftime("%d/%m/%y"))<br />            elif comando == "clientes":<br />                yield from self.envia("{0} clientes conectados".format(self.servidor.nconectados))<br />            elif comando == "nome":<br />                yield from self.altera_nome(comandos)<br />            elif comando == "apenas":<br />                yield from self.apenas_para(comandos)<br />            else:<br />                yield from self.envia("Comando desconhecido")<br />        else:<br />            if self.nome:<br />                yield from self.servidor.envia_a_todos(self, mensagem)<br />            else:<br />                yield from self.envia("Identifique-se para enviar mensagens. Use o comando /nome SeuNome")<br /><br />    @asyncio.coroutine<br />    def altera_nome(self, comandos):                <br />        if len(comandos)&gt;1 and self.servidor.verifica_nome(comandos[1]):<br />            self.nome = comandos[1]<br />            yield from self.envia("Nome alterado com sucesso para {0}".format(self.nome))<br />        else:<br />            yield from self.envia("Nome em uso ou inv&#225;lido. Escolha um outro.")<br /><br />    @asyncio.coroutine<br />    def apenas_para(self, comandos):<br />        if len(comandos)&lt;3:<br />            yield from self.envia("Comando incorreto. /apenas Destinat&#225;rio mensagem")<br />            return<br />        destinatario = comandos[1]<br />        mensagem = " ".join(comandos[2:])<br />        enviado = yield from self.servidor.envia_a_destinatario(self, mensagem, destinatario)<br />        if not enviado:<br />            yield from self.envia("Destinat&#225;rio {0} n&#227;o encontrado. Mensagem n&#227;o enviada.".format(destinatario))<br /><br /><br /><br />servidor=Servidor()<br />loop=asyncio.get_event_loop()<br /><br />start_server = websockets.serve(servidor.conecta, 'localhost', 8765)<br /><br />try:<br />    loop.run_until_complete(start_server)<br />    loop.run_forever()<br />finally:<br />    start_server.close()<br /></pre><br />Voc&#234; pode baixar o arquivo completo clicando <a href="http://static.nilo.pro.br/artigos/server2.py">aqui</a>.<br /><br />Para testar, abra o arquivo <a href="http://static.nilo.pro.br/artigos/cliente.html">cliente.html</a> que voc&#234; j&#225; deve ter salvo em seu computador. Se voc&#234; j&#225; ativou o servidor com<br /><br /><pre class="brush:shell">py -3 servidor2.py<br /></pre><br />nosso cliente j&#225; deve estar conectado. Caso contr&#225;rio, recarregue a p&#225;gina no navegador para for&#231;ar a reconex&#227;o. Quando conectado, o cliente exibe uma barra azul no topo da p&#225;gina. Para simular v&#225;rios clientes, abra v&#225;rias vezes o arquivo cliente.html. Vejamos uma sess&#227;o simples com 3 clientes:<br /><br />No primeiro cliente:<br /><pre class="brush:shell">/nome Cliente1<br />/horas<br /></pre><br />No segundo cliente:<br /><pre class="brush:shell">/nome Cliente2<br />/data<br /></pre><br />No terceiro cliente:<br /><pre class="brush:shell">/nome Cliente3<br />/apenas Cliente1 Ol&#225; 1<br />/apenas Cliente2 Ol&#225; 2<br />Ol&#225; todos!<br /></pre><br />N&#227;o esque&#231;a de copiar linha por linha nas respectivas janelas. Digite ENTER para enviar a mensagem, uma de cada vez. Divirta-se!<br /><br /><div class="separator"><a href="http://2.bp.blogspot.com/-7AXfBX6aNt8/VAIbvEngJ_I/AAAAAAAAAw8/-THFqwvuqvw/s1600/clienteweb.png"><img border="0" height="232" src="https://2.bp.blogspot.com/-7AXfBX6aNt8/VAIbvEngJ_I/AAAAAAAAAw8/-THFqwvuqvw/s1600/clienteweb.png" width="320" /></a></div><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2014/08/servidor-de-chat-com-websockets-e.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:39	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-3570441352006908858"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic.html">
Convertendo um jogo escrito em Basic para Python - Parte I	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2016-05-14-convertendo-um-jogo-escrito-em-basic-para-python-parte-i/">Leia no novo blog</a><br /><br />A nostalgia dos computadores da d&#233;cada de 80 &#233; algo que nunca parei de ter. Quando crian&#231;a, tive a sorte de utilzar v&#225;rios computadores de 8-bits, como ZX-81, ZX-Spectrum, Apple II e MSX, ou melhor, seus clones nacionais (TK-85, TK-90X, TK2000), uma vez que o Brasil vivia a &#233;poca da Reserva do Mercado de Inform&#225;tica.<br />Numa &#233;poca que n&#227;o havia Internet, n&#243;s pass&#225;vamos o tempo a digitar programas. Uma s&#233;rie de livros sobre programa&#231;&#227;o de jogos foi editada pela editora Lut&#233;cia no Brasil, mas os originais americanos foram liberados pela <a href="http://www.usborne.com/catalogue/feature-page/computer-and-coding-books.aspx">Usborne</a>. Neste artigo, eu vou traduzir o jogo principal do Computer Battlegames, chamado de Missile, de Apple II Basic para Python com Pyglet. A listagem original est&#225; na p&#225;gina 34 do livro em ingl&#234;s (ver pdf acima).<br /><br /><pre class="brush:vb">10 HOME<br />20 HGR<br />30 HCOLOR=3<br />40 DIM Y(3),F(3)<br />50 N=1 : MS=5<br />60 PS=INT(RND(1)*6+4)<br />70 P=INT(RND(1)*135+11)<br />80 GOSUB 400<br />90 FOR I=PS TO 265 STEP PS<br />100 X=I-PS : Y=159-P : C=0 : GOSUB 300<br />110 X=I : C=3: GOSUB 300<br />120 F$="" : IF PEEK(-16384)&gt;127 THEN GET F$<br />130 IF F$="" OR N&gt;3 THEN 160<br />140 F(N)=1<br />150 N=N+1<br />160 FOR J=1 TO 3<br />170 C=0 : GOSUB 350<br />180 IF F(J)=0 OR Y(J)&gt;145 THEN 230<br />190 Y(J)=Y(J)+MS<br />200 C=3 : GOSUB 350<br />210 X=J*70-I : Y=P-Y(J)<br />220 IF X&gt;-1 AND X&lt;15 AND Y&gt;-9 AND Y&lt;5 THEN 270<br />230 NEXT<br />240 NEXT<br />250 VTAB 22 : PRINT "MISSED"<br />260 END<br />270 VTAB 22 : PRINT "HIT!!!"<br />280 END<br />300 HCOLOR=C<br />310 HPLOT X,Y TO X,Y-8<br />320 HPLOT TO X+3,Y-2 : HPLOT TO X+12, Y-2<br />330 HPLOT TO X+14,Y : HPLOT TO X,Y<br />340 RETURN<br />350 HCOLOR=C<br />360 HPLOT 70*J,158-Y(J) TO 70*J,154-Y(J)<br />340 RETURN<br />350 HCOLOR=C<br />360 HPLOT 70*J, 158-Y(J) TO 70*J,154-Y(J)<br />370 RETURN<br />400 FOR J=1 TO 3<br />410 HPLOT 70*J-5,159 TO 70*J+5,159<br />420 NEXT<br />430 RETURN<br /></pre>Vejamos o jogo rodando em um emulador:  <br /><div class="separator"></div><br />Vers&#227;o comentada: <br /><pre class="brush:vb"># Limpa a tela<br />10 HOME<br /># Entra no modo de alta resolu&#231;&#227;o 280x192<br />20 HGR<br /># Seleciona a cor 3 (purpura/magenta)<br />30 HCOLOR=3<br /># Cria dois vetores com 3 elementos cada<br />40 DIM Y(3),F(3)<br /># Inicializa N igual a 1 e MS igual a 5<br />50 N=1 : MS=5<br /># Gera um n&#250;mero aleat&#243;rio entre 0 e 6 + 4<br />60 PS=INT(RND(1)*6+4)<br /># Gera um n&#250;mero aleat&#243;rio entre 0 e 135 + 11<br />70 P=INT(RND(1)*135+11)<br /># Desvia para subrotina<br />80 GOSUB 400<br /># Loop: repete I de PS at&#233; 265, incrementando de PS<br />90 FOR I=PS TO 265 STEP PS<br /># Calcula os valores de X, Y e C. Desvia para subrotina em 300<br />100 X=I-PS : Y=159-P : C=0 : GOSUB 300<br /># Define X e C. Desvia para subrotina 300<br />110 X=I : C=3: GOSUB 300<br /># Verifica se uma tecla foi pressionada. Se foi, guarda em F<br />120 F$="" : IF PEEK(-16384)&gt;127 THEN GET F$<br /># Se algo foi pressionado ou se N&gt;3 desvia para 160<br />130 IF F$="" OR N&gt;3 THEN 160<br /># F[N] = 1<br />140 F(N)=1<br /># N+=1<br />150 N=N+1<br /># Repete J de 1 at&#233; 3<br />160 FOR J=1 TO 3<br /># Zera C e desvia para subrotina da linha 350<br />170 C=0 : GOSUB 350<br /># Se F[J]==0 ou Y[J]&gt;145 desvia para 230<br />180 IF F(J)=0 OR Y(J)&gt;145 THEN 230<br /># Y[J]+=MS<br />190 Y(J)=Y(J)+MS<br /># C=3. Desvia para subrotina da linha 350<br />200 C=3 : GOSUB 350<br /># Calcula X e Y<br />210 X=J*70-I : Y=P-Y(J)<br /># Se X&gt;-1 e X&lt;15 e Y&gt;-9 e Y&lt;5 desvia para 270<br />220 IF X&gt;-1 AND X&lt;15 AND Y&gt;-9 AND Y&lt;5 THEN 270<br /># Fim do loop, volta para o for da linha 160<br />230 NEXT<br /># Fim do loop, volta para for da linha 90<br />240 NEXT<br /># Posiciona o cursor na linha 22 e imprime MISSED<br />250 VTAB 22 : PRINT "MISSED"<br /># Termina o programa<br />260 END<br /># Posiciona o cursor na linha 22 e imprime HIT!!!<br />270 VTAB 22 : PRINT "HIT!!!"<br /># Termina o programa<br />280 END<br /># Troca a cor de desenho para C<br />300 HCOLOR=C<br /># Tra&#231;a uma linha de X,Y at&#233; X,Y-8<br />310 HPLOT X,Y TO X,Y-8<br /># Continua a linha<br />320 HPLOT TO X+3,Y-2 : HPLOT TO X+12, Y-2<br />330 HPLOT TO X+14,Y : HPLOT TO X,Y<br /># Retorno da subrotina<br />340 RETURN<br /># Troca a cor de desenho para C<br />350 HCOLOR=C<br /># Desenha linha<br />360 HPLOT 70*J,158-Y(J) TO 70*J,154-Y(J)<br /># Volta da subrotina<br />340 RETURN<br /># Troca a cor para C<br />350 HCOLOR=C<br /># Desenha linha<br />360 HPLOT 70*J, 158-Y(J) TO 70*J,154-Y(J)<br /># Volta da subrotina<br />370 RETURN<br /># Repete J de 1 &#224; 3<br />400 FOR J=1 TO 3<br /># Desenha linha<br />410 HPLOT 70*J-5,159 TO 70*J+5,159<br /># Fim do loop, volta para linha 400<br />420 NEXT<br /># Retorna da subrotina<br />430 RETURN<br /></pre>Bom, como precisaremos desenhar, vamos instalar a Pyglet: <br /><pre class="brush:bash">pip3 install pyglet<br /></pre><br />A primeira coisa a fazer &#233; criar a janela da Pyglet e separar a janela do jogo em si. No caso, a janela &#233; respons&#225;vel por receber os eventos do teclado. A configura&#231;&#227;o do OpenGL tamb&#233;m precisam ser feitas aqui. Como a alta resolu&#231;&#227;o do Apple II &#233; muito pequena 280x192 pontos, eu estou usando uma escala 4. Desta forma, as coordenadas permanecer&#227;o as mesmas, mas os gr&#225;ficos ser&#227;o 4 vezes maiores.  Se ficar muito grande em seu monitor, voc&#234; pode ajustar a escala. <br />Eu tentei manter os coment&#225;rios originais para ficar mais f&#225;cil de relacionar o c&#243;digo novo com o antigo. <br />Outra mudan&#231;a s&#227;o as coordenadas Y. No Apple II, Y = 0 &#233; a primeira linha e em OpenGL &#233; a &#250;ltima. <br />Vejamos como ficou o c&#243;digo da janela: <br /><pre class="brush:python">class Missile(pyglet.window.Window):<br />    # 20 HGR<br />    def __init__(self):<br />        self.scale = 4    # Escala os gr&#225;ficos 4x<br />        self.frames = 8   # Frames por segundo.<br />                          # Define quantas vezes vamos atualizar a tela por segundo<br />        super(Missile, self).__init__(280 * self.scale,<br />                                      192 * self.scale,<br />                                      caption="Missiles")<br />        self.set_mouse_visible(False)<br />        self.game = Game(self)<br />        self.schedule = pyglet.clock.schedule_interval(<br />            func=self.update, interval=1.0 / self.frames)<br /><br />    def update(self, interval):<br />        pass<br /><br />    def on_draw(self):<br />        window.clear()<br />        self.game.atualiza()<br /><br />    def on_resize(self, width, height):<br />        # Inicializa a view<br />        glViewport(0, 0, width, height)<br />        glMatrixMode(gl.GL_PROJECTION)<br />        glLoadIdentity()<br />        # Inverte as coordenadas do eixo Y<br />        glOrtho(0, width, height, 0, -1, 1)<br />        # Aplica a escala<br />        glScalef(self.scale, self.scale, 1.0)<br />        glMatrixMode(gl.GL_MODELVIEW)<br /><br />    def on_key_press(self, symbol, modifiers):<br />        # Verifica se uma tecla foi pressionada. Se foi, guarda em F<br />        # 120 F$="" : IF PEEK(-16384)&gt;127 THEN GET F$<br />        self.game.pressionado = True<br /><br />    def crialabel(self, mensagem, x=None, y=None,<br />                  fonte='Times New Roman', tamanho=36):<br />        """Prepara uma mensagem de texto para ser exibida"""<br />        x = x or self.width // 2<br />        y = y or self.height // 2<br />        return pyglet.text.Label(<br />            mensagem, font_name=fonte, font_size=tamanho,<br />            x=x, y=y, anchor_x='center', anchor_y='center')<br /></pre><br />Al&#233;m disso, as cores do Apple II precisam ser definidas: <br /><pre class="brush:python">def rgb_to_f(r, g, b):<br />    return(r / 255.0, g / 255.0, b / 255.0)<br /><br /># Cores do modo de alta resolu&#231;&#227;o HGR<br /># Fonte: https://github.com/AppleWin/AppleWin/issues/254<br />CORES = [(0.0, 0.0, 0.0),  # Preto 0<br />         rgb_to_f(20, 245, 60),  # Verde 1<br />         rgb_to_f(255, 68, 253),  # Magenta 2<br />         rgb_to_f(255, 255, 255),  # Branco 3<br />         rgb_to_f(255, 106, 60),  # Laranja 5<br />         rgb_to_f(20, 207, 253),  # Azul m&#233;dio 6<br />         rgb_to_f(255, 255, 255),  # Branco 7<br />         ]<br /></pre><br />e finalmente a classe Game com o jogo em si. Observar que os &#237;ndices em Python come&#231;am em 0 e em Basic come&#231;am com 1. Primeiro passo da convers&#227;o: <br /><pre class="brush:python">class Game():<br />    def __init__(self, parent):<br />        self.cor = CORES<br />        self.window = parent<br />        # Cria dois vetores com 3 elementos cada<br />        # 40 DIM Y(3),F(3)<br />        self.Y = [0] * 3<br />        self.F = [0] * 3<br />        # Inicializa N igual a 1 e MS igual a 5<br />        # 50 N=1 : MS=5<br />        self.N = 0<br />        self.MS = 5<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 6 + 4<br />        # 60 PS=INT(RND(1)*6+4)<br />        self.PS = random.randint(0, 6) + 4<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 135 + 11<br />        # 70 P=INT(RND(1)*135+11)<br />        self.P = random.randint(0, 135) + 11<br />        self.estado = "jogando"<br />        self.I = self.PS<br />        self.pressionado = False<br />        self.label = None<br /><br />    def atualiza(self):<br />        if self.estado == "jogando":<br />            self.jogue()<br />        else:<br />            if self.label:<br />                glMatrixMode(gl.GL_PROJECTION)<br />                glLoadIdentity()<br />                glOrtho(0, self.window.width, 0, self.window.height, -1, 1)<br />                glMatrixMode(gl.GL_MODELVIEW)<br />                self.label.draw()<br />            if self.pressionado:<br />                pyglet.app.event_loop.exit()<br /><br />    def jogue(self):<br />        # Desvia para subrotina<br />        # 80 GOSUB 400<br />        self.sub_400()<br />        # Loop: repete I de PS at&#233; 265, incrementando de PS<br />        # 90 FOR I=PS TO 265 STEP PS<br />        if self.I &gt; 265:<br />            self.sub_250()<br />            return<br />        # Calcula os valores de X, Y e C. Desvia para subrotina em 300<br />        # 100 X=I-PS : Y=159-P : C=0 : GOSUB 300<br />        self.X = self.I - self.PS<br />        self.y = 159 - self.P<br />        self.C = 0<br />        self.sub_300()<br />        # Define X e C. Desvia para subrotina 300<br />        # 110 X=I : C=3: GOSUB 300<br />        self.X = self.I<br />        self.C = 3<br />        self.sub_300()<br />        # Se algo foi pressionado ou se N&gt;3 desvia para 160<br />        # 130 IF F$="" OR N&gt;3 THEN 160<br />        if self.pressionado and self.N &lt; 3:<br />            # F[N] = 1<br />            # 140 F(N)=1<br />            self.F[self.N] = 1<br />            # N+=1<br />            # 150 N=N+1<br />            self.N += 1<br />        self.pressionado = False<br />        # Repete J de 1 at&#233; 3<br />        # 160 FOR J=1 TO 3<br />        for self.J in range(0, 3):<br />            # Zera C e desvia para subrotina da linha 350<br />            # 170 C=0 : GOSUB 350<br />            self.C = 0<br />            self.sub_350()<br />            # Se F[J]==0 ou Y[J]&gt;145 desvia para 230<br />            # 180 IF F(J)=0 OR Y(J)&gt;145 THEN 230<br />            if self.F[self.J] == 0 or self.Y[self.J] &gt; 145:<br />                continue<br />            # Y[J]+=MS<br />            # 190 Y(J)=Y(J)+MS<br />            self.Y[self.J] += self.MS<br />            # C=3. Desvia para subrotina da linha 350<br />            # 200 C=3 : GOSUB 350<br />            self.C = 3<br />            self.sub_350()<br />            # Calcula X e Y<br />            # 210 X=J*70-I : Y=P-Y(J)<br />            self.X = (self.J + 1) * 70 - self.I<br />            self.y = self.P - self.Y[self.J]<br />            # Se X&gt;-1 e X&lt;15 e Y&gt;-9 e Y&lt;5 desvia para 270<br />            # 220 IF X&gt;-1 AND X&lt;15 AND Y&gt;-9 AND Y&lt;5 THEN 270<br />            if self.X &gt; -1 and self.X &lt; 15 and self.y &gt; -9 and self.y &lt; 5:<br />                self.sub_270()           <br />            # Fim do loop, volta para o for da linha 160<br />            # 230 NEXT<br />            # Fim do loop, volta para for da linha 90<br />            # 240 NEXT<br />        # 90 FOR I=PS TO 265 STEP PS<br />        self.I += self.PS<br /><br />    def sub_250(self):<br />        # Posiciona o cursor na linha 22 e imprime MISSED<br />        # 250 VTAB 22 : PRINT "MISSED"<br />        print("MISSED")<br />        self.imprima("MISSED")<br />        # Termina o programa<br />        # 260 END<br />        self.muda_estado("fimdejogo")<br /><br />    def sub_270(self):<br />        # Posiciona o cursor na linha 22 e imprime HIT!!!<br />        # 270 VTAB 22 : PRINT "HIT!!!"<br />        print("HIT")<br />        self.imprima("HIT!!!")<br />        # Termina o programa<br />        self.muda_estado("fimdejogo")<br /><br />    def sub_300(self):<br />        # Troca a cor de desenho para C<br />        # 300 HCOLOR=C<br />        self.set_color(self.C)<br />        # Tra&#231;a uma linha de X,Y at&#233; X,Y-8<br />        # 310 HPLOT X,Y TO X,Y-8<br />        # Continua a linha<br />        # 320 HPLOT TO X+3,Y-2 : HPLOT TO X+12, Y-2<br />        # 330 HPLOT TO X+14,Y : HPLOT TO X,Y<br />        pyglet.graphics.draw(6, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2i', (self.X, self.y,<br />                                      self.X, self.y - 8,<br />                                      self.X + 3, self.y - 2,<br />                                      self.X + 12, self.y - 2,<br />                                      self.X + 14, self.y,<br />                                      self.X, self.y)))<br /><br />        # Retorno da subrotina<br />        # 340 RETURN<br /><br />    def sub_350(self):<br />        # Troca a cor para C<br />        # 350 HCOLOR=C<br />        self.set_color(self.C)<br />        # Desenha linha<br />        # 360 HPLOT 70*J, 158-Y(J) TO 70*J,154-Y(J)<br />        J = self.J + 1<br />        pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                             ('v2i', (70 * J, 158 - self.Y[self.J],<br />                                      70 * J, 154 - self.Y[self.J])))<br />        # Volta da subrotina<br />        # 370 RETURN<br /><br />    def sub_400(self):<br />        self.set_color(3)<br />        # 400 FOR J=1 TO 3<br />        for J in range(1, 4):<br />            # Desenha linha<br />            # 410 HPLOT 70*J-5,159 TO 70*J+5,159<br />            pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                                 ('v2i', (70 * J - 5, 159,<br />                                          70 * J + 5, 159)))<br />            # Fim do loop, volta para linha 400<br />            # 420 NEXT<br />        # Retorna da subrotina<br />        # 430 RETURN<br /><br />    def set_color(self, color):<br />        glColor3f(*self.cor[color])<br /><br />    def muda_estado(self, estado):<br />        print("Mudan&#231;a de Estado: {} --&gt; {}".format(self.estado, estado))<br />        self.estado = estado<br /><br />    def imprima(self, mensagem):<br />        self.label = self.window.crialabel(mensagem)</pre><br />Como em OpenGL limpamos a tela a cada frame, a rotina que apaga os objetos pode ser apagada.  No caso, a chamada a sub_300() com C=0. <br />O nome dos m&#233;todos ainda n&#227;o foram mudados, vamos renomear: <br />sub_250 para pedeu <br />sub_270 para acertou <br />sub_300 para desenha_aviao <br />sub_350 para desenha_tiro <br />sub_400 para desenha_bases <br />Apagando os coment&#225;rios com o c&#243;digo em Basic, temos: <br /><pre class="brush:python">import pyglet<br />from pyglet.gl import *<br />import random<br /><br /><br />def rgb_to_f(r, g, b):<br />    return(r / 255.0, g / 255.0, b / 255.0)<br /><br /># Cores do modo de alta resolu&#231;&#227;o HGR<br /># Fonte: https://github.com/AppleWin/AppleWin/issues/254<br />CORES = [(0.0, 0.0, 0.0),  # Preto 0<br />         rgb_to_f(20, 245, 60),  # Verde 1<br />         rgb_to_f(255, 68, 253),  # Magenta 2<br />         rgb_to_f(255, 255, 255),  # Branco 3<br />         rgb_to_f(255, 106, 60),  # Laranja 5<br />         rgb_to_f(20, 207, 253),  # Azul m&#233;dio 6<br />         rgb_to_f(255, 255, 255),  # Branco 7<br />         ]<br /><br /><br />class Game():<br />    def __init__(self, parent):<br />        self.cor = CORES<br />        self.window = parent<br />        # Cria dois vetores com 3 elementos cada<br />        self.Y = [0] * 3<br />        self.F = [0] * 3<br />        # Inicializa N igual a 1 e MS igual a 5<br />        self.N = 0<br />        self.MS = 5<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 6 + 4<br />        self.PS = random.randint(0, 6) + 4<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 135 + 11<br />        self.P = random.randint(0, 135) + 11<br />        self.estado = "jogando"<br />        self.I = self.PS<br />        self.pressionado = False<br />        self.label = None<br /><br />    def atualiza(self):<br />        if self.estado == "jogando":<br />            self.jogue()<br />        else:<br />            if self.label:<br />                glMatrixMode(gl.GL_PROJECTION)<br />                glLoadIdentity()<br />                glOrtho(0, self.window.width, 0, self.window.height, -1, 1)<br />                glMatrixMode(gl.GL_MODELVIEW)<br />                self.label.draw()<br />            if self.pressionado:<br />                pyglet.app.event_loop.exit()<br /><br />    def jogue(self):<br />        self.desenha_bases()<br />        if self.I &gt; 265:<br />            self.perdeu()<br />            return<br />        self.X = self.I - self.PS<br />        self.y = 159 - self.P<br />        self.C = 0<br />        self.desenha_aviao()<br />        self.X = self.I<br />        self.C = 3<br />        self.desenha_aviao()<br />        if self.pressionado and self.N &lt; 3:<br />            self.F[self.N] = 1<br />            self.N += 1<br />        self.pressionado = False<br />        for self.J in range(0, 3):<br />            if self.F[self.J] == 0 or self.Y[self.J] &gt; 145:<br />                continue<br />            self.Y[self.J] += self.MS<br />            self.C = 3<br />            self.desenha_tiro()<br />            self.X = (self.J + 1) * 70 - self.I<br />            self.y = self.P - self.Y[self.J]<br />            if self.X &gt; -1 and self.X &lt; 15 and self.y &gt; -9 and self.y &lt; 5:<br />                self.acertou()<br />        self.I += self.PS<br /><br />    def perdeu(self):<br />        self.imprima("MISSED")<br />        self.muda_estado("fimdejogo")<br /><br />    def acertou(self):<br />        self.imprima("HIT!!!")<br />        self.muda_estado("fimdejogo")<br /><br />    def desenha_aviao(self):<br />        self.set_color(self.C)<br />        pyglet.graphics.draw(6, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2i', (self.X, self.y,<br />                                      self.X, self.y - 8,<br />                                      self.X + 3, self.y - 2,<br />                                      self.X + 12, self.y - 2,<br />                                      self.X + 14, self.y,<br />                                      self.X, self.y)))<br /><br />    def desenha_tiro(self):<br />        self.set_color(self.C)<br />        J = self.J + 1<br />        pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                             ('v2i', (70 * J, 158 - self.Y[self.J],<br />                                      70 * J, 154 - self.Y[self.J])))<br /><br />    def desenha_bases(self):<br />        self.set_color(3)<br />        for J in range(1, 4):<br />            pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                                 ('v2i', (70 * J - 5, 159,<br />                                          70 * J + 5, 159)))<br /><br />    def set_color(self, color):<br />        glColor3f(*self.cor[color])<br /><br />    def muda_estado(self, estado):<br />        print("Mudan&#231;a de Estado: {} --&gt; {}".format(self.estado, estado))<br />        self.estado = estado<br /><br />    def imprima(self, mensagem):<br />        self.label = self.window.crialabel(mensagem)<br /><br /><br />class Missile(pyglet.window.Window):<br />    def __init__(self):<br />        self.scale = 4    # Escala os gr&#225;ficos 4x<br />        self.frames = 8   # Frames por segundo.<br />                          # Define quantas vezes vamos atualizar a tela por segundo<br />        super(Missile, self).__init__(280 * self.scale,<br />                                      192 * self.scale,<br />                                      caption="Missiles")<br />        self.set_mouse_visible(False)<br />        self.game = Game(self)<br />        self.schedule = pyglet.clock.schedule_interval(<br />            func=self.update, interval=1.0 / self.frames)<br /><br />    def update(self, interval):<br />        pass<br /><br />    def on_draw(self):<br />        window.clear()<br />        self.game.atualiza()<br /><br />    def on_resize(self, width, height):<br />        # Inicializa a view<br />        glViewport(0, 0, width, height)<br />        glMatrixMode(gl.GL_PROJECTION)<br />        glLoadIdentity()<br />        # Inverte as coordenadas do eixo Y<br />        glOrtho(0, width, height, 0, -1, 1)<br />        # Aplica a escala<br />        glScalef(self.scale, self.scale, 1.0)<br />        glMatrixMode(gl.GL_MODELVIEW)<br /><br />    def on_key_press(self, symbol, modifiers):<br />        self.game.pressionado = True<br /><br />    def crialabel(self, mensagem, x=None, y=None,<br />                  fonte='Times New Roman', tamanho=36):<br />        """Prepara uma mensagem de texto para ser exibida"""<br />        x = x or self.width // 2<br />        y = y or self.height // 2<br />        return pyglet.text.Label(<br />            mensagem, font_name=fonte, font_size=tamanho,<br />            x=x, y=y, anchor_x='center', anchor_y='center')<br /><br /><br />window = Missile()<br />pyglet.app.run()<br /></pre><br />Bem melhor, mas ainda guarda v&#225;rias caracter&#237;sticas do programa em Basic. O nome das vari&#225;veis &#233; uma cat&#225;strofe. Renomeando as vari&#225;veis e melhorando os coment&#225;rios, o programa completo fica assim: <br /><pre class="brush:python">import pyglet<br />from pyglet.gl import *<br />import random<br /><br /><br />def rgb_to_f(r, g, b):<br />    return(r / 255.0, g / 255.0, b / 255.0)<br /><br /># Cores do modo de alta resolu&#231;&#227;o HGR<br /># Fonte: https://github.com/AppleWin/AppleWin/issues/254<br />CORES = [(0.0, 0.0, 0.0),  # Preto 0<br />         rgb_to_f(20, 245, 60),  # Verde 1<br />         rgb_to_f(255, 68, 253),  # Magenta 2<br />         rgb_to_f(255, 255, 255),  # Branco 3<br />         rgb_to_f(255, 106, 60),  # Laranja 5<br />         rgb_to_f(20, 207, 253),  # Azul m&#233;dio 6<br />         rgb_to_f(255, 255, 255),  # Branco 7<br />         ]<br /><br /><br />class Game():<br />    def __init__(self, parent):<br />        self.cor = CORES<br />        self.window = parent<br />        # Cria dois vetores com 3 elementos cada<br />        self.Y = [0] * 3 # Altura do tiro<br />        self.F = [0] * 3 # Estado do tiro<br />        self.tiros_disparados = 0  # tiros j&#225; disparados<br />        self.velocidade_do_tiro = 5<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 6 + 4<br />        self.velocidade_aviao = random.randint(0, 6) + 4<br />        # Gera um n&#250;mero aleat&#243;rio entre 0 e 135 + 11<br />        self.altura_do_aviao = random.randint(0, 135) + 11<br />        self.estado = "jogando"<br />        self.posicao_do_aviao = self.velocidade_aviao<br />        self.pressionado = False<br />        self.label = None<br /><br />    def atualiza(self):<br />        if self.estado == "jogando":<br />            self.jogue()<br />        else:<br />            if self.label:<br />                glMatrixMode(gl.GL_PROJECTION)<br />                glLoadIdentity()<br />                glOrtho(0, self.window.width, 0, self.window.height, -1, 1)<br />                glMatrixMode(gl.GL_MODELVIEW)<br />                self.label.draw()<br />            if self.pressionado:<br />                pyglet.app.event_loop.exit()<br /><br />    def jogue(self):<br />        self.desenha_bases()<br />        if self.posicao_do_aviao &gt; 265:<br />            self.perdeu()<br />            return<br />        self.y = 159 - self.altura_do_aviao<br />        self.X = self.posicao_do_aviao<br />        self.C = 3<br />        self.desenha_aviao()<br />        if self.pressionado and self.tiros_disparados &lt; 3:<br />            self.F[self.tiros_disparados] = 1<br />            self.tiros_disparados += 1<br />        self.pressionado = False<br />        self.processa_tiros()<br />        self.posicao_do_aviao += self.velocidade_aviao<br /><br />    def processa_tiros(self):<br />        for self.J in range(0, 3):<br />            if self.F[self.J] == 0 or self.Y[self.J] &gt; 145:<br />                continue<br />            self.Y[self.J] += self.velocidade_do_tiro<br />            self.C = 3<br />            self.desenha_tiro()<br />            self.X = (self.J + 1) * 70 - self.posicao_do_aviao<br />            self.y = self.altura_do_aviao - self.Y[self.J]<br />            if self.X &gt; -1 and self.X &lt; 15 and self.y &gt; -9 and self.y &lt; 5:<br />                self.acertou()<br /><br />    def perdeu(self):<br />        self.imprima("MISSED")<br />        self.muda_estado("fimdejogo")<br /><br />    def acertou(self):<br />        self.imprima("HIT!!!")<br />        self.muda_estado("fimdejogo")<br /><br />    def desenha_aviao(self):<br />        self.set_color(self.C)<br />        pyglet.graphics.draw(6, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2i', (self.X, self.y,<br />                                      self.X, self.y - 8,<br />                                      self.X + 3, self.y - 2,<br />                                      self.X + 12, self.y - 2,<br />                                      self.X + 14, self.y,<br />                                      self.X, self.y)))<br /><br />    def desenha_tiro(self):<br />        self.set_color(self.C)<br />        J = self.J + 1<br />        pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                             ('v2i', (70 * J, 158 - self.Y[self.J],<br />                                      70 * J, 154 - self.Y[self.J])))<br /><br />    def desenha_bases(self):<br />        self.set_color(3)<br />        for J in range(1, 4):<br />            pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                                 ('v2i', (70 * J - 5, 159,<br />                                          70 * J + 5, 159)))<br /><br />    def set_color(self, color):<br />        glColor3f(*self.cor[color])<br /><br />    def muda_estado(self, estado):<br />        print("Mudan&#231;a de Estado: {} --&gt; {}".format(self.estado, estado))<br />        self.estado = estado<br /><br />    def imprima(self, mensagem):<br />        self.label = self.window.crialabel(mensagem)<br /><br /><br />class Missile(pyglet.window.Window):<br />    def __init__(self):<br />        self.scale = 4    # Escala os gr&#225;ficos 4x<br />        self.frames = 8   # Frames por segundo.<br />                          # Define quantas vezes vamos atualizar a tela por segundo<br />        super(Missile, self).__init__(280 * self.scale,<br />                                      192 * self.scale,<br />                                      caption="Missiles")<br />        self.set_mouse_visible(False)<br />        self.game = Game(self)<br />        self.schedule = pyglet.clock.schedule_interval(<br />            func=self.update, interval=1.0 / self.frames)<br /><br />    def update(self, interval):<br />        pass<br /><br />    def on_draw(self):<br />        window.clear()<br />        self.game.atualiza()<br /><br />    def on_resize(self, width, height):<br />        # Inicializa a view<br />        glViewport(0, 0, width, height)<br />        glMatrixMode(gl.GL_PROJECTION)<br />        glLoadIdentity()<br />        # Inverte as coordenadas do eixo Y<br />        glOrtho(0, width, height, 0, -1, 1)<br />        # Aplica a escala<br />        glScalef(self.scale, self.scale, 1.0)<br />        glMatrixMode(gl.GL_MODELVIEW)<br /><br />    def on_key_press(self, symbol, modifiers):<br />        self.game.pressionado = True<br /><br />    def crialabel(self, mensagem, x=None, y=None,<br />                  fonte='Times New Roman', tamanho=36):<br />        """Prepara uma mensagem de texto para ser exibida"""<br />        x = x or self.width // 2<br />        y = y or self.height // 2<br />        return pyglet.text.Label(<br />            mensagem, font_name=fonte, font_size=tamanho,<br />            x=x, y=y, anchor_x='center', anchor_y='center')<br /><br /><br />window = Missile()<br />pyglet.app.run()<br /></pre><br />Em um pr&#243;ximo artigo, vou continuar a refatorar o c&#243;digo. Tiro e Avi&#227;o s&#227;o claramente classes. Anima&#231;&#227;o deixa a desejar. Mas &#233; o divertido da programa&#231;&#227;o, voc&#234; sempre pode melhorar.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:39	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-3571714467838324534"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic_21.html">
Convertendo um jogo escrito em Basic para Python - Parte II	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2016-05-21-convertendo-um-jogo-escrito-em-basic-para-python-parte-ii/">Leia no novo blog</a><br /><br />Neste segundo post, vamos melhorar nosso jogo.<br /><br />Embora a nova vers&#227;o rode em Python, ainda est&#225; muito anos 80.<br />A primeira coisa a corrigir &#233; a anima&#231;&#227;o. Como estamos usando um sistema de coordenadas de 280 por 192 pontos para simular as coordenadas do Apple, multiplicamos cada coordenada por 4 na hora de desenhar. Para deixar parecido com o Apple, eu reduzi o n&#250;mero de frames a 8 frames por segundo. Por isso a anima&#231;&#227;o d&#225; tantos saltos! Para fazer com que rode a 60 frames, temos que multiplicar as velocidades pela raz&#227;o entre o n&#250;mero de frames antigos e o novo: 8/60. A nova vers&#227;o define algumas constantes para isso:<br /><br /><pre class="brush:python">FRAMES_ORIGINAL = 8<br />FRAMES_NOVO = 60<br />RATIO = FRAMES_ORIGINAL / FRAMES_NOVO<br /></pre><br /><br />Olhando o c&#243;digo, fica f&#225;cil perceber que o tiro, o avi&#227;o e as bases s&#227;o objetos. Vamos extrair o c&#243;digo do jogo e dividir as opera&#231;&#245;es em atualiza e desenha. No caso, atualiza calcula a nova posi&#231;&#227;o do objeto e desenha realiza o desenho em si.<br /><br /><pre class="brush:python">class Aviao:<br />    def __init__(self, jogo, cor=3):<br />        self.cor = cor<br />        self.velocidade_aviao = (random.randint(0, 6) + 4) * RATIO<br />        self.altura_do_aviao = 159 - (random.randint(0, 135) + 11)<br />        self.posicao_do_aviao = self.velocidade_aviao<br />        self.ativo = True<br />        self.jogo = jogo<br /><br />    def desenha(self):<br />        y = self.altura_do_aviao<br />        x = self.posicao_do_aviao<br />        set_color(self.cor)<br />        pyglet.graphics.draw(6, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2f', (x, y,<br />                                      x, y - 8,<br />                                      x + 3, y - 2,<br />                                      x + 12, y - 2,<br />                                      x + 14, y,<br />                                      x, y)))<br /><br />    def desativa(self):<br />        self.ativo = False<br />        self.jogo.desativa(self)<br /><br />    def atualiza(self):<br />        self.posicao_do_aviao += self.velocidade_aviao<br />        if self.posicao_do_aviao &gt; 265:<br />            self.desativa()<br /></pre><br /><br /><br />&nbsp;O c&#243;digo completo pode ser visto aqui: <br /> Tente entender como a forma de desenhar em etapas, separando o desenho da atualiza&#231;&#227;o, permite que exibamos a mensagem com a imagem do jogo no fundo, ao inv&#233;s da tela preta..<br /><br />Os pr&#243;ximos passos s&#227;o:<br /><br /><ol><li>Limpar as classes</li><li>V&#225;rios avi&#245;es</li><li>M&#250;ltiplos tiros.</li><li>Generalizar os objetos do jogo em uma super classe.</li><li>Exibir um placar</li><li>Atribuir teclas para atirar e jogar de novo ou sair.</li></ol><br /><br />At&#233; o pr&#243;ximo!<br /><br /><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic_21.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:38	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-8234662465924570380"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic_22.html">
Convertendo um jogo escrito em Basic para Python - Parte III	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2016-05-22-convertendo-um-jogo-escrito-em-basic-para-python-parte-iii/">Leia no novo blog</a><br /><br />Nesta terceira parte, temos os seguintes objetivos:<br /><br /><br /><ul><li>Limpar as classes</li><li>V&#225;rios avi&#245;es</li><li>M&#250;ltiplos tiros.</li><li>Generalizar os objetos do jogo em uma super classe</li><li>Exibir um placar</li><li>Atribuir teclas para atirar e jogar de novo ou sair</li></ul><br /><br />Na vers&#227;o da Parte II, as classes tem muito c&#243;digo repetido.<br />Analisando cada uma delas, podemos chegar a conclus&#227;o de um comportamento comum quanto<br />a forma de desenhar e atualizar os objetos. Um m&#233;todo para retirar o objeto do jogo tamb&#233;m &#233; utilizado.<br /><br />Todo objeto do jogo precisa ter acesso ao jogo em sim.<br />Embora quase n&#227;o utilizemos cores, eu adicionei a cor como par&#226;metro, uma vez que pode ser usada para representar m&#250;ltiplos jogadores ou diferentes tipos de objetos.<br /><br />Uma das coisas que n&#227;o ficaram claras na vers&#227;o anterior &#233; o controle de colis&#227;o. Na realidade, o controle de colis&#227;o que utilizamos &#233; bem b&#225;sico e dif&#237;cil de generalizar. Para permitir o controle da colis&#227;o entre objetos, cada objeto ter&#225; uma posi&#231;&#227;o x e y na tela, com altura e largura.<br /><br />Desta forma, dois objetos colidem se o ret&#226;ngulo formado pelos pontos:<br /><br />(x, y), (x + largura, y), (x + largura, y + altura), (x, y + altura)<br /><br />De dois objetos tiverem pontos em comum.<br /><br />Como diferentes tipos de objetos colidem entre si, a propriedade colis&#227;o guarda o tipo de objeto.<br />Desta forma, podemos separar os tiros do avi&#227;o em si.<br /><br />Uma vari&#225;vel de DEBUG tamb&#233;m foi adicionada, para mostrar o ret&#226;ngulo de colis&#227;o caso precisemos fazer ajustes.<br /><br /><pre class="brush:python">class ObjetoDoJogo:<br />    def __init__(self, jogo, cor):<br />        self.jogo = jogo<br />        self.cor = cor<br />        self.ativo = True<br />        self.colisao = FUNDO<br />        self.largura = 0<br />        self.altura = 0<br />        self.x = 0<br />        self.y = 0<br />        self.debug = DEBUG<br /></pre><br />Se debug estiver ativo, vamos desenhar uma caixa em volta do objeto.<br /><br /><div class="separator"><a href="https://2.bp.blogspot.com/-BywiNdd74p0/V0GQUG9noRI/AAAAAAAABUc/kwmfQkNEedcbYWoB6c_ZOFtzz4Mpc7DYwCLcB/s1600/debug%2Bativo.png"><img border="0" height="228" src="https://2.bp.blogspot.com/-BywiNdd74p0/V0GQUG9noRI/AAAAAAAABUc/kwmfQkNEedcbYWoB6c_ZOFtzz4Mpc7DYwCLcB/s320/debug%2Bativo.png" width="320" /></a></div><br /><br />Desta forma, fica mais f&#225;cil detectar erros nos limites e no tamanho do objeto.<br /><br /><pre class="brush:python">    def desenha(self):<br />        if self.debug:<br />            set_color(2)<br />            pyglet.graphics.draw(4, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2f', (self.x, self.y,<br />                                      self.x + self.largura, self.y,<br />                                      self.x + self.largura, self.y + self.altura,<br />                                      self.x, self.y + self.altura)))<br /></pre><br />A atualiza&#231;&#227;o das propriedades, embora presente em todos os objetos, n&#227;o tem um comportamento padr&#227;o.<br />Vamos utilizar apenas pass para marcar o lugar.<br /><br /><pre class="brush:python">    def atualiza(self):<br />        """Calcula nova posi&#231;&#227;o, atualiza valores a cada frame"""<br />        pass<br /></pre><br />Aqui um m&#233;todo para dar uma oportunidade ao objeto de tratar a colis&#227;o com outro objeto.<br />Este m&#233;todo ser&#225; chamado pelo jogo, sempre que dois objetos colidirem.<br /><br /><pre class="brush:python">    def colidiu(self, outro):<br />        """O que fazer em caso de colisao? Recebe o outro objeto"""<br />        pass<br /></pre><br />E este aqui &#233; o teste de colis&#227;o em si, bem simples. Ele s&#243; funciona com larguras e alturas positivas. <br /><pre class="brush:python">    def colide(self, outro):<br />        if self.x &lt; outro.x + outro.largura and self.x + self.largura &gt; outro.x and \<br />           self.y &lt; outro.y + outro.altura and self.altura + self.y &gt; outro.y:<br />            self.colidiu(outro)<br />            outro.colidiu(self)<br /></pre><br />Quando a colis&#227;o &#233; detectada, o m&#233;todo colidiu dos dois objetos &#233; chamado.<br /><br />E finalmente o m&#233;todo para desativar e retirar o objeto do jogo:<br /><br /><pre class="brush:python">    def desativa(self):<br />        self.ativo = False<br />        self.jogo.desativa(self)<br /></pre><br />Vejamos como ficou a classe do Avi&#227;o:<br /><br /><pre class="brush:python">class Aviao(ObjetoDoJogo):<br />    def __init__(self, jogo, cor=3):<br />        super(Aviao, self).__init__(jogo, cor)<br />        self.velocidade = (random.randint(0, 6) + 4) * RATIO<br />        self.y = 159 - (random.randint(0, 135) + 11)<br />        self.x = self.velocidade<br />        self.altura = 9<br />        self.largura = 15<br />        self.colisao = AVIAO<br />        self.escapou = False<br /><br />    def desenha(self):<br />        super().desenha()<br />        y = self.y + self.altura<br />        x = self.x<br />        set_color(self.cor)<br />        pyglet.graphics.draw(6, pyglet.gl.GL_LINE_LOOP,<br />                             ('v2f', (x, y,<br />                                      x, y - 8,<br />                                      x + 3, y - 2,<br />                                      x + 12, y - 2,<br />                                      x + 14, y,<br />                                      x, y)))<br /><br />    def atualiza(self):<br />        self.x += self.velocidade<br />        if self.x &gt; 265:<br />            self.escapou = True<br />            self.desativa()<br /><br />    def colidiu(self, outro):<br />        if outro.colisao == TIRO:<br />            self.jogo.objetos.append(Explosao(self.jogo, self.x, self.y))<br />            self.desativa()<br /></pre><br />Nesta vers&#227;o, o nome das propriedades j&#225; foi ajustado. N&#227;o utilizo mais altura_do_aviao que se tornou apenas a coordenada y. Na classe Avi&#227;o, adicionei a propriedade escapou para marcar os avi&#245;es que saem da tela sem terem sido destru&#237;dos, dos que s&#227;o atingidos por m&#237;sseis. Mais tarde, esta informa&#231;&#227;o ser&#225; utilizada para contar pontos.<br /><br />Quando o avi&#227;o colide com um Tiro, um novo tipo de objeto, Explosao &#233; adicionado ao jogo. Desta forma, teremos um efeito simples quando o avi&#227;o for atingido.<br /><br />Uma das vantagens de se trabalhar com objetos &#233; a facilidade de cri&#225;-los. No caso, a explos&#227;o &#233; apenas outro objeto adicionado ao jogo.<br /><br /><pre class="brush:python">class Explosao(ObjetoDoJogo):<br />    def __init__(self, jogo, x, y):<br />        super(Explosao, self).__init__(jogo, cor=0)<br />        self.estagio = 8<br />        self.x = x<br />        self.y = y<br /><br />    def desenha(self):<br />        dx = 4 * self.estagio  #random.randint(1, 4)<br />        dy = random.randint(1, 4) * self.estagio<br />        dx2 = random.randint(1, 4) * self.estagio<br />        dy2 = random.randint(1, 4) * self.estagio<br />        y = self.y<br />        set_color(7)<br />        pyglet.graphics.draw(3, pyglet.gl.GL_TRIANGLES,<br />                             ('v2f', (self.x, y,<br />                                      self.x - dx, y + dy,<br />                                      self.x + dx2, y + dy2)))<br />        set_color(8)<br />        pyglet.graphics.draw(3, pyglet.gl.GL_TRIANGLES,<br />                             ('v2f', (self.x, y,<br />                                      self.x -dx/self.estagio , y + dx,<br />                                      self.x + dx2 * self.estagio, y + dy2)))<br /><br />    def atualiza(self):<br />        self.estagio -= 0.4<br />        if(self.estagio &lt; 0):<br />            self.desativa()<br /></pre><br />A ideia da explos&#227;o &#233; que tri&#226;ngulos amarelos e vermelhos, de tamanhos aleat&#243;rios apare&#231;am na tela.<br />Como a explos&#227;o n&#227;o se move, a propriedade estagio foi adicionada para controlar seu tempo de vida.<br />No caso, a cada frame, subtrairemos 0.4 de estagio e quando este for negativo, o objeto ser&#225; retirado do jogo.<br /><br />A classe Tiro foi tamb&#233;m melhorada:<br /><br /><pre class="brush:python">class Tiro(ObjetoDoJogo):<br />    def __init__(self, jogo, posicao):<br />        super(Tiro, self).__init__(jogo, cor=3)<br />        self.y = 170<br />        self.x = (posicao + 1) * 70<br />        self.velocidade = 5 * RATIO<br />        self.colisao = 2<br />        self.altura = 5<br />        self.largura = 2<br />        self.errou = False<br /><br />    def desenha(self):<br />        super().desenha()<br />        set_color(self.cor)<br />        y = self.y + self.altura<br />        pyglet.graphics.draw(2, pyglet.gl.GL_LINES,<br />                             ('v2f', (self.x, y,<br />                                      self.x, y - 4)))<br />        v = 4<br />        a = random.randint(3, 4)<br />        set_color(7)<br />        pyglet.graphics.draw(3, pyglet.gl.GL_TRIANGLES,<br />                             ('v2f', (self.x, y,<br />                                      self.x - 1, y + v,<br />                                      self.x + 1, y + v)))<br />        set_color(8)<br />        pyglet.graphics.draw(3, pyglet.gl.GL_TRIANGLES,<br />                             ('v2f', (self.x, y,<br />                                      self.x - 0.5, y + a,<br />                                      self.x + 0.5, y + a)))<br /><br />    def atualiza(self):<br />        self.y -= self.velocidade<br />        if self.y &lt; 0:<br />            self.errou = True<br />            self.desativa()<br /><br />    def colidiu(self, outro):<br />        if outro.colisao == AVIAO:<br />            self.desativa()<br /></pre><br />O Tiro agora tem um foguete, o efeito &#233; interessante, embora simples.<br />Quando o tiro sai da tela sem atingir um avi&#227;o, este &#233; considerado um erro e o jogador &#233; penalizado.<br /><br />As bases s&#227;o tamb&#233;m desenhadas como objetos do jogo. Nesta vers&#227;o eu mudei o desenho.<br /><br /><pre class="brush:python">class Base(ObjetoDoJogo):<br />    def __init__(self, jogo, posicao):<br />        super(Base, self).__init__(jogo, cor=3)<br />        self.y = 175<br />        self.x = (posicao + 1) * 70<br /><br />    def desenha(self):<br />        super().desenha()<br />        set_color(self.cor)<br />        pyglet.graphics.draw(5, pyglet.gl.GL_LINE_STRIP,<br />                             ('v2f', (self.x - 5, self.y + 5,<br />                                      self.x - 3, self.y + 2,<br />                                      self.x, self.y,<br />                                      self.x + 3, self.y + 2,<br />                                      self.x + 5, self.y + 5,<br />                                      )))<span><span><br /></span></span></pre><br />A classe do jogo em si foi simplificada:<br /><br /><pre class="brush:python">class Game:<br />    def __init__(self, parent):<br />        self.cor = CORES<br />        self.window = parent<br />        self.tiros_disparados = 0  # tiros j&#225; disparados<br />        self.estado = "jogando"<br />        self.pressionado = False<br />        self.label = None<br />        self.objetos = [Aviao(self)]<br />        self.objetos.extend([Base(self, base) for base in range(0, 3)])<br />        self.pontos = 0<br /><br />        self.placar = pyglet.text.Label("Pontos: 0", font_name="Times New Roman", font_size=16,<br />                                   x=80, y=-185 * 4, anchor_x='center', anchor_y='center')<br /></pre><br />Agora temos um contador de pontos e um placar. Um objeto da classe Avi&#227;o e as tr&#234;s bases s&#227;o adicionadas ao jogo inicial.<br /><br /><pre class="brush:python">def desativa(self, objeto):<br />        self.objetos.remove(objeto)<br />        if objeto.colisao == AVIAO:<br />            if objeto.escapou:<br />                self.pontos -= 3<br />            else:<br />                self.pontos += 5<br />            self.objetos.append(Aviao(self))<br />        elif objeto.colisao == TIRO:<br />            if objeto.errou:<br />                self.pontos -= 1<br /></pre><br />A desativa&#231;&#227;o de um objeto &#233; a retirada deste da lista de objetos do jogo.<br />Quando &#233; um avi&#227;o, verifica se o avi&#227;o escapou da tela sem ter sido atingido.<br />Se escapou, o jogador perde 3 pontos. Se foi destru&#237;do, o jogador ganha 5 pontos.<br /><br />A cada tiro disparado que sai da tela sem atingir um avi&#227;o, o jogador perde 1 ponto.<br /><br />Agora que temos o placar a mostrar, precisamos modificar o m&#233;todo mostra_mensagem.<br />Este deve exibir o placar sempre:<br /><br /><pre class="brush:python">    def mostra_mensagem(self):<br />        glPushMatrix()<br />        glScalef(0.25, -0.25, 0.25)<br />        if self.label:<br />            self.label.draw()<br />        self.placar.text = "Pontos: {}".format(self.pontos)<br />        self.placar.draw()<br />        glPopMatrix()<br /></pre><br /><br />O glPushMatrix e glPopMatrix foram utilizados para corrigir o desenho do texto.<br />Como estamos utilizando uma escala 4 com invers&#227;o das coordenadas do eixo Y, o glScalef<br />foi utilizado com 0.25 (que na multiplica&#231;&#227;o &#233; o mesmo que 1/4 ou que dividir por 4) e<br />-0.25 no eixo Y, que divide por 4 e inverte o sinal.<br />O glPushMatrix &#233; utilizado para salvar a matriz atual na pilha, desta forma o glScalef<br />ser&#225; utilizado apenas at&#233; o glPopMatrix que restaura os par&#226;metros anteriores.<br /><br />O m&#233;todo atualiza foi simplificado:<br /><br /><pre class="brush:python">    def atualiza(self):<br />        self.jogue()<br />        if self.estado != "jogando":<br />            if self.pressionado:<br />                pyglet.app.event_loop.exit()<br />        self.mostra_mensagem()<br /></pre><br />O m&#233;todo jogue sempre &#233; chamado. Desta forma podemos ter o desenho do jogo, mesmo quando exibimos uma mensagem de fim por exemplo. Nesta vers&#227;o, n&#227;o h&#225; mudan&#231;a de estado, pois eu modifiquei o jogo para gerar outro avi&#227;o sempre que um for destru&#237;do ou sumir, n&#227;o tendo fim.<br /><br />E o m&#233;todo jogue tamb&#233;m simplificado:<br /><br /><pre class="brush:python">    def jogue(self):<br />        for objeto in self.objetos:<br />            objeto.desenha()<br /><br />        self.processa_tiros()<br />        if self.estado == "jogando":<br />            for objeto in self.objetos:<br />                objeto.atualiza()<br /><br />            if self.pressionado:<br />                self.objetos.append(Tiro(self, self.tiros_disparados % 3))<br />                self.tiros_disparados += 1<br />                self.pressionado = False<br /></pre><br />Ele apenas desenha todos os objetos da lista e chama processa_tiros que testa colis&#245;es.<br />Se ainda estivermos jogando, chama a atualiza&#231;&#227;o de todos os objetos da lista e se algo foi pressionado, gera um tiro. Para termos v&#225;rios tiros, a base que o dispara &#233; calculada pelo m&#243;dulo do n&#250;mero do tiro e o n&#250;mero de bases.<br /><br /><pre class="brush:python">def processa_tiros(self):<br />        tiros = [objeto for objeto in self.objetos if objeto.colisao == TIRO]<br />        avioes = [objeto for objeto in self.objetos if objeto.colisao == AVIAO]<br /><br />        for aviao in avioes:<br />            for tiro in tiros:<br />                aviao.colide(tiro)<br /></pre><br />Aqui uma simplifica&#231;&#227;o, onde abuso um pouco do computador :-D<br />Utilizando duas "list comprehensions", eu filtro a lista de objetos, procurando avi&#245;es e tiros.<br />Desta forma, a verifica&#231;&#227;o de colis&#227;o se torna mais simples, pois basta verificar se o avi&#227;o colidiu com um dos tiros.<br /><br />O jogo principal pouco mudou, salvo o m&#233;todo on_key_press:<br /><br /><pre class="brush:python">def on_key_press(self, symbol, modifiers):        <br />        if symbol == key.S:<br />            print("Placar: {}".format(self.game.pontos))<br />            pyglet.app.event_loop.exit()<br />        elif symbol == key.R:<br />            self.game = Game(self)<br />        else:<br />            self.game.pressionado = True<br /></pre><br />No caso, o jogo termina quando pressionamos a tecla S e reinicia se pressionarmos a tecla R.<br /><br />O jogo completo ficou assim:<br /><br /> <br />Video: <br /><br /><div class="separator"></div><br /><br />Para o pr&#243;ximo post:<br /><br /><ol><li>Sons</li><li>Imagens</li></ol><br /><br />A pyglet n&#227;o &#233; atualizada h&#225; bastante tempo. Eu devo procurar outra biblioteca gr&#225;fica para outros posts, mas vou terminar as melhorias deste jogo ainda com pyglet e abusando da OpenGL.<br /><br /><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2016/05/convertendo-um-jogo-escrito-em-basic_22.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:38	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-1957408936070359408"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2016/05/uso-de-uuids-como-chave-primaria-com.html">
Uso de UUIDs como chave prim&#225;ria com Django e Postgres	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2016-05-28-uso-de-uuids-como-chave-primaria-com-django-e-postgres/">Leia no novo blog</a><br /><br />Por default, o Django cria chaves prim&#225;rias do tipo inteiro (32 bits) quando usado com o banco PostgreSQL. Estes campos s&#227;o incrementados automaticamente e funcionam perfeitamente bem em ambiente local. Um problema que aparece quando voc&#234; cria uma API &#233; o fato de seus ids sequenciais e num&#233;ricos exporem detalhes de sua base de dados.<br /><br />Imagine que seu cliente tem o id 1, ele pode imaginar (e com raz&#227;o) que &#233; seu primeiro cliente. O mesmo pode ser utilizado por concorrentes para saber quantos novos clientes voc&#234; obteve em determinado per&#237;odo, bastando para isso criar uma nova conta. Isto pode gerar uma vontade incontrol&#225;vel em algumas pessoas de explorar os valores de suas chaves. Com chaves inteiras, esta tarefa &#233; f&#225;cil, basta incrementar o valor da chave de 1 e tentar novamente.<br /><br />Uma alternativa &#224;s chaves inteiras &#233; a utiliza&#231;&#227;o de UUID, geradas aleatoriamente, por&#233;m maiores (128 bits). Por serem 4 vezes maiores, j&#225; podemos imaginar que o espa&#231;o em disco ocupado pelas chaves e &#237;ndices vai tamb&#233;m aumentar. Mas e quanto as opera&#231;&#245;es de inser&#231;&#227;o, busca e atualiza&#231;&#227;o de tabelas? Quanto custa substituir as chaves inteiras por UUIDs.<br /><br />Exemplo de UUID:<br /><div><b><span>cab5ade3-2dc3-4344-b5a6-80df59f91458</span></b></div><br />Eu resolvi fazer um teste, comparando chaves inteiras, uuids e uma solu&#231;&#227;o mista, onde a uuid &#233; utilizada fora da aplica&#231;&#227;o, mas mantendo uma chave prim&#225;ria inteira.<br /><br />Os modelos s&#227;o bem simples (chaves inteiras, modelo de refer&#234;ncia):<br /><br /><pre class="brush:python">class A(models.Model):<br />    bigtext = models.TextField()<br />    name = models.CharField(max_length=100)<br />    counter = models.IntegerField(default=0)<br /><br /><br />class B(models.Model):<br />    parent = models.ForeignKey(A, related_name="bs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /><br /><br />class C(models.Model):<br />    parent = models.ForeignKey(B, related_name="cs")<br />    grandparent = models.ForeignKey(A, related_name="cs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /></pre><br />A, B, C e foram configuradas de forma a estabeler um relacionamento entre elas.<br /><br />Vamos modificar os modelos para utilizarmos UUIDs:<br /><br /><pre class="brush:python">class A(models.Model):<br />    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)<br />    bigtext = models.TextField()<br />    name = models.CharField(max_length=100)<br />    counter = models.IntegerField(default=0)<br /><br /><br />class B(models.Model):<br />    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)<br />    parent = models.ForeignKey(A, related_name="bs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /><br /><br />class C(models.Model):<br />    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)<br />    parent = models.ForeignKey(B, related_name="cs")<br />    grandparent = models.ForeignKey(A, related_name="cs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /></pre><br /><br />E uma solu&#231;&#227;o h&#237;brida alternativa, com duas chaves, uma uuid e outra inteira:<br /><br /><pre class="brush:python">class A(models.Model):<br />    surrogate_id = models.UUIDField(default=uuid.uuid4, editable=False, unique=True)<br />    bigtext = models.TextField()<br />    name = models.CharField(max_length=100)<br />    counter = models.IntegerField(default=0)<br /><br /><br />class B(models.Model):<br />    surrogate_id = models.UUIDField(default=uuid.uuid4, editable=False, unique=True)<br />    parent = models.ForeignKey(A, related_name="bs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /><br /><br />class C(models.Model):<br />    surrogate_id = models.UUIDField(default=uuid.uuid4, editable=False, unique=True)<br />    parent = models.ForeignKey(B, related_name="cs")<br />    grandparent = models.ForeignKey(A, related_name="cs")<br />    bigtext = models.TextField()<br />    counter = models.IntegerField(default=0)<br /></pre><br /><br />O programa completo pode ser baixado aqui: <a href="https://github.com/lskbr/keyperftest">https://github.com/lskbr/keyperftest</a><br /><br />Ambiente de testes:<br />Processador: Intel Core i7 4790K 4 GHz<br />Disco: Samsung SSD 850 EVO<br />Ubuntu 16.04 rodando em VM VirtualBox (4 GB, 4 CPUs)<br />PostgreSQL 9.5.2 rodando via docker<br />Django 1.9.6<br />Python 3.5.1<br />Testes realizados em: 28/05/2016<br /><br />Rodando o programa com 1000 registros, obtemos os seguintes resultados (todos os tempos em segundos):<br /><div class="separator"></div><div class="separator"></div><br /><div class="separator"><a href="https://2.bp.blogspot.com/-L3d7FBzOZDk/V0mDumehR1I/AAAAAAAABVY/PbfDg_jtfyEMYbjR5w8AK7CsrngYQPDHQCKgB/s1600/image001.png"><img border="0" height="210" src="https://2.bp.blogspot.com/-L3d7FBzOZDk/V0mDumehR1I/AAAAAAAABVY/PbfDg_jtfyEMYbjR5w8AK7CsrngYQPDHQCKgB/s320/image001.png" width="320" /></a></div><div class="separator"></div><br />Neste primeiro resultado, percebemos o tempo de inser&#231;&#227;o com chave inteira e uuid n&#227;o &#233; muito diferente. A solu&#231;&#227;o mista (chave inteira&nbsp;+ uuid) leva mais tempo.<br /><div class="separator"><a href="https://4.bp.blogspot.com/-vLTAoK6fct4/V0mDulP2bYI/AAAAAAAABVc/bHc4XokTlm8TK7XaRV7ZG7JcPUoexQM9QCKgB/s1600/image002.png"><img border="0" height="210" src="https://4.bp.blogspot.com/-vLTAoK6fct4/V0mDulP2bYI/AAAAAAAABVc/bHc4XokTlm8TK7XaRV7ZG7JcPUoexQM9QCKgB/s320/image002.png" width="320" /></a></div><br /><div class="separator"></div>Para simular o tempo de acesso aleat&#243;rio a tabelas com chave inteira ou uuid, vemos que como esperado, as chaves inteiras possuem a melhor performance. A solu&#231;&#227;o h&#237;brida se apresenta como uma alternativa interessante, uma vez que o relacionamento entre as tabelas continua sendo feito por chaves inteiras (a chave surrogate &#233; utilizada apenas para encontrar o registro em C, as liga&#231;&#245;es entre A e B s&#227;o feitas com chaves inteiras).<br /><br /><div class="separator"><a href="https://2.bp.blogspot.com/-PJHt4_HtoBQ/V0mDupFdQwI/AAAAAAAABVU/m9VozzYOMRYB2sobDTBFPY0TI8gioAj1gCKgB/s1600/image003.png"><img border="0" height="210" src="https://2.bp.blogspot.com/-PJHt4_HtoBQ/V0mDupFdQwI/AAAAAAAABVU/m9VozzYOMRYB2sobDTBFPY0TI8gioAj1gCKgB/s320/image003.png" width="320" /></a></div><br /><div class="separator"></div><br />E nesta imagem o resultado das opera&#231;&#245;es de atualiza&#231;&#227;o da tabelas. No caso, atualizamos a partir de C, as tabelas A e B. Mais uma vez as chaves inteiras tiveram um melhor desempenho e a combina&#231;&#227;o de chave inteira com uuid se apresenta como uma meio termo.<br /><br />Repetindo os testes, mas desta vez para 10.000 registros, as diferen&#231;as se tornam mais claras.<br /><br /><div class="separator"></div>No caso da inser&#231;&#227;o:<br /><div class="separator"><a href="https://4.bp.blogspot.com/-t-PFfq1UlIE/V0mDu6Sf4YI/AAAAAAAABVg/szL0ULQuasoigQX8aMK51CkbhxtDddKJwCKgB/s1600/image004.png"><img border="0" height="210" src="https://4.bp.blogspot.com/-t-PFfq1UlIE/V0mDu6Sf4YI/AAAAAAAABVg/szL0ULQuasoigQX8aMK51CkbhxtDddKJwCKgB/s320/image004.png" width="320" /></a></div><br />Acesso:<br /><br /><div class="separator"><a href="https://3.bp.blogspot.com/-c2HvliP5Ec4/V0mDvB-eTOI/AAAAAAAABVo/BfX-xj3eQug7qSJdtSejzXHUq24RHgQ1wCKgB/s1600/image006.png"><img border="0" height="210" src="https://3.bp.blogspot.com/-c2HvliP5Ec4/V0mDvB-eTOI/AAAAAAAABVo/BfX-xj3eQug7qSJdtSejzXHUq24RHgQ1wCKgB/s320/image006.png" width="320" /></a></div><br />Atualiza&#231;&#227;o<br /><br /><div class="separator"><a href="https://2.bp.blogspot.com/-o0ZVc7FMsfM/V0mDuzDi_zI/AAAAAAAABVk/APtWtJXlHpgs3pnZ0T55BpVhZZc8zJi6gCKgB/s1600/image005.png"><img border="0" height="210" src="https://2.bp.blogspot.com/-o0ZVc7FMsfM/V0mDuzDi_zI/AAAAAAAABVk/APtWtJXlHpgs3pnZ0T55BpVhZZc8zJi6gCKgB/s320/image005.png" width="320" /></a></div><br />Embora haja diferen&#231;a entre os tempos destas opera&#231;&#245;es, os resultados n&#227;o demonstram uma lentid&#227;o excessiva ao aumentarmos o tamanho da chave 4 vezes, de 32 para 128 bits.<br /><br />Considerando os tempos das opera&#231;&#245;es com chaves inteiras como 100%, temos os seguintes resultados m&#233;dios:<br /><br /><table border="0" cellpadding="0" cellspacing="0"> <colgroup><col span="4" width="80" /> </colgroup><tbody><tr height="20">  <td height="20" width="80"></td>  <td width="80">Inser&#231;&#227;o</td>  <td class="xl65" width="80">Atualiza&#231;&#227;o</td>  <td class="xl65" width="80">Acesso</td> </tr><tr height="20">  <td height="20">integer</td>  <td align="right" class="xl65">100.00%</td>  <td align="right" class="xl65">100.00%</td>  <td align="right" class="xl65">100.00%</td> </tr><tr height="20">  <td height="20">uuid</td>  <td align="right" class="xl65">101.64%</td>  <td align="right" class="xl65">108.77%</td>  <td align="right" class="xl65">108.97%</td> </tr><tr height="20">  <td height="20">interger + uuid</td>  <td align="right" class="xl65">106.15%</td>  <td align="right" class="xl65">106.63%</td>  <td align="right" class="xl65">111.85%</td> </tr></tbody></table><br /><br />Utilizar as UUIDs em URLs tamb&#233;m aumenta o tamanho das strings, mas acredito ser um pre&#231;o a se pagar pela comodidade.<br /><br />Al&#233;m de esconder a sequ&#234;ncia de chaves e n&#227;o possibilitar a dedu&#231;&#227;o do n&#250;mero de registros de seu banco de dados, UUID possuem as seguintes vantagens:<br />a) Podem ser geradas em v&#225;rias m&#225;quinas, permitindo que seu banco rode em v&#225;rios servidores sincronizados.<br />b) Evitam ataques por dedu&#231;&#227;o das chaves<br /><br />Desvantagens de UUIDs:<br />a) Ocupam mais espa&#231;o em disco e em mem&#243;ria (128 bits)<br />b) S&#227;o um pouco mais lentas para gerar<br />c) Aumentam o tamanho das URLs<br />d) S&#227;o dif&#237;ceis de memorizar (o que pode dificultar as tarefas de depura&#231;&#227;o)<br /><br />Eu decidi utilizar UUID em projetos futuros, uma vez que a seguran&#231;a das chaves &#233; mais importante para mim que o espa&#231;o ocupado por estas e que n&#227;o h&#225; uma degrada&#231;&#227;o importante na velocidade de acesso ao banco. O uso de UUIDs tamb&#233;m facilitar a utiliza&#231;&#227;o do banco em clusters e at&#233; mesmo a gera&#231;&#227;o de chaves offline.<br /><br /><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2016/05/uso-de-uuids-como-chave-primaria-com.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:35	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-5085625896190352831"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2016/12/consultas-via-telegram.html">
Consultas via Telegram	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2016-12-27-consultas-via-telegram/">Leia no novo blog</a><br /><br /> Seria legal se profissionais de inform&#225;tica dessem consultas como m&#233;dicos ou advogados, mas algo nos impede de cobrar por tudo e esse desejo ou inten&#231;&#227;o de compartilhar ideias nos consome.<br /><br />Eu participo de v&#225;rios grupos de Telegram, principalmente sobre Python, um deles &#233; o <a href="https://telegram.me/PyCoding" target="_blank">PyCoding</a> e o outro &#233; o <a href="https://telegram.me/pythonbr" target="_blank">pybr</a>. Normalmente eu leio os grupos quando estou usando meu celular, ent&#227;o nem sempre &#233; poss&#237;vel ajudar com as d&#250;vidas, mas vou tentar separar um pouco de tempo para explorar algumas ideias aqui e l&#225;.<br /><br />Hoje est&#225; t&#227;o f&#225;cil aprender qualquer coisa que tenho notado uma ansiedade cada vez maior de quem come&#231;a a programar de aprender tudo. Em um s&#243; m&#234;s, algumas pessoas querem aprender Python, SciPi, TensorFlow, Android e o que mais der. Um m&#234;s &#233; pouco tempo. Pode-se aprender a programar em per&#237;odos relativamente pequenos, mas leva tempo para se acostumar com as novas ideias, linguagens e bibliotecas. O Peter Norvig comentou sobre essa ansiedade no <a href="http://norvig.com/21-days.html" target="_blank">Learn Programming in Ten Years</a>.<br /><br /><h3>C&#225;lculo de m&#233;dias</h3><br />Vamos ao interesse do post, a tal consulta.<br /><br /><code></code> O colega Wesley enviou dois programas, vou come&#231;ar pelo mais simples. Primeiro vamos desconsiderar os palavr&#245;es, nosso colega &#233; jovem.<br /><br />Uma coisa que gostei muito foi a primeira linha de mensagens. Poucos se preocupam em dizer o que faz o programa, isso &#233; legal! Eu faria apenas uma pequena modifica&#231;&#227;o para que a linha n&#227;o fosse t&#227;o grande.<br /><br />Como eu cresci nos anos 80, sem letras min&#250;sculas e acentos, &#233; quest&#227;o de honra corrigir as mensagens.<br /><br />Nas linhas 7 a 11, os valores das vari&#225;vies m1, n1, n2, n3 e n4 s&#227;o solicitados. Como a fun&#231;&#227;o input retorna strings, veja que no resto do programa a fun&#231;&#227;o float foi utilizada para converter estes valores. Neste caso, o valor convertido deveria ser armazenado diretamente na vari&#225;vel.<br /><br />Desta forma, simplificamos a linha 12 de forma a facilmente perceber um erro de prioridade de opera&#231;&#245;es. Quando fazemos o c&#225;lculo de n1&nbsp;+ n2&nbsp;+ n3&nbsp;+ n4 / 4, sem utilizar par&#234;nteses, as opera&#231;&#245;es s&#227;o realizados por ordem de prioridade, como na matem&#225;tica. Assim, n4/4 &#233; somado a n1, n2 e n3. Para calcular a m&#233;dia, precisamos de par&#234;nteses: (n1 + n2 + n3 + n4) / 4. Agora, a soma das notas &#233; calculada e depois dividida por quatro, como quer&#237;amos.<br /><br />Entre as linhas 15 e 19 acredito que tenha sido apenas um teste. Vou remover para n&#227;o atrapalhar o entendimento do programa final.<br /><br />As linhas de 24 a 35 imprimem v&#225;rios pontos, vou apenas simplificar.<br /><br />Para terminar, pequenas modifica&#231;&#245;es para usar as f strings do Python 3.6.<br /><br /><code></code> <br /><h3>Programa com tkinter</h3>O outro programa &#233; uma interface gr&#225;fica, usando tkinter.<br /><br /><code></code> Como os fontes foram postados no Telegram, muito se perde. De cara h&#225; um problema com o import da linha 2. Eu parabenizo o Wesley pela coragem de usar o tkinter. &#201; umas das partes do Python que menos gosto, mas que funciona.<br /><br /><div class="separator"><a href="https://3.bp.blogspot.com/-9hZ2seGK6LI/WGJap5AH_PI/AAAAAAAABZM/f2KXL5e1RVEbUu_Upua27Y-auQhxwQ9WgCLcB/s1600/w1.png"><img border="0" height="230" src="https://3.bp.blogspot.com/-9hZ2seGK6LI/WGJap5AH_PI/AAAAAAAABZM/f2KXL5e1RVEbUu_Upua27Y-auQhxwQ9WgCLcB/s320/w1.png" width="320" /></a></div><br />Deve-se evitar os import * no Python, isso polui o namespace e causa problemas chatos de resolver. No caso do tkinter, &#233; um caso a se pensar, mas nunca misturar o * com os imports de classes e fun&#231;&#245;es individuais.<br /><br />Uma coisa que salta aos olhos, n&#227;o, n&#227;o falo do fundo caladryl, mas da repeti&#231;&#227;o da cor em v&#225;rias partes do c&#243;digo. Vamos criar uma constante para cor de fundo, melhor, vamos retirar as cores e deixar as cores padr&#227;o.<br /><br />Um outro problema &#233; a valida&#231;&#227;o de valores, acrescentei uma fun&#231;&#227;o float_ou_zero que retorna zero caso o valor digitado n&#227;o possa ser convertido para float.<br /><br />Usar tkinter sem classes &#233; um tanto confuso, eu particularmente n&#227;o gosto de ter fun&#231;&#245;es com vari&#225;veis globais e de ter defini&#231;&#245;es de fun&#231;&#245;es e vari&#225;veis misturadas, mas isso &#233; assunto para outro post.<br /><br /><br /><code></code> Vejamos como ficou! <br /><br /><div class="separator"><a href="https://4.bp.blogspot.com/-y7HGc3tukjo/WGJniMmsXJI/AAAAAAAABZc/5pfO0LicbH4DSftQSvZeAYYTGRp2hxdAwCLcB/s1600/w2.png"><img border="0" height="198" src="https://4.bp.blogspot.com/-y7HGc3tukjo/WGJniMmsXJI/AAAAAAAABZc/5pfO0LicbH4DSftQSvZeAYYTGRp2hxdAwCLcB/s320/w2.png" width="320" /></a></div><div class="separator"><br /></div><div class="separator"><br /></div><br /><h3>Convertendo ints </h3><div>Outro post interessante foi o de como converter v&#225;rios ints de uma s&#243; vez. O problema inicial era calcular um valor do tipo hh:mm:ss em total de segundos.</div><br /><code></code> <br />O que me chamou aten&#231;&#227;o foi uma das solu&#231;&#245;es: <br /><code></code> <br />Correta, por&#233;m, achei que o foco da solu&#231;&#227;o n&#227;o era mais o problema inicial, mas fazer em menos linhas. De repente, passa o medo de "Perlizar" o Python.<br />O problema em si, exige valida&#231;&#227;o dos dados. Este &#233; um detalhe importante que &#233; f&#225;cil de ser esquecido. Ent&#227;o, ao inv&#233;s de fazer com menos linhas, vamos adicionar o m&#237;nimo de valida&#231;&#227;o. <br /><code></code> Esta solu&#231;&#227;o utiliza o m&#243;dulo datetime do Python e o tipo time para validar as horas entre 0 e 23, minutos entre 0 e 60 e o mesmo para segundos. Se o usu&#225;rio entrar um valor errado, ter&#225; que redigitar ap&#243;s receber uma mensagem de erro. Embora eu tenha usado a expans&#227;o de listas duas vezes em uma s&#243; linha (Perliza&#231;&#227;o?), acho que o c&#243;digo ficou relativamente bom.<br /><br />S&#227;o detalhes, mas que fazem a diferen&#231;a em programas maiores. Nem sempre escrever em menos linhas &#233; o mais correto ou deveria ser o foco principal da solu&#231;&#227;o de um problema.<br /><br />Ainda sobra margem para uma outra solu&#231;&#227;o, onde criamos uma fun&#231;&#227;o para converter horas, minutos e segundos para total em segundos.<br /><br /><code></code> Al&#233;m da valida&#231;&#227;o (ainda que m&#237;nima), ganhamos a flexibilidade de digitar valores como 10, 10:20 ou 10:20:30. O programa que fizemos pode ser importado por outros programas e suas fun&#231;&#245;es reutilizadas, sem perder a funcionalidade inicial se usado como programa principal.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2016/12/consultas-via-telegram.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:35	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-8312361233856668827.post-7076867570010367802"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://junglecoders.blogspot.com/2017/01/migrando-o-servidor-de-chat-para-python.html">
Migrando o servidor de chat para Python 3.6	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<a href="https://blog.nilo.pro.br/posts/2017-01-21-migrando-o-servidor-de-chat-para-python-3-6/">Leia no novo blog</a><br /><br />Na &#233;poca do lan&#231;amento do Python 3.4, eu estava t&#227;o contente com a integra&#231;&#227;o do Asyncio que escrevi um servidor de chat <a href="http://junglecoders.blogspot.be/2014/08/servidor-de-chat-com-websockets-e.html" target="_blank">aqui</a>. O tempo passou e novas vers&#245;es do Python foram lan&#231;adas. Resolvi ent&#227;o migrar o servidor para Python 3.6.<br /><br />Uma das grandes mudan&#231;as que ocorreram no Python 3.5, foi o suporte a <b><i>async</i></b> e <i><b>await</b></i> para substituir&nbsp;<i><b>@asyncio.corroutine</b></i> e <i><b>yield from</b></i> respectivamente. Esta pequena mudan&#231;a por si s&#243; j&#225; facilita em muito a leitura do c&#243;digo, que ficou mais leve. Mas uma das principais mudan&#231;as do Python 3.6 s&#227;o as <i>f-strings</i> que facilitam a forma&#231;&#227;o de mensagens.<br /><br />Primeiro, vamos preparar o ambiente. &#201; preciso instalar o Python 3.6. Se voc&#234; utiliza Windows, basta baixar o pacote no site da <a href="https://www.python.org/ftp/python/3.6.0/python-3.6.0.exe">Python.org</a>.<br /><br /><h3>Ubuntu 16.10</h3>Se voc&#234; utiliza Ubuntu 16.10, ainda precisa baixar os fontes e compilar... mas seguindo a recomenda&#231;&#227;o de amigos do Telegram, resolvi experimentar com o <a href="https://github.com/yyuu/pyenv-installer">pyenv</a>!<br /><br /> Para instalar no Ubuntu, baixe o <a href="https://gist.github.com/lskbr/b679b811c836b1c12375ec0321408418/raw/b3cb729ae5861d76d802a52b747a35a0aac886fe/install_python360.sh">install_python360.sh</a>&nbsp;e rode com:<br /><pre>bash install_python360.sh</pre><br /><br />Como alguns pacotes precisam ser instalados no Ubuntu, ele vai usar sudo. Esteja pronto para digitar a senha. No meu caso, como uso docker (docker run -rm -t -i ubuntu:16.10 /bin/bash), rodei o script como root. Se voc&#234; instalar no seu usu&#225;rio, ele vai chamar o <b><i>sudo</i></b> quando necess&#225;rio. Eu gravei um pequeno v&#237;deo do que aconteceu na minha instala&#231;&#227;o:<br /><br /> <br /><h3>Windows</h3>Depois de instalar o <a href="https://www.python.org/ftp/python/3.6.0/python-3.6.0.exe">Python 3.6.0</a>, instale o websockets com pip3 install websockets<br /><br /><h3>Outros sistemas</h3>Instale o Python 3.6.0 e o m&#243;dulo <a href="https://github.com/aaugustin/websockets">websockets</a>.<br /><br /><h3>O novo servidor</h3><br />Mudando <b><i>@asyncio.coroutine</i></b> para <i><b>async def</b></i>, o c&#243;digo j&#225; fica mais claro. Em uma segunda passagem, eu substitui os <b><i>yield from</i></b> por <b><i>await</i></b>. Como estamos usando Python 3.6, n&#227;o custa adaptar as strings para <i>f-strings</i>. E para terminar a migra&#231;&#227;o, configurei o log para que o c&#243;digo n&#227;o fique cheio de prints! Ficou assim:<br /><br /> Antes de executar, temos que preparar um certificado SSL (no Linux).<br /><br /><pre>openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes<br /><br /></pre><br /><h3>O cliente</h3><br />Hoje n&#227;o tem como escapar do Javascript. Fiz poucas altera&#231;&#245;es no c&#243;digo, a maior delas foi simplesmente cosm&#233;tica e agora o texto rola para baixo automaticamente quando novas mensagens chegam.<br /><br /> <br /><h3>Rodando</h3><br />Imaginando que voc&#234; esteja no mesmo diret&#243;rio dos arquivos deste post, vamos criar um servidor web simples com python, claro:<br /><pre>python -m SimpleHTTPServer 8080</pre><br /><br />Deixe rodando e abra um outro terminal. Vamos executar nosso servidor:<br /><pre>python server.py</pre><br /><br />E finalmente, abra o browser usando localhost ou seu ip:<br /><a href="http://localhost:8080/cliente.html">http://localhost:8080/cliente.html</a><br /><br />Observa&#231;&#227;o: como utilizamos um certificado auto-assinado, precisamos dar permiss&#227;o ao browser de abrir a p&#225;gina. Como o websocket apenas usa SSL, abra uma outra janela no browser, mas na porta 8765:<br /><a href="https://localhost:8765/">https://localhost:8765</a><br /><br />Siga o procedimento de seu browser para abriar a p&#225;gina. Normalmente voc&#234; deve clicar em um bot&#227;o dizendo que quer continuar acessando a p&#225;gina. Se tudo der certo, voc&#234; receber&#225; a mensagem:&nbsp;<span>Invalid request. Feche a janela e recarrege o cliente em:</span><br /><a href="http://localhost:8080/cliente.html">http://localhost:8080/cliente.html</a><br /><br />Ele agora deve ter conectado normalmente. Abra outra janela no mesmo endere&#231;o.<br />Digite:<br /><pre>/nome X</pre><br />e depois envie uma mensagem. Ela deve aparecer na outra janela. Voc&#234; deve digitar /nome Nome antes de enviar mensagens. Teste com v&#225;rios clientes, modifique e divirta-se.<br /><br /><div class="separator"><a href="https://3.bp.blogspot.com/-qdTysYJN9JI/WIOzVw4S8iI/AAAAAAAABaU/GzMvlcJq4jAeb1oIdBHijDp6l9BmicAfgCLcB/s1600/browsers.png"><img border="0" height="165" src="https://3.bp.blogspot.com/-qdTysYJN9JI/WIOzVw4S8iI/AAAAAAAABaU/GzMvlcJq4jAeb1oIdBHijDp6l9BmicAfgCLcB/s320/browsers.png" width="320" /></a></div><br /><div class="separator"><a href="https://4.bp.blogspot.com/-ipZfWaoEIGs/WIOzV7QYYbI/AAAAAAAABaY/9RyoEGHeOjIghaRm5o53HliedCH660MlQCLcB/s1600/server.png"><img border="0" height="154" src="https://4.bp.blogspot.com/-ipZfWaoEIGs/WIOzV7QYYbI/AAAAAAAABaY/9RyoEGHeOjIghaRm5o53HliedCH660MlQCLcB/s320/server.png" width="320" /></a></div><br /><br /><br /><br /><br />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://junglecoders.blogspot.com/2017/01/migrando-o-servidor-de-chat-para-python.html">
	    por Unknown (noreply@blogger.com) em
17 de February de 2019 &#224;s 16:34	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>January 10, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://nullonerror.org/"
	   title="NULL on error">
Rodrigo Delduca	</a>
      </h3>


    <div class="entrygroup"
         id="https://nullonerror.org/2019/01/10/empreendendo-sem-dinheiro"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/klkOooYZvrk/">
Empreendendo sem dinheiro	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Criei uma esp&#233;cie de <em>desafio mental</em>, esse desafio consiste em resolver problemas j&#225; enfrentados ou de outras origens de forma criativa, em pouco tempo e se poss&#237;vel evolvendo pouco ou nenhum custo!</p>

<p>E o desafio da semana foi criar um daqueles projetos de <a href="https://www.google.com/search?q=m&#237;dia+indoor&tbm=isch">&#8220;media indoor&#8221;</a>.</p>

<p>Ent&#227;o pensei: &#8220;j&#225; sei vou usar <a href="https://grpc.io/">grpc</a>, <a href="https://rclone.org/">s3 rsync</a>, <a href="https://aws.amazon.com/elastictranscoder/">elastic transcoder</a>, <a href="https://www.fastly.com/">fastly</a>, frontend do admin em <a href="https://reactjs.org">react</a> e &#233; claro <a href="https://kubernetes.io/">kubernetes</a>!&#8221;</p>

<p>J&#225; no cliente, que &#233; respons&#225;vel por tocar os v&#237;deos&#8230;: &#8220;vou escrever em <a href="https://www.qt.io">Qt</a>, criar a interface em <a href="https://en.wikipedia.org/wiki/QML">QML</a>, usar <a href="https://www.boost.org/doc/libs/1_69_0/doc/html/boost_asio.html">boost.asio</a> para o meu downloader e criar uma distribui&#231;&#227;o de Linux embarcado usando o <a href="https://www.yoctoproject.org">yocto</a> !&#8220;.</p>

<blockquote>
  <p><strong>&#8220;The best code is no code at all.&#8221;</strong></p>
</blockquote>

<h3 id="painel-administrativo">Painel administrativo</h3>

<p>As pessoas,  e desse ramo principalmente, est&#227;o acostumadas a usar planilhas para as mais variadas tarefas, ent&#227;o por que n&#227;o usar uma planilha como <em>&#8220;admin&#8221;</em>?</p>

<p><img alt="Google Sheets" class="center" src="https://nullonerror.org/public/2019-01-10-empreendendo-sem-dinheiro/gsheets.jpg" /></p>

<h3 id="envio-armazenamento-transcodifica&#231;&#227;o-e-distribui&#231;&#227;o-de-v&#237;deos">Envio, armazenamento, transcodifica&#231;&#227;o e distribui&#231;&#227;o de v&#237;deos</h3>

<p>Ao inv&#233;s de desenvolver um complexo sistema de gerenciamento de arquivos de v&#237;deo, com transcodifica&#231;&#227;o usando as ferramentas que citei acima, usando <a href="https://aws.amazon.com/lambda/">lambda</a> e outras coisas, vamos usar o YouTube.</p>

<p>Qu&#234;?</p>

<p>&#201; isso mesmo, no nosso prot&#243;tipo vamos usar o YouTube, pois n&#227;o tem nenhum custo e j&#225; faz a convers&#227;o e distribui&#231;&#227;o do v&#237;deo nos mais variados formatos e tamanhos.</p>

<blockquote>
  <p>Aten&#231;&#227;o: De acordo com <a href="https://www.youtube.com/static?template=terms">os termos de uso</a> do YouTube n&#227;o &#233; permitido reproduzir o conte&#250;do da plataforma fora do player do youtube, o que estou demonstrando &#233; apenas para fins educacionais.</p>
</blockquote>

<h3 id="o-nosso-work-&#233;-play&#225;"><a href="https://www.youtube.com/watch?v=EJruqzsvza4">O nosso work &#233; play&#225;</a></h3>

<p>Nada mais do que um pequeno <em>script</em> em bash ser&#225; necess&#225;rio para executar as tarefas de baixar a <em>playlist</em>, os v&#237;deos, a remo&#231;&#227;o de v&#237;deos n&#227;o mais usados entre outras coisas.</p>

<p>J&#225; o <em>player</em> propriamente dito &#233; o <a href="https://elinux.org/Omxplayer">omxplayer</a>, que &#233; capaz de decodificar v&#237;deos usando acelera&#231;&#227;o por hardware; <code class="highlighter-rouge">omxplayer</code> foi escrito especialmente para a <em>GPU</em> do <a href="https://www.raspberrypi.org/">Raspberry Pi</a> e faz uso da API <a href="https://www.khronos.org/openmax/">OpenMAX</a>, &#233; extremamente eficiente.</p>

<p>O trecho abaixo &#233; de um <a href="https://developers.google.com/apps-script/">apps script</a> que transforma a primeira coluna da planilha num array de objetos e serializa a reposta num <em>JSON</em>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">doGet</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">worksheet</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">worksheet</span><span class="p">.</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">sheet</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">sheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="nx">range</span><span class="p">.</span><span class="nx">getValues</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">playlist</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{</span> <span class="na">url</span><span class="p">:</span> <span class="nx">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">};</span> <span class="p">});</span>
    <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">playlist</span><span class="p">:</span> <span class="nx">playlist</span> <span class="p">}))</span>
      <span class="p">.</span><span class="nx">setMimeType</span><span class="p">(</span><span class="nx">ContentService</span><span class="p">.</span><span class="nx">MimeType</span><span class="p">.</span><span class="nx">JSON</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>&#201; poss&#237;vel publicar o script acima num <a href="https://developers.google.com/apps-script/guides/web#deploying_a_script_as_a_web_app">endere&#231;o p&#250;blico e de acesso an&#244;nimo</a>, de modo que seja poss&#237;vel baixar o <em>JSON</em> at&#233; mesmo pelo <em>cURL</em>, e &#233; com essa reposta que iremos usar para saber quais arquivos baixar e gerar a <em>playlist</em>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-sL</span> <span class="s2">"https://script.google.com/macros/s/</span><span class="k">${</span><span class="p">...</span><span class="k">}</span><span class="s2">/exec?sheet=Sheet1"</span> | jq
<span class="o">{</span>
  <span class="s2">"result"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"url"</span>: <span class="s2">"https://www.youtube.com/watch?v=..."</span>
    <span class="o">}</span>,
    ...
  <span class="o">]</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Com uma simples entrada no <code class="highlighter-rouge">cron</code>  &#233; poss&#237;vel criar um agendamento para baixar a playlist de tempos em tempos:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>/30 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> user curl <span class="nt">-sL</span> <span class="s2">"https://script.google.com/macros/s/</span><span class="k">${</span><span class="p">...</span><span class="k">}</span><span class="s2">/exec?sheet=Sheet1"</span> <span class="o">&gt;</span> playlists/1.json
</code></pre></div></div>

<p>A fun&#231;&#227;o <code class="highlighter-rouge">download</code> usa a ferramenta <a href="https://stedolan.github.io/jq/">jq</a> para gerar uma lista de <em>urls</em> a serem baixadas pelo <a href="https://rg3.github.io/youtube-dl/">youtube-dl</a> que por sua vez executa um pequeno <em>script</em> (<code class="highlighter-rouge">--exec</code>) para adicionar o arquivo rec&#233;m baixado para a playlist, tomando cuidado para n&#227;o duplicar:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>download<span class="o">()</span> <span class="o">{</span>
  <span class="nb">cat </span>playlists/<span class="k">*</span>.json | jq <span class="s1">'.[].url'</span> <span class="se">\</span>
    | xargs youtube-dl <span class="nt">--exec</span> <span class="s2">"grep -sqxF '{}' </span><span class="nv">$playlist</span><span class="s2"> || echo '{}' &gt;&gt; </span><span class="nv">$playlist</span><span class="s2">"</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>Alguns par&#226;metros do <code class="highlighter-rouge">youtube-dl</code> foram omitidos pois foram movidos para o arquivo de configura&#231;&#227;o global.</p>
</blockquote>

<p>Com o <a href="http://entrproject.org/">entr</a> &#233; poss&#237;vel monitorar se algum arquivo foi modificado ou mesmo adicionado novos arquivos no diret&#243;rio; se isso acontecer, a fun&#231;&#227;o <code class="highlighter-rouge">download</code> ser&#225; chamada:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>watch<span class="o">()</span> <span class="o">{</span>
  <span class="k">while</span> :<span class="p">;</span> <span class="k">do
    </span><span class="nb">ls</span> <span class="nt">-d</span> playlists/<span class="k">*</span>.json | entr <span class="nt">-d</span> <span class="s2">"</span><span class="nv">$0</span><span class="s2">"</span> download
  <span class="k">done</span>
<span class="o">}</span>
</code></pre></div></div>

<p>De tempos em tempos &#233; necess&#225;rio remover os arquivos antigos e downloads incompletos; a fun&#231;&#227;o <code class="highlighter-rouge">recycle</code> remove todos os arquivos do tipo v&#237;deo modificados pela &#250;ltima vez h&#225; mais de 7 dias e que n&#227;o est&#227;o sendo usados:</p>

<blockquote>
  <p>A raz&#227;o de ser alguns dias depois e n&#227;o imediatamente &#233; de ser male&#225;vel caso tenha sido algum equ&#237;voco.</p>
</blockquote>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>recycle<span class="o">()</span> <span class="o">{</span>
  <span class="nb">declare</span> <span class="nt">-a</span> <span class="nv">args</span><span class="o">=(</span>
    <span class="nt">-mtime</span> +7
    <span class="nt">-type</span> f
  <span class="o">)</span>

  <span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> uri<span class="p">;</span> <span class="k">do
    </span>args+<span class="o">=(</span><span class="nt">-not</span> <span class="nt">-name</span> <span class="s2">"</span><span class="nv">$uri</span><span class="s2">"</span><span class="o">)</span>
  <span class="k">done</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="k">$(</span><span class="nb">cat</span> <span class="nv">$playlist</span><span class="k">)</span><span class="s2">"</span>

  find <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">args</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span> <span class="nt">-exec</span> bash <span class="nt">-c</span> <span class="s2">"file -b --mime-type {} | grep -q ^video/"</span> <span class="se">\;</span> <span class="nt">-delete</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>Todas essas fun&#231;&#245;es podem ser chamadas in&#250;meras vezes sem efeitos indesejados.</p>
</blockquote>

<p>Tocar a playlist &#233; a parte mais f&#225;cil:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>play<span class="o">()</span> <span class="o">{</span>
  setterm <span class="nt">-cursor</span> off

  <span class="nb">export </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="s2">":0.0"</span>

  <span class="k">while</span> :<span class="p">;</span> <span class="k">do
    while </span><span class="nb">read</span> <span class="nt">-r</span> uri<span class="p">;</span> <span class="k">do
      </span>omxplayer <span class="nt">--refresh</span> <span class="nt">--no-osd</span> <span class="nt">--no-keys</span> <span class="s2">"</span><span class="nv">$uri</span><span class="s2">"</span>
      xrefresh <span class="nt">-display</span> :0
    <span class="k">done</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="k">$(</span><span class="nb">cat</span> <span class="nv">$playlist</span><span class="k">)</span><span class="s2">"</span>
  <span class="k">done</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>Gra&#231;as ao <code class="highlighter-rouge">omxplayer</code> o consumo de CPU fica bem baixo, mesmo em 1080@60fps, algo em torno de ~0.5% num Raspberry 3.</p>
</blockquote>

<p>O pr&#243;ximo passo &#233; contabilizar algumas estat&#237;sticas, como o n&#250;mero de vezes que um v&#237;deo foi tocado, se teve alguma interrup&#231;&#227;o por falta de energia ou por problemas t&#233;cnicos, etc.</p>

<p>Para isso uma boa pedida &#233; o <a href="https://papertrailapp.com/">papertrail</a>, com essa ferramenta &#233; poss&#237;vel centralizar todos os logs da m&#225;quina, exportar para o <a href="https://cloud.google.com/bigquery">BigQuery</a> e executar as consultas na mesma planilha que ficam os v&#237;deos.</p>

<p>Ops&#8230; Acho que minha febre por <em>cloud computing</em> voltou :-)</p><div class="feedflare">
<a href="http://feeds.feedburner.com/~ff/NullOnError?a=klkOooYZvrk:1epBz6ARrv8:yIl2AUoC8zA"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=yIl2AUoC8zA" /></a> <a href="http://feeds.feedburner.com/~ff/NullOnError?a=klkOooYZvrk:1epBz6ARrv8:qj6IDK7rITs"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=qj6IDK7rITs" /></a>
</div><img alt="" height="1" src="http://feeds.feedburner.com/~r/NullOnError/~4/klkOooYZvrk" width="1" />Criei uma esp&#233;cie de desafio mental, esse desafio consiste em resolver problemas j&#225; enfrentados ou de outras origens de forma criativa, em pouco tempo e se poss&#237;vel evolvendo pouco ou nenhum custo!      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/klkOooYZvrk/">
	    por Rodrigo Delduca (rodrigodelduca@gmail.com) em
10 de January de 2019 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>January 05, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://blog.luizirber.org/"
	   title="Gabbleblotchits">
Gabbleblotchits	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blog.luizirber.org,2019-01-05:/2019/01/05/rust-2019/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://blog.luizirber.org/2019/01/05/rust-2019/">
Scientific Rust #rust2019	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>The Rust community requested feedback last year for where the language should go
in 2018, and now they are running it again for 2019.
Last year I was too new in Rust to organize a blog post,
but after an year using it I feel more comfortable writing this!</p>
<p>(Check my previous post about <a href="https://blog.luizirber.org/2018/08/23/sourmash-rust/">replacing the C++ core in sourmash with Rust</a> for more details on how I spend my year in Rust).</p>
<h2>What counts as "scientific Rust"?</h2>
<p>Anything that involves doing science using computers counts as
scientific programming. It includes from embedded software
<a href="https://www.youtube.com/watch?v=y5Yd3FC-kh8">running on satellites</a> to climate models
running in supercomputers, from shell scripts running tools in a pipeline to
data analysis using notebooks.</p>
<p>It also makes the discussion harder, because it's too general! But it is very
important to keep in mind, because scientists are not your regular user: they
are highly qualified in their field of expertise, and they are also pushing the
boundaries of what we know (and this might need flexibility in their tools).</p>
<p>In this post I will be focusing more in two areas: array computing (what most
people consider 'scientific programming' to be) and "data structures".</p>
<h3>Array computing</h3>
<p>This one is booming in the last couple of years due to industry interest in data
sciences and deep learning (where they will talk about tensors instead of arrays),
and has its roots in models running in supercomputers (a field where Fortran is
still king!). Data tends to be quite regular (representable with matrices) and 
amenable to parallel processing.</p>
<p>A good example is the SciPy stack in Python, built on top of NumPy and SciPy.
The adoption of the SciPy stack (both in academia and industry) is staggering,
and many <a href="https://github.com/cupy/cupy">alternative implementations</a> try to provide a NumPy-like API to try to
capture its mindshare.</p>
<p>This is the compute-intensive side science (be it CPU or GPU/TPU), and also the kind
of data that pushed CPU evolution and is still very important in defining policy
in scientific computing funding (see countries competing for the largest
supercomputers and measuring performance in floating point operations per second).</p>
<h3>Data structures for efficient data representation</h3>
<p>For data that is not so regular the situation is a bit different. I'll use
bioinformatics as an example: the data we get out of nucleotide sequencers is usually
represented by long strings (of ACGT), and algorithms will do a lot of string processing
(be it building string-overlap graphs for assembly, or searching for substrings
in large collections). This is only one example: there are many analyses that
will work with other types of data, and most of them don't have a
universal data representation as in the array computing case.</p>
<p>This is the memory-intensive science, and it's hard to measure performance in
floating point operations because... most of the time you're not even using
floating point numbers. It also suffers from limited data locality (which is
almost a prerequisite for compute-intensive performance).</p>
<h2>High performance core, interactive API</h2>
<p>There is something common in both cases: while performance-intensive
code is implemented in C/C++/Fortran, users usually interact with the API from
other languages (especially Python or R) because it's faster to iterate and
explore the data, and many of the tools already available in these languages are
very helpful for these tasks (think Jupyter/pandas or RStudio/tidyverse).
These languages are used to define the computation, but it is a lower-level core
library that drives it (NumPy or Tensorflow follow this idea, for example).</p>
<h2>How to make Rust better for science?</h2>
<p>The biggest barrier to learning Rust is the ownership model, and while we can
agree it is an important feature it is also quite daunting for newcomers,
especially if they don't have previous programming experience and exposure to
what bugs are being prevented. I don't see it being the first language we teach
to scientists any time soon, because the majority of scientists are not system
programmers, and have very different expectations for a programming language.
That doesn't mean that they can't benefit from Rust!</p>
<p>Rust is already great for building the performance-intensive parts,
and thanks to Cargo it is also a better alternative for sharing this code around,
since they tend to get 'stuck' inside Python or R packages.
And the 'easy' approach of vendoring C/C++ instead of having packages make it
hard to keep track of changes and doesn't encourage reusable code.</p>
<p>And, of course, if this code is Rust instead of C/C++ it also means that Rust
users can use them directly, without depending on the other languages. Seems
like a good way to bootstrap a scientific community in Rust =]</p>
<h2>What I would like to see in 2019?</h2>
<h3>An attribute proc-macro like <code>#[wasm_bindgen]</code> but for FFI</h3>
<p>While FFI is an integral part of Rust goals (interoperability with C/C++), I
have serious envy of the structure and tooling developed for WebAssembly! (Even
more now that it works in stable too)</p>
<p>We already have <code>#[no_mangle]</code> and <code>pub extern "C"</code>, but they are quite
low-level. I would love to see something closer to what wasm-bindgen does,
and define some traits (like <a href="https://rustwasm.github.io/wasm-bindgen/api/wasm_bindgen/convert/trait.IntoWasmAbi.html"><code>IntoWasmAbi</code></a>) to make it easier to
pass more complex data types through the FFI.</p>
<p>I know it's not that simple, and there are different design restrictions than
WebAssembly to take into account... The point here is not having the perfect
solution for all use cases, but something that serves as an entry point and helps
to deal with the complexity while you're still figuring out all the quirks and
traps of FFI. You can still fallback and have more control using the lower-level
options when the need rises.</p>
<h3>More -sys and Rust-like crates for interoperability with the larger ecosystems</h3>
<p>There are new projects bringing more interoperability to <a href="https://arrow.apache.org/">dataframes</a> and <a href="https://xnd.io/">tensors</a>.
While this ship has already sailed and they are implemented in C/C++,
it would be great to be a first-class citizen,
and not reinvent the wheel.
(Note: the arrow project already have pretty good Rust support!)</p>
<p>In my own corner (bioinformatics), the <a href="https://github.com/rust-bio">Rust-bio community</a> is doing a
great job of wrapping <a href="https://github.com/rust-bio/rust-htslib">useful libraries in C/C++</a> and exposing them to
Rust (and also a shout-out to 10X Genomics for doing this work for
<a href="https://github.com/10XGenomics/rust-bwa">other tools</a> while also contributing to Rust-bio!).</p>
<h3>More (bioinformatics) tools using Rust!</h3>
<p>We already have great examples like <a href="https://github.com/onecodex/finch-rs">finch</a> and <a href="https://github.com/natir/yacrd">yacrd</a>,
since Rust is great for single binary distribution of programs.
And with bioinformatics focusing so much in independent tools chained together in workflows,
I think we can start convincing people to try it out =]</p>
<h3>A place to find other scientists?</h3>
<p>Another idea is to draw inspiration from <a href="https://ropensci.org/about/">rOpenSci</a> and have a Rust equivalent,
where people can get feedback about their projects and how to better integrate it with other crates.
This is quite close to the working group idea,
but I think it would serve more as a gateway to other groups,
more focused on developing entry-level docs and bringing more scientists to the
community.</p>
<h2>Final words</h2>
<p>In the end, I feel like this post ended up turning into my 'wishful TODO list'
for 2019, but I would love to find more people sharing these goals (or willing
to take any of this and just run with it, I do have a PhD to finish! =P)</p>
<h2>Comments?</h2>
<ul>
<li><a href="https://social.lasanha.org/@luizirber/101367104235280253">Thread on Mastodon</a></li>
<li><a href="https://twitter.com/luizirber/status/1081729107170193408">Thread on Twitter</a></li>
</ul>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://blog.luizirber.org/2019/01/05/rust-2019/">
	    por luizirber em
05 de January de 2019 &#224;s 19:00	</a>
      </p>
    </div>
  </div>



        </div>
      <div class="channelgroup">

      <h3>
        <a href="http://blog.filipesaraiva.info"
	   title="planeta-python-brasil &#8211; Filipe Saraiva's blog">
Filipe Saraiva	</a>
      </h3>


    <div class="entrygroup"
         id="http://blog.filipesaraiva.info/?p=2050"
	   lang="pt-BR"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://blog.filipesaraiva.info/?p=2050">
LaKademy 2018	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Em outubro de 2018, <a href="https://pt.wikipedia.org/wiki/Florian%C3%B3polis" rel="noopener" target="_blank">Florian&#243;polis</a> foi sede da sexta edi&#231;&#227;o do <a href="https://lakademy.kde.org/" rel="noopener" target="_blank">LaKademy</a>, o sprint latinoamericano do KDE. Esse momento &#233; uma oportunidade para termos em um mesmo lugar v&#225;rios desenvolvedores do KDE &#8211; tanto veteranos quanto novatos &#8211; de diferentes projetos para melhorarem os respectivos softwares em que trabalham e tamb&#233;m planejar as a&#231;&#245;es de promo&#231;&#227;o da comunidade para o subcontinente.</p>
<p>Na parte t&#233;cnica, eu trabalhei com Cantor, Sprat, e nos sites do KDE Brasil e LaKademy.</p>
<p>Para o <a href="https://edu.kde.org/cantor" rel="noopener" target="_blank">Cantor</a>, eu pesquisei algumas novas maneiras de implementar os backends, em especial quanto a utiliza&#231;&#227;o de websockets. Essa &#233; uma ideia antiga que tenta encontrar uma abordagem a ser recomendada para implementa&#231;&#227;o desses backends de forma que possam ser utilizados para qualquer linguagem de programa&#231;&#227;o e funcionem em qualquer plataforma. Entretanto, como nas tentativas anteriores, ainda tenho d&#250;vidas se essa &#233; uma maneira interessante e se os objetivos podem ser atingidos por ela. Enfim, &#233; algo que precisa de mais pesquisa.</p>
<p>Sprat &#233; um editor de texto direcionado para a escrita de artigos cient&#237;ficos. O software implementa a metodologia <a href="https://arxiv.org/abs/cs/0611013" rel="noopener" target="_blank">Amadeus</a> para escrita de artigos, e &#233; mais como uma cole&#231;&#227;o de senten&#231;as comuns que podem ser utilizadas in se&#231;&#245;es espec&#237;ficas do artigo. Sprat &#233; meu projeto-pet, e espero lan&#231;ar esse ano al&#233;m de transform&#225;-lo em um projeto do KDE.</p>
<p>O site do <a href="https://br.kde.org/" rel="noopener" target="_blank">KDE Brasil</a> uma uma antiga vers&#227;o do Drupal. Eu e Fred pesquisamos alguns plugins para importar o conte&#250;do desse site para o WordPress, e atualmente estamos estudando como realizar essa tarefa.</p>
<p>Por &#250;ltimo, portei o site do <a href="https://lakademy.kde.org/" rel="noopener" target="_blank">LaKademy</a> para Jekyll. Isso &#233; algo que ainda precisa de algum trabalho, e espero lan&#231;&#225;-lo o quanto antes.</p>
<p>Na parte social, discutimos algumas atividades para o KDE nesse ano, como voltar a participar do <a href="http://fisl.softwarelivre.org/" rel="noopener" target="_blank">FISL</a> e <a href="http://latinoware.org/" rel="noopener" target="_blank">Latinoware</a>, tentar comparecer a outros eventos na Am&#233;rica Latina (<a href="https://debconf19.debconf.org/" rel="noopener" target="_blank">DebConf</a> e <a href="http://www.cubaconf.org/" rel="noopener" target="_blank">Cubaconf</a>, estamos olhando pra voc&#234;s), organizar o &#8220;Caf&#233; com Qt&#8221; (nosso evento distribu&#237;do sobre Qt e KDE), feedbacks sobre o gerenciamento do nosso <a href="https://t.me/kdebrasil" rel="noopener" target="_blank">grupo do KDE Brasil no Telegram</a>, nossos novos materiais promocionais para serem produzidos e distribu&#237;dos nos eventos daqui, e mais.</p>
<p>Ainda nesse aspecto, tamb&#233;m ajudei os novatos no trabalho de revis&#227;o de c&#243;digo do KDE e tirando d&#250;vidas sobre Qt.</p>
<p>LaKademy &#233; uma grande oportunidade para encontrar outros desenvolvedores do KDE e trabalharmos juntos para aumentar nossa comunidade. Nos &#250;ltimos anos, o KDE assumiu um papel de import&#226;ncia na comunidade brasileira, e estamos planejando expandi-la para diferentes pa&#237;ses. Esperamos organizar o pr&#243;ximo LaKademy em algum outro pa&#237;s fora do Brasil, e trabalharemos forte para expandir a comunidade no subcontinente.</p>
<p><a href="http://blog.filipesaraiva.info/?attachment_id=2046" rel="attachment wp-att-2046"><img alt="" class="aligncenter wp-image-2046" height="350" src="http://blog.filipesaraiva.info/wp-content/uploads/2019/01/LaKademy2018-Oficial-DSC04821.jpg" width="638" /></a><em>Foto em grupo do LaKademy 2018</em></p>
Nos vemos no LaKademy 2019!      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://blog.filipesaraiva.info/?p=2050">
	    por Filipe Saraiva em
05 de January de 2019 &#224;s 17:43	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>January 02, 2019</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://paulohrpinheiro.xyz"
	   title="Paulo Henrique Rodrigues Pinheiro">
Blog do PauloHRPinheiro	</a>
      </h3>


    <div class="entrygroup"
         id="https://paulohrpinheiro.xyz/texts/python/2019-01-02-feature-toggles-com-django-waffle.html"
	   lang="pt-br"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://paulohrpinheiro.xyz/texts/python/2019-01-02-feature-toggles-com-django-waffle.html">
Feature toggles com django-waffle	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Feature toggles: ativando e desativando comportamentos em um sistema sem alterar o c&#243;digo, usando django-waffle.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://paulohrpinheiro.xyz/texts/python/2019-01-02-feature-toggles-com-django-waffle.html">
02 de January de 2019 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>December 27, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://nullonerror.org/"
	   title="NULL on error">
Rodrigo Delduca	</a>
      </h3>


    <div class="entrygroup"
         id="https://nullonerror.org/2018/12/27/blobs-blurbs-bubbles"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/qG9zGvWtETw/">
Blobs, blurbs, bubbles&#8230;	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<blockquote>
  <p>TL;DR Usar o SQLite ao inv&#233;s do sistema de arquivos para armazenar em forma de blob os assets do jogo pode ser uma &#243;tima ideia.</p>
</blockquote>

<p>Dia desses estava lendo <a href="https://www.sqlite.org/appfileformat.html">SQLite As An Application File Format</a> o que me fez lembrar de quando eu lia muito a respeito de desenvolvimento de jogos, at&#233; cheguei a desenvolver um framework chamado <a href="http://wintermoon.sourceforge.net/">Wintermoon</a>, no meu framework eu usei o <a href="https://icculus.org/physfs/">PhysicsFS</a> foi quando descobri o <a href="http://www.zezula.net/en/mpq/main.html">MPQ</a> e fiquei encantado.</p>

<h2 id="mopaq">Mo&#8217;PaQ</h2>
<p>O MPQ &#233; (ou era) amplamente utilizado em praticamente todos os jogos da Blizzard, desde o Diablo (1997) at&#233; o StarCraft 2 (2010). Inclusive o StarCraft 2 recebe atualiza&#231;&#245;es at&#233; hoje, e quase que mensalmente desde seu lan&#231;amento! Digo isto para dar um contexto de onde quero chegar.</p>

<p>O MPQ leva o nome de seu criador, e surgiu devido h&#225; alguns requerimentos da &#233;poca, como seguran&#231;a, acesso r&#225;pido, compress&#227;o, expansibilidade e multi-linguagem.</p>

<p>Atualmente alguns requerimentos mencionados n&#227;o fazem muito sentido, por&#233;m estamos falando de uma &#233;poca onde o principal sistema de arquivos onde esses t&#237;tulos rodavam era o <a href="https://en.wikipedia.org/wiki/FAT32">FAT32</a>.</p>

<h3 id="physicsfs">PhysicsFS</h3>

<p>Sempre gostei da ideia de empacotar os <code class="highlighter-rouge">assets</code> do jogo num &#250;nico arquivo comprimido. O <a href="https://icculus.org/physfs/">PhysicsFS</a> permite &#8220;montar&#8221; diret&#243;rios e arquivos comprimidos como se fossem um &#250;nico diret&#243;rio, com todos os arquivos estruturados dentro dos seus respectivos diret&#243;rios; algo semelhante ao que o <a href="http://unionfs.filesystems.org/">UnionFS</a>, <a href="https://www.kernel.org/doc/Documentation/filesystems/overlayfs.txt">OverlayFS</a> e similares fazem.</p>

<p>Outra vantagem &#233; a <em>seguran&#231;a</em>, pois o processo fica restrito &#224; aquele(s) diret&#243;rio(s) previamente <em>especificado(s)</em>.</p>

<p>Usar o <code class="highlighter-rouge">physfs</code> com a <a href="https://www.libsdl.org/">SDL</a> &#233; bem simples, veja como &#233; o processo de montar um arquivo comprimido e carregar uma imagem:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
  <span class="n">PHYSFS_init</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

  <span class="n">SDL_Init</span><span class="p">(</span><span class="n">SDL_INIT_VIDEO</span><span class="p">);</span>

  <span class="c1">// monta o arquivo `assets.7z` como se fosse um diret&#243;rio.
</span>  <span class="n">PHYSFS_mount</span><span class="p">(</span><span class="s">"assets.7z"</span><span class="p">,</span> <span class="s">"/"</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="n">SDL_Window</span> <span class="o">*</span> <span class="n">window</span> <span class="o">=</span> <span class="n">SDL_CreateWindow</span><span class="p">(</span>
    <span class="nb">NULL</span><span class="p">,</span> <span class="n">SDL_WINDOWPOS_UNDEFINED</span><span class="p">,</span> <span class="n">SDL_WINDOWPOS_UNDEFINED</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="n">SDL_WINDOW_OPENGL</span> <span class="o">|</span> <span class="n">SDL_WINDOW_ALLOW_HIGHDPI</span><span class="p">);</span>

  <span class="n">SDL_Renderer</span> <span class="o">*</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">SDL_CreateRenderer</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">SDL_RENDERER_ACCELERATED</span><span class="p">);</span>

  <span class="c1">// carrega o arquivo `texture001.tga` que est&#225; dentro de `assets.7z`.
</span>  <span class="n">SDL_RWops</span> <span class="o">*</span> <span class="n">rwops</span> <span class="o">=</span> <span class="n">PHYSFSRWOPS_openRead</span><span class="p">(</span><span class="s">"texture001.tga"</span><span class="p">);</span>

  <span class="c1">// carrega a textura.
</span>  <span class="n">SDL_Surface</span> <span class="o">*</span> <span class="n">surface</span> <span class="o">=</span> <span class="n">IMG_Load_RW</span><span class="p">(</span><span class="n">rwops</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="n">SDL_Texture</span> <span class="o">*</span> <span class="n">texture</span> <span class="o">=</span> <span class="n">SDL_CreateTextureFromSurface</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">surface</span><span class="p">);</span>
  <span class="n">SDL_FreeSurface</span><span class="p">(</span><span class="n">surface</span><span class="p">);</span>

  <span class="n">SDL_bool</span> <span class="n">running</span> <span class="o">=</span> <span class="n">SDL_TRUE</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">SDL_Event</span> <span class="n">event</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">SDL_PollEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">event</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">SDL_QUIT</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">running</span> <span class="o">=</span> <span class="n">SDL_FALSE</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// desenha a textura na janela.
</span>    <span class="n">SDL_RenderCopy</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">texture</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">SDL_RenderPresent</span><span class="p">(</span><span class="n">renderer</span><span class="p">);</span>
    <span class="n">SDL_Delay</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="mi">60</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">SDL_DestroyWindow</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
  <span class="n">SDL_Quit</span><span class="p">();</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Legal n&#233;?</p>

<h3 id="little-bobby-tables"><a href="https://xkcd.com/327/">Little Bobby Tables</a></h3>

<p>O <a href="https://www.sqlite.org/index.html">SQLite</a> &#233; provavelmente um dos componentes de software mais utilizados no mundo, est&#225; presente em todo o lugar; se estiver lendo esse texto num Android deve ter pelo menos umas 3 c&#243;pias dele na suas m&#227;os! SQLite &#233; como um <code class="highlighter-rouge">fopen(3)</code> com esteroides.</p>

<p>Lendo o texto que menciono no inicio do texto, penso <em>&#8220;E se eu usar SQLite no lugar do PhysicsFS?&#8221;</em></p>

<h5 id="dba-wanna-be">DBA wanna be&#8230;</h5>

<p>Embora o SQLite possua uma forma pr&#225;tica de ser fazer o que farei a seguir, o <a href="https://www.sqlite.org/sqlar.html">SQLite Archive Files</a>, irei apresentar o passo a passo.</p>

<p>Primeiro vamos criar uma tabela com dois campos, um deles para indentifica&#231;&#227;o e o outro com o conte&#250;do binario em si.</p>

<blockquote>
  <p>O SQLite (e a grande maioria dos bancos de dados) n&#227;o suportam armazenar dados bin&#225;rios, para isso existe um tipo de dados especial chamado <em>BLOB (Binary Large OBject)</em>.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite3 assets.db <span class="s2">"CREATE TABLE IF NOT EXISTS assets (key TEXT PRIMARY KEY, blob BLOB);"</span>
</code></pre></div></div>

<p>E &#233; isso. O campo <code class="highlighter-rouge">key</code> &#233; uma chave primaria e portanto tem um &#237;ndice pr&#243;prio, como sei?</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3 assets.db
SQLite version 3.24.0 2018-06-04 14:10:15
Enter <span class="s2">".help"</span> <span class="k">for </span>usage hints.
sqlite&gt; .schema assets
CREATE TABLE assets <span class="o">(</span>key TEXT PRIMARY KEY, blob BLOB<span class="o">)</span><span class="p">;</span>
sqlite&gt; .indexes assets
sqlite_autoindex_assets_1
</code></pre></div></div>

<p>O pr&#243;ximo passo &#233; inserir o arquivo da textura <code class="highlighter-rouge">texture001.tga</code> que ser&#225; usada:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite3 assets.db <span class="s2">"INSERT INTO assets(key, blob) VALUES ('texture001', readfile('texture001.tga'));"</span>
</code></pre></div></div>

<p>O SQLite tem uma fun&#231;&#227;o <code class="highlighter-rouge">readfile</code> que carrega o arquivo diretamente.</p>

<p>&#201; poss&#237;vel verificar o tamanho do blob com a fun&#231;&#227;o <code class="highlighter-rouge">length</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3 assets.db
SQLite version 3.24.0 2018-06-04 14:10:15
Enter <span class="s2">".help"</span> <span class="k">for </span>usage hints.
sqlite&gt; <span class="k">select </span>key, length<span class="o">(</span>blob<span class="o">)</span> from assets<span class="p">;</span>
texture001|3686418
</code></pre></div></div>

<p>Que &#233; exatamente o mesmo do arquivo original:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>stat <span class="nt">-f</span>%z texture001.tga
3686418
</code></pre></div></div>

<p>Adaptando o exemplo acima para a API em C do SQLite temos:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sqlite3</span> <span class="o">*</span> <span class="n">db</span><span class="p">;</span>
<span class="c1">// abre o arquivo do banco de dados do sqlite.
</span><span class="n">sqlite3_open</span><span class="p">(</span><span class="s">"assets.db"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">db</span><span class="p">);</span>
<span class="c1">// ...
</span>
<span class="c1">// preparamos a query.
</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT blob FROM assets WHERE key = ?"</span><span class="p">;</span>
<span class="n">sqlite3_stmt</span> <span class="o">*</span> <span class="n">stmt</span><span class="p">;</span>
<span class="n">sqlite3_prepare_v2</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">stmt</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="c1">// "atrela" o valor `texture001` no primeiro par&#226;metro do sql, o `?`.
</span><span class="n">sqlite3_bind_text</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"texture001"</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">SQLITE_STATIC</span><span class="p">);</span>

<span class="c1">// executa a query "SELECT blob FROM assets WHERE key = 'texture001'".
</span><span class="n">sqlite3_step</span><span class="p">(</span><span class="n">stmt</span><span class="p">);</span>

<span class="c1">// criamos um `SDL_RWops` com os bytes do blob.
</span><span class="kt">int</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">sqlite3_column_bytes</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">buffer</span> <span class="o">=</span> <span class="n">sqlite3_column_blob</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">SDL_RWops</span> <span class="o">*</span> <span class="n">rwops</span> <span class="o">=</span> <span class="n">SDL_RWFromConstMem</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="n">bytes</span><span class="p">));</span>

<span class="c1">// finaliza (respons&#225;vel por liberar a mem&#243;ria retornada por sqlite3_column_blob e outros recursos.)
</span><span class="n">sqlite3_reset</span><span class="p">(</span><span class="n">stmt</span><span class="p">);</span>

<span class="c1">// (como anteriormente) carrega a textura.
</span><span class="n">SDL_Surface</span> <span class="o">*</span> <span class="n">surface</span> <span class="o">=</span> <span class="n">IMG_Load_RW</span><span class="p">(</span><span class="n">rwops</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">SDL_Texture</span> <span class="o">*</span> <span class="n">texture</span> <span class="o">=</span> <span class="n">SDL_CreateTextureFromSurface</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">surface</span><span class="p">);</span>
<span class="n">SDL_FreeSurface</span><span class="p">(</span><span class="n">surface</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="benchmarks-&#233;-disso-que-o-povo-gosta">Benchmarks, &#233; disso que o povo gosta!</h2>
<p>Usando a fun&#231;&#227;o <a href="https://wiki.libsdl.org/SDL_GetPerformanceFrequency">SDL_GetPerformanceFrequency</a> para mensurar o trecho respons&#225;vel apenas por carregar a textura obtive os seguintes resultados:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file texture001.tga
texture001.tga: Targa image data - RGB 1280 x 960 x 24
<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lh</span> texture001.tga | awk <span class="s1">'{print $5}'</span>
3.5M
</code></pre></div></div>

<h5 id="physicsfs-gzip-compressed">PhysicsFS (gzip compressed)</h5>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span> ./physfs<span class="p">;</span> <span class="k">done
</span>42.060247
40.972251
38.589466
40.684438
43.327696
38.578994
...
</code></pre></div></div>

<h5 id="sqlite">SQLite</h5>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span> ./sqlite<span class="p">;</span> <span class="k">done
</span>27.433850
30.553595
27.706754
27.282197
27.561867
27.853982
...
</code></pre></div></div>

<h5 id="img_loadtexture001tga-aka-diretamente"><code class="highlighter-rouge">IMG_Load("texture001.tga")</code> (A.K.A. diretamente)</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span> ./a.out<span class="p">;</span> <span class="k">done
</span>22.792655
23.667172
22.286974
23.551452
22.094010
23.657177
...
</code></pre></div></div>

<blockquote>
  <p>Acredito que se utilizado compress&#227;o no SQLite o uso de disco seria reduzido e como consequ&#234;ncia resultados ainda melhores.</p>
</blockquote>

<h2 id="patches-everywhere">Patches everywhere!</h2>

<p><img alt="metalhead with lots of patches" class="center" src="https://nullonerror.org/public/2018-12-27-blobs-blurbs-bubbles/patches.jpg" /></p>

<p>Uma das principais caracter&#237;sticas do software &#233; que ele n&#227;o funciona e precisa constantemente ser remendado, e nos jogos n&#227;o &#233; diferente.</p>

<p>O MPQ tem um mecanismo de patches, como na &#233;poca a maioria dos jogos eram distribu&#237;das em m&#237;dias somente leitura, como o CD-ROM, era preciso uma outra abordagem, j&#225; que n&#227;o era poss&#237;vel reescrever o <code class="highlighter-rouge">.mpq</code> original, portanto era criado uma esp&#233;cie de corrente, ent&#227;o ap&#243;s o jogo carregar, as altera&#231;&#245;es eram aplicadas em cima, na mesma sequencia de que foram publicadas.</p>

<p>A ideia por tr&#225;s de usar o SQLite no lugar do PhysicsFS &#233; de aproveitar algumas caracter&#237;sticas de um banco de dados, que &#233; de&#8230; criar, atualizar, modificar e deletar de forma at&#244;mica!</p>

<blockquote>
  <p>O arquivo de update do jogo poderia ser um conjunto de instru&#231;&#245;es SQL.</p>
</blockquote>

<p>Vamos desconsiderar o bin&#225;rio do jogo por hora, e vamos supor que uma nova textura foi adicionada no banco de dados do desenvolvedor, e por algum motivo desconhecido ele &#233; pregui&#231;oso e usou a ferramenta <code class="highlighter-rouge">sqldiff</code> para gerar o patch e n&#227;o <a href="https://en.wikipedia.org/wiki/Schema_migration">schema migration</a>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite3 assets.db "INSERT INTO assets(key, blob) VALUES ('texture002', readfile('texture002.jpg'));"
</code></pre></div></div>

<blockquote>
  <p>Estou usando texturas como exemplo pois geralmente &#233; o tipo de arquivo que ocupa mais espa&#231;o em disco dos jogos. O exemplo vale para qualquer tipo de arquivo&#8230; seja textos, scripts, shaders, etc.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sqldiff old.db assets.db &gt; patch01.sql
$ # checando o conte&#250;do da atualiza&#231;&#227;o.
$ head -c 100 up.sql
INSERT INTO assets(rowid,"key", blob) VALUES(2,'texture002',x'ffd8ffe000104a46494600010100000100010%
$ ls -lh patch01.sql | awk '{print $5}'
663K
$ tar -cvzf patch01.tgz patch01.sql
$ ls -lh patch01.tgz | awk '{print $5}'
363K
</code></pre></div></div>

<blockquote>
  <p>Como se trata de um arquivo <code class="highlighter-rouge">.jpeg</code> representado em hexadecimal dentro de um <code class="highlighter-rouge">.sql</code> os ganhos com compress&#227;o s&#227;o pequenos.</p>
</blockquote>

<p>Agora basta a nossa ferramenta respons&#225;vel por atualizar o jogo aplicar os patches na mesma sequencia que foram gerados.</p>

<p>Essa &#233; uma forma bem simples e descomplicada de atualizar o jogo e &#233; algo bem resolvido no mundo dos banco de dados h&#225; d&#233;cadas.</p>

<p>&#201; poss&#237;vel criar updates ainda menores, o Google Chrome tem um projeto chamado <a href="http://dev.chromium.org/developers/design-documents/software-updates-courgette">courgette</a> que usa a ferramenta <code class="highlighter-rouge">bsdiff</code> combinada com um outro algoritmo descrito no link, podemos usar o <a href="http://www.daemonology.net/bsdiff/">bsdiff</a> para gerar o patch do asset a ser atualizado e no cliente usar o <code class="highlighter-rouge">bspatch</code> para aplicar a modifica&#231;&#227;o.</p>

<p>Al&#233;m de todas essas vantagens, o uso do SQLite ainda possibilita o <a href="https://en.wikipedia.org/wiki/Data-driven_programming">data-driven programming</a>.</p>

<h2 id="winterphobos">Winterphobos</h2>

<p>Pretendo utilizar o SQLite como descrito num novo projeto chamado <a href="https://github.com/skhaz/winterphobos">Winterphobos</a>, um motor de jogos minimalista, e uma das premissas &#233; ser totalmente <em>&#8220;script&#225;vel&#8221;</em> em <a href="https://www.lua.org/">lua</a> com <a href="https://en.wikipedia.org/wiki/entity-component-system">entity&#8211;component&#8211;system
</a>.</p>

<p><img alt="vault boy" class="center" src="https://nullonerror.org/public/2018-12-27-blobs-blurbs-bubbles/vaultboy.jpg" /></p><div class="feedflare">
<a href="http://feeds.feedburner.com/~ff/NullOnError?a=qG9zGvWtETw:pDDfNA2QdaM:yIl2AUoC8zA"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=yIl2AUoC8zA" /></a> <a href="http://feeds.feedburner.com/~ff/NullOnError?a=qG9zGvWtETw:pDDfNA2QdaM:qj6IDK7rITs"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=qj6IDK7rITs" /></a>
</div><img alt="" height="1" src="http://feeds.feedburner.com/~r/NullOnError/~4/qG9zGvWtETw" width="1" />TL;DR Usar o SQLite ao inv&#233;s do sistema de arquivos para armazenar em forma de blob os assets do jogo pode ser uma &#243;tima ideia.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/qG9zGvWtETw/">
	    por Rodrigo Delduca (rodrigodelduca@gmail.com) em
27 de December de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>November 29, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://pythonclub.com.br/"
	   title="PythonClub">
PythonClub	</a>
      </h3>


    <div class="entrygroup"
         id="tag:pythonclub.com.br,2018-11-29:/algoritmos-ordenacao.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://pythonclub.com.br/algoritmos-ordenacao.html">
Algoritmos de Ordena&#231;&#227;o	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Fala pessoal, tudo bom?</p>
<p>Nos v&#237;deos abaixo, vamos aprender como implementar alguns dos algoritmos de ordena&#231;&#227;o usando Python.</p>
<div class="section" id="bubble-sort">
<h2>Bubble Sort</h2>
<p>Como o algoritmo funciona: Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=Doy64STkwlI&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r&t=0s&index=3">https://www.youtube.com/watch?v=Doy64STkwlI</a>.</p>
<div class="youtube youtube-16x9"></div><p>Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=B0DFF0fE4rk&index=3&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r">https://www.youtube.com/watch?v=B0DFF0fE4rk</a>.</p>
<div class="youtube youtube-16x9"></div><p>C&#243;digo do algoritmo</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">final</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">exchanging</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">for</span> <span class="n">current</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">array</span><span class="p">[</span><span class="n">current</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">array</span><span class="p">[</span><span class="n">current</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">current</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">current</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">exchanging</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">exchanging</span><span class="p">:</span>
            <span class="k">break</span>
</pre></div>
</div>
<div class="section" id="selection-sort">
<h2>Selection Sort</h2>
<p>Como o algoritmo funciona: Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=vHxtP9BC-AA&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r&index=4">https://www.youtube.com/watch?v=vHxtP9BC-AA</a>.</p>
<div class="youtube youtube-16x9"></div><p>Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=0ORfCwwhF_I&index=5&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r&index=5">https://www.youtube.com/watch?v=0ORfCwwhF_I</a>.</p>
<div class="youtube youtube-16x9"></div><p>C&#243;digo do algoritmo</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="n">min_index</span> <span class="o">=</span> <span class="n">index</span>

        <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">array</span><span class="p">[</span><span class="n">min_index</span><span class="p">]:</span>
                <span class="n">min_index</span> <span class="o">=</span> <span class="n">right</span>

        <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">min_index</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="insertion-sort">
<h2>Insertion Sort</h2>
<p>Como o algoritmo funciona: Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=O_E-Lj5HuRU&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r&t=0s&index=6">https://www.youtube.com/watch?v=O_E-Lj5HuRU</a>.</p>
<div class="youtube youtube-16x9"></div><p>Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=Sy_Z1pqMgko&index=7&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r">https://www.youtube.com/watch?v=Sy_Z1pqMgko</a>.</p>
<div class="youtube youtube-16x9"></div><p>C&#243;digo do algoritmo</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
        <span class="n">current_element</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">current_element</span><span class="p">:</span>
            <span class="n">array</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">p</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="n">array</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_element</span>
</pre></div>
</div>
<div class="section" id="merge-sort">
<h2>Merge Sort</h2>
<p>Como o algoritmo funciona: Como implementar o algoritmo usando Python: <a class="reference external" href="https://www.youtube.com/watch?v=Lnww0ibU0XM&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r&t=0s&index=8">https://www.youtube.com/watch?v=Lnww0ibU0XM</a>.</p>
<div class="youtube youtube-16x9"></div><p>Como implementar o algoritmo usando Python - Parte I: <a class="reference external" href="https://www.youtube.com/watch?v=cXJHETlYyVk&index=9&list=PLvo_Yb_myrNBhIdq8qqtNSDFtnBfsKL2r">https://www.youtube.com/watch?v=cXJHETlYyVk</a>.</p>
<div class="youtube youtube-16x9"></div><p>C&#243;digo do algoritmo</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="n">sort_half</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sort_half</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">middle</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="n">sort_half</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">middle</span><span class="p">)</span>
    <span class="n">sort_half</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="n">merge</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="n">array</span><span class="p">[</span><span class="n">start</span><span class="p">:</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">start</span><span class="p">:</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://pythonclub.com.br/algoritmos-ordenacao.html">
	    por Lucas Magnum em
29 de November de 2018 &#224;s 15:10	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>November 22, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://paulohrpinheiro.xyz"
	   title="Paulo Henrique Rodrigues Pinheiro">
Blog do PauloHRPinheiro	</a>
      </h3>


    <div class="entrygroup"
         id="https://paulohrpinheiro.xyz/texts/python/2018-11-22-teste-de-carga-e-desempenho.html"
	   lang="pt-br"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-11-22-teste-de-carga-e-desempenho.html">
Teste de carga e desempenho	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Testando a capacidade e desempenho de uma API com o framework Locust, em Python      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-11-22-teste-de-carga-e-desempenho.html">
22 de November de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>October 21, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/a-arte-de-reescrever-software/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/rrkrbX-wHwg/">
A arte de reescrever software	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Lidar com software legado hoje em dia &#233; mais comum do que podemos imaginar, costumo dizer que muitos softwares nascem legado, como assim? Para mim software que n&#227;o tem teste automatizado &#233; legado, n&#227;o tem como garantir funcionamento de absolutamente nada dentro dele e muitos comportamentos (recursos ou bugs) s&#243; ir&#225; aparecer com usu&#225;rios usando constantemente.
Ap&#243;s alinhamento do que &#233; software legado &#233; comum a empresa (principalmente as com cultura de startup) e desenvolvedores ter que trocar pe&#231;as do software em pleno o voo, n&#227;o temos como pousar o avi&#227;o para fazer manuten&#231;&#227;o e depois decolar novamente quando a empresa est&#225; com clientes usando o software em produ&#231;&#227;o.<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/rrkrbX-wHwg" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/rrkrbX-wHwg/">
21 de October de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>October 06, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://pythonclub.com.br/"
	   title="PythonClub">
PythonClub	</a>
      </h3>


    <div class="entrygroup"
         id="tag:pythonclub.com.br,2018-10-06:/trabalhando-com-operadores-ternarios.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://pythonclub.com.br/trabalhando-com-operadores-ternarios.html">
Trabalhando com operadores tern&#225;rios	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Quando estamos escrevendo um c&#243;digo qualquer, possivelmente 
a express&#227;o que mais utilizamos &#233; o <code>if</code>. Para qualquer 
tarefas que buscamos automatizar ou problemas que buscamos 
resolver, sempre acabamos caindo em l&#243;gicas como "Se isso 
acontecer, ent&#227;o fa&#231;a aquilo, sen&#227;o fa&#231;a aquele outro...".</p>
<p>Quando estamos falando de a&#231;&#245;es a serem executadas, pessoalmente
gosto da forma com que o c&#243;digo fica organizado em python quando
usamos este tipo de condi&#231;&#245;es, por exemplo:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">vencer_o_thanos</span><span class="p">:</span>
    <span class="n">restaurar_a_paz</span><span class="p">()</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">()</span>
</pre></div>


<p>Gra&#231;as a indenta&#231;&#227;o e ao espa&#231;amento, vemos onde onde come&#231;a e/ou 
termina o bloco  executado caso a var&#225;vel <code>vencer_o_thanos</code> seja 
<code>True</code>. Quanto mais <code>if</code>'s voc&#234; aninhar, mais bonito seu 
c&#243;digo fica e em momento algum o mesmo se torna mais confuso 
(ao menos, n&#227;o deveria se tornar). Entretanto, sempre fico 
extremamente incomodado quando tenho de escrever um bloco apenas 
marcar uma vari&#225;vel, como por exemplo:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">vencer_o_thanos</span><span class="p">:</span>
    <span class="n">paz</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">paz</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>


<p>Por isso, para trabalhar com vari&#225;veis que possuem um valor condicional,
gosto sempre de trabalhar com express&#245;es condicionais, ou como costumam
ser chamadas, <strong>operadores tern&#225;rios</strong>.</p>
<p>Operadores tern&#225;rios s&#227;o todos os operadores que podem receber tr&#234;s 
operandos. Como as express&#245;es condicionais costumam ser os operadores 
tern&#225;rios mais populares nas linguagens em que aparecem, acabamos por 
associar estes nomes e considerar que s&#227;o a mesma coisa. Cuidado ao tirar
este tipo de conclus&#227;o, mesmo que toda vogal esteja no alfabeto, o 
alfabeto n&#227;o &#233; composto apenas por vogais.</p>
<p>A estrutura de uma express&#227;o condicional &#233; algo bem simples, veja s&#243;:</p>
<div class="highlight"><pre><span></span><span class="n">paz</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">vencer_o_thanos</span> <span class="k">else</span> <span class="bp">False</span>
<span class="n">tipo_de_x</span> <span class="o">=</span> <span class="s2">&quot;Par&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;impar&quot;</span>
</pre></div>


<p>Resumidamente, teremos <strong>um valor seguido de uma condi&#231;&#227;o e por fim seu 
valor caso a condi&#231;&#227;o seja falsa</strong>. Pessoalmente acredito que apesar de um
pouco diferente, essa forma de escrita para casos como o exemplificado acima
&#233; muito mais clara, mais explicita.</p>
<p>Se voc&#234; fizer uma tradu&#231;&#227;o literal das booleanas utilizadas no primeiro exemplo,
ler&#225; algo como <code>paz &#233; verdadeira caso vencer_o_thanos, caso contr&#225;rio &#233; Falsa.</code> 
j&#225; o segundo exemplo fica mais claro ainda, pois lemos algo como 
<code>tipo_de_x &#233; par caso o resto da divis&#227;o de x por 2 seja 0, se n&#227;o, tipo_de_x &#233; impar.</code>.</p>
<p>Interpretar c&#243;digo dessa forma pode ser estranho para um programador. Interpretar
uma abertura de chave ou uma indenta&#231;&#227;o j&#225; &#233; algo mas natural. Todavia, para aqueles
que est&#227;o come&#231;ando, o racioc&#237;nio ocorre de forma muito mais parecida com a descrita
acima. Espero que tenham gostado do texto e que esse conhecimento lhes seja &#250;til.</p>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://pythonclub.com.br/trabalhando-com-operadores-ternarios.html">
	    por Vitor Hugo de Oliveira Vargas em
06 de October de 2018 &#224;s 12:21	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>October 01, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://brunorocha.org/"
	   title="BrunoRocha.org | Python web development | Tag pyplanet | feed">
Bruno Cezar Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="http://brunorocha.org/hacktoberfest-2018.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://brunorocha.org/hacktoberfest-2018.html">
Hacktoberfest 2018	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<h1>Hacktoberfest 2018</h1>
<p>Hacktoberfest is an amazing campaign by Digital Ocean and Github, you contribute with at least 5 open source Pull Requests and then you get a T-shirt and some stickers.</p>
<p>Maintainers are encouraged to label and organize the issues to be worked on.</p>
<p>Register at: <a href="https://hacktoberfest.digitalocean.com/">https://hacktoberfest.digitalocean.com/</a></p>
<p>I will list here some of my Projects and the issues I am expecting to get some contributions.</p>
<h2>Dynaconf</h2>
<p>Dynaconf is a library for settings management in any kind of Python project.</p>
<p>Skills needed: CI, Python, decorators, Python Module Initialization, Data Structures and Python data Model</p>
<p>Issues: <a href="https://github.com/rochacbruno/dynaconf/issues">https://github.com/rochacbruno/dynaconf/issues</a></p>
<p>Highlights:</p>
<ul>
<li>Add Windows CI by configuring AppVeyor <a href="https://github.com/rochacbruno/dynaconf/issues/58">https://github.com/rochacbruno/dynaconf/issues/58</a></li>
<li>Load settings from etcd server <a href="https://github.com/rochacbruno/dynaconf/issues/61">https://github.com/rochacbruno/dynaconf/issues/61</a></li>
<li>Load settings from /etc and XDG home directories <a href="https://github.com/rochacbruno/dynaconf/issues/74">https://github.com/rochacbruno/dynaconf/issues/74</a> and <a href="https://github.com/rochacbruno/dynaconf/issues/73">https://github.com/rochacbruno/dynaconf/issues/73</a></li>
<li>Allow dot notation to traverse settings <a href="https://github.com/rochacbruno/dynaconf/issues/84">https://github.com/rochacbruno/dynaconf/issues/84</a> and <a href="https://github.com/rochacbruno/dynaconf/issues/85">https://github.com/rochacbruno/dynaconf/issues/85</a></li>
<li>Allow multiple settings to be merged <a href="https://github.com/rochacbruno/dynaconf/issues/86">https://github.com/rochacbruno/dynaconf/issues/86</a></li>
</ul>
<h2>Flasgger</h2>
<p>Flasgger is the project powering the <a href="http://httpbin.org">http://httpbin.org</a> website, it allows you to document your Flask API and serves Swagger UI.</p>
<p>Skills needed: API REST, Flask, OPenAPISpec, Decorators, Python data model.</p>
<p>Issues: <a href="https://github.com/rochacbruno/flasgger/issues">https://github.com/rochacbruno/flasgger/issues</a><br />
HIghlights:</p>
<ul>
<li>Implement a logging handler <a href="https://github.com/rochacbruno/flasgger/issues/155">https://github.com/rochacbruno/flasgger/issues/155</a></li>
<li>Decorator based spec definition <a href="https://github.com/rochacbruno/flasgger/issues/152">https://github.com/rochacbruno/flasgger/issues/152</a></li>
<li>Fix JWT support <a href="https://github.com/rochacbruno/flasgger/issues/209">https://github.com/rochacbruno/flasgger/issues/209</a></li>
<li>Use Python 3.7 metaclass for schema definition <a href="https://github.com/rochacbruno/flasgger/issues/204">https://github.com/rochacbruno/flasgger/issues/204</a></li>
<li>SwaggerUI Prefix in template file <a href="https://github.com/rochacbruno/flasgger/issues/196">https://github.com/rochacbruno/flasgger/issues/196</a> </li>
<li>AllOf validation: <a href="https://github.com/rochacbruno/flasgger/issues/179">https://github.com/rochacbruno/flasgger/issues/179</a></li>
<li>Upload support <a href="https://github.com/rochacbruno/flasgger/issues/168">https://github.com/rochacbruno/flasgger/issues/168</a></li>
<li>Basic Auth <a href="https://github.com/rochacbruno/flasgger/issues/103">https://github.com/rochacbruno/flasgger/issues/103</a></li>
<li>Multiple Method Class View <a href="https://github.com/rochacbruno/flasgger/issues/92">https://github.com/rochacbruno/flasgger/issues/92</a></li>
</ul>
<h2>Flask Google Maps</h2>
<p>Easy way to add maps to Flask views.</p>
<p>Skills needed: Flask, Google APIs</p>
<p>Issues: <a href="https://github.com/rochacbruno/Flask-GoogleMaps">https://github.com/rochacbruno/Flask-GoogleMaps</a></p>
<h2>Flask Simple Login</h2>
<p>Easy way to protect your Flask views with login.</p>
<p>Skills needed: Python, Flask, environment variables, templating, CSS, HTML, Bootstrap.</p>
<p>Issues: <a href="https://github.com/rochacbruno/flask_simplelogin/issues">https://github.com/rochacbruno/flask_simplelogin/issues</a></p>
<p>Highlights:</p>
<ul>
<li>Implement Bootstrap collapsible menu <a href="https://github.com/rochacbruno/flask_simplelogin/issues/12">https://github.com/rochacbruno/flask_simplelogin/issues/12</a></li>
<li>Add a config to protect all the views in the project <a href="https://github.com/rochacbruno/flask_simplelogin/issues/11">https://github.com/rochacbruno/flask_simplelogin/issues/11</a></li>
<li>Normalize envvars names (keeping backeards compatibility) <a href="https://github.com/rochacbruno/flask_simplelogin/issues/6">https://github.com/rochacbruno/flask_simplelogin/issues/6</a></li>
</ul>
<h2>Quokka CMS</h2>
<p>Quokka is a Content Management Framework, which is in process of rewriting, the idea is having a core written in Flask, use Pelican themes and allow generation of static websites.</p>
<p>Skills needed: Flask, Python, Templating, MongoDB</p>
<p>Issues:  <a href="https://github.com/rochacbruno/quokka">https://github.com/rochacbruno/quokka</a></p>
<p>All the issues are good, as it is a re-writing from scratch project.</p>
<h2>Py2rs</h2>
<p>This is a Guide for Pythonistas who are learning Rust language</p>
<p>Issues: <a href="https://github.com/rochacbruno/py2rs/issues">https://github.com/rochacbruno/py2rs/issues</a></p>
<p>The project really needs more examples to be written and also more comparison and fixes. Any kind of contributions are welcome.</p>
<h2>Talkshow</h2>
<p>This is a call 4 papers system (used as didatic example only)</p>
<p>Skills needed: Flask, Templating, mongoDB</p>
<p>Issues: <a href="https://github.com/rochacbruno/talkshow/issues">https://github.com/rochacbruno/talkshow/issues</a></p>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://brunorocha.org/hacktoberfest-2018.html">
	    por Bruno Rocha em
01 de October de 2018 &#224;s 18:20	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>September 25, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/keeping-open-source-projects-awesome-go/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/qBr-9oOMis0/">
Keeping open source projects - awesome-go	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Beginning of any project (especially when we are talking about open source) is extremely entertaining for developer, over the years the fun passes and it is the responsibility to keep your &ldquo;son&rdquo; following the path of it.
How did the starting awesome-go? All projects I started are out of necessity, the awesome-go was no different.
After knowing the awesome-python and seeing other &ldquo;awesomes&rdquo; projects I searched for the awesome-go and did not get results.<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/qBr-9oOMis0" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/qBr-9oOMis0/">
25 de September de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>September 24, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://blog.luizirber.org/"
	   title="Gabbleblotchits">
Gabbleblotchits	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blog.luizirber.org,2018-09-24:/2018/09/24/open-science/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://blog.luizirber.org/2018/09/24/open-science/">
What open science is about	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Today I got a pleasant surprise: <a href="http://www.olgabotvinnik.com/">Olga Botvinnik</a> posted on <a href="https://twitter.com/olgabot/status/1044292704513839104">Twitter</a>
about a <a href="https://github.com/czbiohub/kmer-hashing/blob/olgabot/search-compare-ignore-abundance/figures/presentations/2018-09-24_beyond_the_cell_atlas_poster/2018-09-24_Beyond_the_Cell_Atlas.pdf">poster</a> she is presenting at the Beyond the Cell Atlas conference
and she name-dropped a bunch of people that helped her. The cool thing? They
are all open source developers, and Olga interacted thru GitHub to <a href="https://github.com/dib-lab/sourmash/pull/543">ask</a> <a href="https://github.com/dib-lab/sourmash/issues/545">for</a> <a href="https://github.com/betteridiot/bamnostic/issues/15">features</a>,
<a href="https://github.com/betteridiot/bamnostic/issues/20">report bugs</a> and even <a href="https://github.com/dib-lab/sourmash/pull/543">submit</a> <a href="https://github.com/dib-lab/sourmash/pull/539">pull</a> <a href="https://github.com/dib-lab/sourmash/pull/529">requests</a>.</p>
<p>That's what open science is about: collaboration, good practices, and in the end coming up
with something that is larger than each individual piece. Now sourmash is better,
bamnostic is better, reflow is better. I would like to see this becoming more and
more common =]</p>
<h2>Comments?</h2>
<ul>
<li><a href="https://social.lasanha.org/@luizirber/100783375923088450">Thread on Mastodon</a></li>
<li><a href="https://twitter.com/luizirber/status/1044369382233665536">Thread on Twitter</a></li>
</ul>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://blog.luizirber.org/2018/09/24/open-science/">
	    por luizirber em
24 de September de 2018 &#224;s 20:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>September 22, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://blog.filipesaraiva.info"
	   title="planeta-python-brasil &#8211; Filipe Saraiva's blog">
Filipe Saraiva	</a>
      </h3>


    <div class="entrygroup"
         id="http://blog.filipesaraiva.info/?p=1993"
	   lang="pt-BR"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://blog.filipesaraiva.info/?p=1993">
Akademy 2018	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p><a href="http://blog.filipesaraiva.info/?attachment_id=1987" rel="attachment wp-att-1987"><img alt="" class="aligncenter size-large wp-image-1987" height="348" src="http://blog.filipesaraiva.info/wp-content/uploads/2018/09/akademy2018-groupphoto-1024x440.jpg" width="639" /></a><em>Procure seu colaborador favorito do KDE na <a href="https://devel-home.kde.org/~duffus/akademy/2018/groupphoto/" rel="noopener" target="_blank">Foto em grupo oficial do Akademy 2018</a></em></p>
<p>Estive em Viena para participar do <a href="https://akademy.kde.org/2018" rel="noopener" target="_blank">Akademy 2018</a>, o encontro anual do KDE. Este foi o meu quarto Akademy, sendo antecedido por Berlin&#8217;2012 (na verdade, Desktop Summit ), Brno&#8217;2014, e Berlin&#8217;2016 (junto com a QtCon). Interessante, vou ao Akademy a cada 2 anos &#8211; pretendo melhorar isso j&#225; no pr&#243;ximo. <img alt="&#128578;" class="wp-smiley" src="https://s.w.org/images/core/emoji/11.2.0/72x72/1f642.png" /></p>
<p>Ap&#243;s uma viagem muito longa, pude finalmente encontrar &#8220;cabe&#231;as de engrenagem&#8221; de todas as partes do mundo, incluindo o pr&#243;prio Brasil. Vi velhos e novos amigos trabalhando juntos para melhorar a experi&#234;ncia de utilizar um computador com software livre, cada qual contribuindo com pequenas (e alguns, realmente gigantes) partes para tornar isso realidade. Sempre que encontro esse pessoal me sinto reenergizado para seguir com esse trabalho.</p>
<p>Das palestras, gostei muito da feita por <a href="https://conf.kde.org/en/Akademy2018/public/events/22" rel="noopener" target="_blank">Volker sobre o KDE Itinerary</a>, uma nova aplica&#231;&#227;o para gerenciar passbooks relacionados com viagens. Penso que um software para gerenciar todos os tipos de arquivos passbook (como entradas para shows, cinemas, e mais) como <a href="https://play.google.com/store/apps/details?id=io.walletpasses.android&hl=pt_BR" rel="noopener" target="_blank">este</a> seria uma interessante adi&#231;&#227;o para a fam&#237;lia de softwares do KDE, e um passo anterior &#224; ideia perseguida pelo KDE Itinerary. De qualquer forma, estou na expectativa por novidades deste software.</p>
<p>A palestra sobre <a href="https://conf.kde.org/en/Akademy2018/public/events/10" rel="noopener" target="_blank">cria&#231;&#227;o de transi&#231;&#245;es utilizando o Kdenlive</a> me fez pensar em qu&#227;o interessante seria um plugin para executar scripts bash (ou python, talvez) de forma a automatizar v&#225;rios passos realizados por editores nesse software. Inclusive, talves utilizando a KDE Store para compartilhar esses scripts&#8230; enfim, muitas ideias.</p>
<p>Conheci Camilo durante o evento. A palestra dele sobre o <a href="https://conf.kde.org/en/Akademy2018/public/events/13" rel="noopener" target="_blank">vvave</a> me deu esperan&#231;as por uma nova e interessante aplica&#231;&#227;o de player multim&#237;dia, como uma vez tivemos no passado (saudades Amarok).</p>
<p>A &#250;ltima palestra que chamou minha aten&#231;&#227;o foi de Nate sobre <a href="https://conf.kde.org/en/Akademy2018/public/events/50" rel="noopener" target="_blank">algumas ideias para melhorar nosso ecossistema</a>. Nate est&#225; fazendo um trabalho fabuloso sobre usabilidade, &#8220;polindo&#8221; nossos software de diversas formas. Recomendo o&#160;<a href="https://pointieststick.wordpress.com/" rel="noopener" target="_blank">blog</a> dele para quem quiser ficar acompanhar tamb&#233;m. Apesar de eu concordar em geral com boa parte das ideias &#8211; por exemplo, &#233; urgente a necessidade de melhorarmos nossa su&#237;te de aplica&#231;&#245;es pessoais -, eu tive alguns desacordos em outras, em especial a ideia de que os desenvolvedores do KDE se dediquem a contribuir tamb&#233;m para o LibreOffice. LibreOffice tem um c&#243;digo fonte completamente diferente, que utiliza tecnologias e pr&#225;ticas nada relacionadas com o que vemos no KDE, e h&#225; v&#225;rias (e para muitos de n&#243;s, desconhecidas) influ&#234;ncias das diferentes organiza&#231;&#245;es que gerem a The Document Foundation, entidade respons&#225;vel por desenvolver o LibreOffice. E por fim, n&#243;s ainda temos a su&#237;te de escrit&#243;rio Calligra &#8211; a idea me soou como &#8220;vamos acabar com o Calligra&#8221;. De qualquer forma, isso foi apenas um desacordo com uma das sugest&#245;es, nada demais.</p>
<p>Ap&#243;s as se&#231;&#245;es de palestras o Akademy teve batantes sess&#245;es de BoF, que s&#227;o mini-reuni&#245;es direcionadas sobre t&#243;picos espec&#237;ficos. Pude participar de algumas, como a sobre o KDE e Qt (&#233; sempre bom manter os olhos sobre esse t&#243;pico), KDE Phabricator (Phabricator &#233; um conjunto muito bom de ferramentas para gerenciamento de projetos/reposit&#243;rios/e afins, mas sofre por conta dos competidores (Gitlab) serem muito mais conhecidos e tamb&#233;m por n&#227;o ter das melhores usabilidades), e MyCroft (gosto da ideia de integra&#231;&#227;o entre o MyCroft e o Plasma, especialmente para casos de uso espec&#297;ficos como auxiliar pessoas com defici&#234;ncia &#8211; estou pensando nisso j&#225; h&#225; alguns meses).</p>
<p>Este ano, Aracele, Sandro e eu realizamos um BoF chamado &#8220;KDE in Americas&#8221;. A ideia foi apresentar algumas das nossas conquistas para o KDE na Am&#233;rica Latina e discutir com o pessoal das demais am&#233;ricas sobre um evento &#8220;continental&#8221;, trazendo de volta o antigo CampKDE em uma nova edi&#231;&#227;o junto com o LaKademy (o nome secreto &#233; LaKamp :D). Esta ideia ainda precisa de alguma matura&#231;&#227;o para seguir em frente, mas estamos trabalhando.</p>
<p>Este ano eu tentei realizar o BoF sobre <a href="https://phabricator.kde.org/T6895#146019" rel="noopener" target="_blank">KDE na ci&#234;ncia</a> e Cantor, mas infelizmente eu n&#227;o tive o feedback necess&#225;rio sobre potenciais participantes. Vamos ver se no futuro poderemos ter alguns deles acontecendo.</p>
<p>Akademy &#233; um evento fant&#225;stico onde voc&#234; encontra colaboradores do KDE de diferentes frentes e culturas, pode discutir com eles, pegar opini&#245;es sobre projetos atuais e mesmo iniciar novos. Gostaria de agradecer ao KDE e.V. pelo patroc&#237;nio que me permitiu ir ao evento e espero ver todos voc&#234;s e mais alguns no pr&#243;ximo ano (vou tentar inserir um dist&#250;rbio naquela distribui&#231;&#227;o da minha sequ&#234;ncia bianual de participa&#231;&#245;es) no Akademy ou, em algumas semanas, no LaKademy!</p>
<p><a href="http://blog.filipesaraiva.info/?attachment_id=1988" rel="attachment wp-att-1988"><img alt="" class="aligncenter size-large wp-image-1988" height="480" src="http://blog.filipesaraiva.info/wp-content/uploads/2018/09/dsc01881-1024x683.jpg" width="639" /></a><em>Brasileiros no Akademy 2018: KDHelio, Caio, Sandro, Filipe (eu), Tomaz (abaixo), Eliakin, Aracele, e Lays</em></p>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://blog.filipesaraiva.info/?p=1993">
	    por Filipe Saraiva em
22 de September de 2018 &#224;s 21:13	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>September 13, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://blog.luizirber.org/"
	   title="Gabbleblotchits">
Gabbleblotchits	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blog.luizirber.org,2018-09-13:/2018/09/13/nthash/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://blog.luizirber.org/2018/09/13/nthash/">
New crate: nthash	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>A quick announcement: I wrote a <a href="https://github.com/luizirber/nthash">Rust implementation</a> of <a href="https://github.com/bcgsc/ntHash">ntHash</a> and published
it in <a href="https://crates.io/crates/nthash">crates.io</a>. It implements an <code>Iterator</code> to take advantage of the
rolling properties of <code>ntHash</code> which make it so useful in bioinformatics (where
we work a lot with sliding windows over sequences).</p>
<p>It's a pretty small crate, and probably was a better project to learn Rust than
doing a <a href="https://blog.luizirber.org/2018/08/23/sourmash-rust/">sourmash implementation</a> because it doesn't involve gnarly FFI
issues. I also put <a href="https://github.com/luizirber/nthash/blob/d0c16d7deb0a78b8aeb29090db91bba954c14fe8/src/lib.rs#L91">some docs</a>, <a href="https://github.com/luizirber/nthash/blob/d0c16d7deb0a78b8aeb29090db91bba954c14fe8/benches/nthash.rs#L11">benchmarks</a> using <a href="https://japaric.github.io/criterion.rs/">criterion</a>,
and even an <a href="https://github.com/luizirber/nthash/blob/d0c16d7deb0a78b8aeb29090db91bba954c14fe8/tests/nthash.rs#L80">oracle property-based test</a> with <a href="https://github.com/BurntSushi/quickcheck">quickcheck</a>.</p>
<p>More info <a href="https://docs.rs/nthash/">in the docs</a>, and if you want an <s>optimization</s> versioning bug
discussion be sure to check the <a href="https://github.com/luizirber/nthash_bug"><code>ntHash bug?</code></a> repo,
which has a (slow) Python implementation and a pretty nice <a href="https://nbviewer.jupyter.org/github/luizirber/nthash_bug/blob/master/analysis.ipynb">analysis</a> notebook.</p>
<h2>Comments?</h2>
<ul>
<li><a href="https://social.lasanha.org/@luizirber/100721133117928424">Thread on Mastodon</a></li>
<li><a href="https://twitter.com/luizirber/status/1040386666089705472">Thread on Twitter</a></li>
</ul>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://blog.luizirber.org/2018/09/13/nthash/">
	    por luizirber em
13 de September de 2018 &#224;s 20:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 27, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://blog.luizirber.org/"
	   title="Gabbleblotchits">
Gabbleblotchits	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blog.luizirber.org,2018-08-27:/2018/08/27/sourmash-wasm/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://blog.luizirber.org/2018/08/27/sourmash-wasm/">
Oxidizing sourmash: WebAssembly	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>sourmash calculates MinHash signatures for genomic datasets,
meaning we are reducing the data (via subsampling) to a small
representative subset (a signature) capable of answering one question:
how similar is this dataset to another one? The key here is that a dataset with
10-100 GB will be reduced to something in the megabytes range, and two approaches
for doing that are:</p>
<ul>
<li>The user install our software in their computer.
  This is not so bad anymore (yay bioconda!), but still requires knowledge
  about command line interfaces and how to install all this stuff. The user
  data never leaves their computer, and they can share the signatures later
  if they want to.</li>
<li>Provide a web service to calculate signatures. In this case no software
  need to be installed, but it's up to someone (me?) to maintain a server running with
  an API and frontend to interact with the users. On top of requiring more
  maintenance, another drawback is that
  the user need to send me the data, which is very inefficient network-wise
  and lead to questions about what I can do with their raw data (and I'm not
  into surveillance capitalism, TYVM).</li>
</ul>
<h2>But... what if there is a third way?</h2>
<p>What if we could keep the frontend code from the web service (very
user-friendly) but do all the calculations client-side (and avoid the network
bottleneck)? The main hurdle
here is that our software is implemented in Python (and C++), which are not
supported in browsers. My first solution was to write the core features of
<a href="https://github.com/luizirber/sourmash-node">sourmash in JavaScript</a>, but that quickly started hitting annoying things
like JavaScript not supporting 64-bit integers. There is also the issue of
having another codebase to maintain and keep in sync with the original sourmash,
which would be a relevant burden for us. I gave a <a href="https://drive.google.com/open?id=1JvXiDaEA4J3hmEKw6sV-VHMpuHG_sxls3fLxJOht28E">lab meeting</a> about this
approach, using a <a href="https://soursigs-dnd-luizirber.hashbase.io/">drag-and-drop UI as proof of concept</a>. It did work but it
was finicky (dealing with the 64-bit integer hashes is not fun). The good thing
is that at least I had a working UI for further testing<sup id="sf-sourmash-wasm-1-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-1" title="even if horrible, I need to get some design classes =P">1</a></sup></p>
<p>In "<a href="https://blog.luizirber.org/2018/08/23/sourmash-rust/">Oxidizing sourmash: Python and FFI</a>" I described my road to learn Rust,
but something that I omitted was that around the same time the <code>WebAssembly</code>
support in Rust started to look better and better and was a huge influence in 
my decision to learn Rust. Reimplementing the sourmash C++ extension in Rust and
use the same codebase in the browser sounded very attractive,
and now that it was working I started looking into how to use the WebAssembly
target in Rust.</p>
<h2>WebAssembly?</h2>
<p>From the <a href="https://webassembly.org/">official site</a>,</p>
<div class="highlight"><pre><span></span>WebAssembly (abbreviated Wasm) is a binary
instruction format for a stack-based
virtual machine. Wasm is designed as a
portable target for compilation of high-level
languages like C/C++/Rust, enabling deployment
on the web for client and server applications.
</pre></div>


<p>You can write WebAssembly by hand, but the goal is to have it as lower level
target for other languages. For me the obvious benefit is being able to use
something that is not JavaScript in the browser, even though the goal is not to replace
JS completely but complement it in a big pain point: performance. This also
frees JavaScript from being the target language for other toolchains,
allowing it to grow into other important areas (like language ergonomics).</p>
<p>Rust is not the only language targeting WebAssembly: Go 1.11 includes
<a href="https://golang.org/doc/go1.11#wasm">experimental support for WebAssembly</a>, and there are even projects bringing
the <a href="https://github.com/iodide-project/pyodide">scientific Python to the web</a> using WebAssembly. </p>
<h2>But does it work?</h2>
<p>With the <a href="https://github.com/luizirber/sourmash-rust">Rust implementation in place</a> and with all tests working on sourmash, I 
added the finishing touches using <a href="https://github.com/rustwasm/wasm-bindgen"><code>wasm-bindgen</code></a> and built an NPM package using
<a href="https://github.com/rustwasm/wasm-pack"><code>wasm-pack</code></a>: <a href="https://www.npmjs.com/package/sourmash">sourmash</a> is a Rust codebase compiled to WebAssembly and ready
to use in JavaScript projects.</p>
<p>(Many thanks to Madicken Munk, who also presented during SciPy about how they used
<a href="https://munkm.github.io/2018-07-13-scipy/">Rust and WebAssembly to do interactive visualization in Jupyter</a>
and helped with a good example on how to do this properly =] )</p>
<p>Since I already had the working UI from the previous PoC, I <a href="https://github.com/luizirber/wort-dnd">refactored the code</a>
to use the new WebAssembly module and voil&#224;! <a href="https://wort-dnd.hashbase.io/">It works!</a><sup id="sf-sourmash-wasm-2-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-2" title="the first version of this demo only worked in Chrome because they implemented the BigInt proposal, which is not in the official language yet. The funny thing is that BigInt would have made the JS implementation of sourmash viable, and I probably wouldn't have written the Rust implementation =P. Turns out that I didn't need the BigInt support if I didn't expose any 64-bit integers to JS, and that is what I'm doing now.">2</a></sup>.
<sup id="sf-sourmash-wasm-3-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-3" title="Along the way I ended up writing a new FASTQ parser... because it wouldn't be bioinformatics if it didn't otherwise, right? =P">3</a></sup>
But that was the demo from a year ago with updated code and I got a bit
better with frontend development since then, so here is the new demo:</p>
<div class="box" id="files">
  <h2>sourmash + Wasm</h2>
  <div id="drag-container">
    <p><b>Drag &amp; drop</b> a FASTA or FASTQ file here to calculate the sourmash signature.</p>
  </div>

  <div id="progress-container">
    <div id="progress-bar"></div>
  </div>
  <div class="columns">
    <fieldset class="box input-button" id="params">
      <label for="ksize-input">k-mer size:</label>
      <input id="ksize-input" type="number" value="21" />
      <label for="scaled-input">scaled:</label>
      <input id="scaled-input" type="number" value="0" />
      <label for="num-input">number of hashes:</label>
      <input id="num-input" type="number" value="500" />
      <label for="dna-protein-group">Input type:</label>
      <div id="dna-protein-group">
        <input checked="checked" id="dna-input" name="dna-protein-input" type="radio" value="DNA/RNA" />
        <label for="dna-input">DNA/RNA</label>
        <input id="protein-input" name="dna-protein-input" type="radio" value="Protein" />
        <label for="protein-input">Protein</label>
      </div>
      <label for="track-abundance-input">Track abundance?</label>
      <input checked="checked" id="track-abundance-input" type="checkbox" />
    </fieldset>
    <div class="box" id="download">
      <button disabled="disabled" id="download_btn" type="button">Download</button>
    </div>
  </div>
</div>

<p>
</p>
<p>For the source code for this demo, check the <a href="https://blog.luizirber.org/static/sourmash-wasm/index.html">sourmash-wasm</a> directory.</p>
<h2>Next steps</h2>
<p>The proof of concept works, but it is pretty useless right now.
I'm thinking about building it as a <a href="https://www.webcomponents.org/">Web Component</a> and making it really easy
to add to any webpage<sup id="sf-sourmash-wasm-4-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-4" title="or maybe a React component? I really would like to have something that works independent of framework, but not sure what is the best option in this case...">4</a></sup>.</p>
<p>Another interesting feature would be supporting more input formats (the GMOD
project implemented a lot of those!), but more features are probably better
after something simple but functional is released =P</p>
<h2>Next time!</h2>
<p>Where we will go next? Maybe explore some decentralized web technologies like
IPFS and dat, hmm? =]</p>
<h2>Comments?</h2>
<ul>
<li><a href="https://social.lasanha.org/@luizirber/100624574917435477">Thread on Mastodon</a></li>
<li><a href="https://www.reddit.com/r/rust/comments/9atie8/blog_post_clientside_bioinformatics_in_the/">Thread on reddit</a></li>
<li><a href="https://twitter.com/luizirber/status/1034206952773935104">Thread on Twitter</a></li>
</ul>
<h2>Updates</h2>
<ul>
<li>2018-08-30: Added a demo in the blog post.</li>
</ul><hr /><h2>Footnotes</h2><ol><li id="sf-sourmash-wasm-1"><p>even if horrible, I
need to get some design classes =P <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-1-back">&#8617;</a></p></li><li id="sf-sourmash-wasm-2"><p>the first version
of this demo only worked in Chrome because they implemented the <a href="https://github.com/tc39/proposal-bigint">BigInt proposal</a>,
which is not in the official language yet. The funny thing is that BigInt would
have made the JS implementation of sourmash viable, and I probably wouldn't have
written the Rust implementation =P.
Turns out that I didn't need the BigInt support if I didn't expose any 64-bit
integers to JS, and that is what I'm doing now. <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-2-back">&#8617;</a></p></li><li id="sf-sourmash-wasm-3"><p>Along the way I ended up writing a new FASTQ parser... because it wouldn't
be bioinformatics if it didn't otherwise, right? =P <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-3-back">&#8617;</a></p></li><li id="sf-sourmash-wasm-4"><p>or maybe a React component? I really would like to
have something that works independent of framework, but not sure what is the
best option in this case... <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-wasm-4-back">&#8617;</a></p></li></ol>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://blog.luizirber.org/2018/08/27/sourmash-wasm/">
	    por luizirber em
27 de August de 2018 &#224;s 18:30	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 26, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://paulohrpinheiro.xyz"
	   title="Paulo Henrique Rodrigues Pinheiro">
Blog do PauloHRPinheiro	</a>
      </h3>


    <div class="entrygroup"
         id="https://paulohrpinheiro.xyz/texts/python/2018-08-26-google-cloud-functions-com-python.html"
	   lang="pt-br"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-08-26-google-cloud-functions-com-python.html">
Usando Python no Google Cloud Functions, rumo ao serverless	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Um breve teste de conceito para ver "qual&#233;" do Google Cloud Functions e dessa ideia de serverless      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-08-26-google-cloud-functions-com-python.html">
26 de August de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 23, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://blog.luizirber.org/"
	   title="Gabbleblotchits">
Gabbleblotchits	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blog.luizirber.org,2018-08-23:/2018/08/23/sourmash-rust/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://blog.luizirber.org/2018/08/23/sourmash-rust/">
Oxidizing sourmash: Python and FFI	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>I think the first time I heard about Rust was because Frank Mcsherry chose it to
write a <a href="https://github.com/frankmcsherry/timely-dataflow">timely dataflow</a> implementation.
Since then it started showing more and more in my news sources,
leading to Armin Ronacher publishing a post in the Sentry blog last November about
writing <a href="https://blog.sentry.io/2017/11/14/evolving-our-rust-with-milksnake">Python extensions in Rust</a>.</p>
<p>Last December I decided to give it a run:
I spent some time porting the C++ bits of <a href="https://github.com/dib-lab/sourmash">sourmash</a>
to Rust.
The main advantage here is that it's a problem I know well,
so I know what the code is supposed to do and can focus on figuring out
syntax and the mental model for the language.
I started digging into the <code>symbolic</code> codebase and understanding what they did,
and tried to mirror or improve it for my use cases.</p>
<p>(About the post title: The process of converting a codebase to Rust is referred as <a href="https://wiki.mozilla.org/Oxidation">"Oxidation"</a> in
the Rust community, following the codename Mozilla chose for the process of
integrating Rust components into the Firefox codebase.
<sup id="sf-sourmash-rust-1-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-1" title="The creator of the language is known to keep making up different explanations for the name of the language, but in this case "oxidation" refers to the chemical process that creates rust, and rust is the closest thing to metal (metal being the hardware). There are many terrible puns in the Rust community.">1</a></sup>
Many of these components were tested and derived in Servo, an experimental
browser engine written in Rust, and are being integrated into Gecko,
the current browser engine (mostly written in C++).)</p>
<h2>Why Rust?</h2>
<p>There are other programming languages more focused on scientific software
that could be used instead, like Julia<sup id="sf-sourmash-rust-2-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-2" title="Even more now that it hit 1.0, it is a really nice language">2</a></sup>. Many programming languages start from a
specific niche (like R and statistics,
or Maple and mathematics) and grow into larger languages over time.
While Rust goal is not to be a scientific language,
its focus on being a general purpose language allows a phenomenon similar
to what happened with Python, where people from many areas pushed the
language in different directions (system scripting, web development,
numerical programming...) allowing developers to combine all these things
in their systems.</p>
<p>But by far my interest in Rust is for the many best practices it brings to the default experience:
integrated package management (with Cargo),
documentation (with rustdoc), testing and benchmarking.
It's understandable that older languages like C/C++ need
more effort to support some of these features (like modules and an unified
build system), since they are designed by standard and need to keep backward
compatibility with codebases that already exist.
Nonetheless, the lack of features increase the effort needed to have good
software engineering practices, since you need to choose a solution that might
not be compatible with other similar but slightly different options,
leading to fragmentation and increasing the impedance to use these features.</p>
<p>Another big reason is that Rust doesn't aim to completely replace what already
exists, but complement and extend it. Two very good talks about how to do this,
one by <a href="https://ashleygwilliams.github.io/rustfest-2017/#1">Ashley Williams</a>, another by <a href="http://talks.edunham.net/lca2018/should-you-rewrite-in-rust/beamer.pdf">E. Dunham</a>.</p>
<h2>Converting from a C++ extension to Rust</h2>
<p>The current implementation of the core data structures in sourmash is in a
C++ extension wrapped with Cython. My main goals for converting the code are:</p>
<ul>
<li>
<p>support additional languages and platforms. sourmash is available as a Python
  package and CLI, but we have R users in the lab that would benefit from having
  an R package, and ideally we wouldn't need to rewrite the software every time
  we want to support a new language.</p>
</li>
<li>
<p>reducing the number of wheel packages necessary (one for each OS/platform).</p>
</li>
<li>
<p>in the long run, use the Rust memory management concepts (lifetimes, borrowing)
to increase parallelism in the code.</p>
</li>
</ul>
<p>Many of these goals are attainable with our current C++ codebase, and
"rewrite in a new language" is rarely the best way to solve a problem.
But the reduced burden in maintenance due to better tooling,
on top of features that would require careful planning to execute
(increasing the parallelism without data races) while maintaining compatibility
with the current codebase are promising enough to justify this experiment.
<a href="https://github.com/luizirber/2018-python-rust/blob/master/03.current_impl.md"><img src="https://blog.luizirber.org/images/arch_cpp.png" title="" /></a></p>
<p>Cython provides a nice gradual path to migrate code from Python to C++,
since it is a superset of the Python syntax. It also provides low overhead
for many C++ features, especially the STL containers, with makes it easier
to map C++ features to the Python equivalent.
For research software this also lead to faster exploration of solutions before
having to commit to lower level code, but without a good process it might also
lead to code never crossing into the C++ layer and being stuck in the Cython
layer. This doesn't make any difference for a Python user, but it becomes
harder from users from other languages to benefit from this code (since your
language would need some kind of support to calling Python code, which is not
as readily available as calling C code).</p>
<p>Depending on the requirements, a downside is that Cython is tied to the CPython API,
so generating the extension requires a development environment set up with
the appropriate headers and compiler. This also makes the extension specific
to a Python version: while this is not a problem for source distributions,
generating wheels lead to one wheel for each OS and Python version supported.</p>
<h2>The new implementation</h2>
<p>This is the overall architecture of the Rust implementation:
<a href="https://github.com/luizirber/2018-python-rust/blob/master/04.rust_impl.md"><img src="https://blog.luizirber.org/images/arch_rust.png" title="" /></a>
It is pretty close to what <code>symbolic</code> does,
so let's walk through it.</p>
<h3>The Rust code</h3>
<p>If you take a look at my Rust code, you will see it is very... C++. A lot of the
code is very similar to the original implementation, which is both a curse and a
blessing: I'm pretty sure that are more idiomatic and performant ways of doing
things, but most of the time I could lean on my current mental model for C++ to
translate code. The biggest exception was the <code>merge</code> function, were I was doing
something on the C++ implementation that the borrow checker didn't like.
Eventually I found it was because it couldn't keep track of the lifetime
correctly and putting braces around it fixed the problem,
which was both an epiphany and a WTF moment. <a href="https://play.rust-lang.org/?gist=eae9de12950d1b2a7699cd49a3571c37&version=stable">Here</a> is an example that triggers
the problem, and the <a href="https://play.rust-lang.org/?gist=c8733c5125766930a589c8d0412af99c&version=stable">solution</a>.</p>
<p>"Fighting the borrow checker" seems to be a common theme while learning Rust,
but the compiler really tries to help you to understand what is happening and
(most times) how to fix it. A lot of people grow to hate the borrow checker,
but I see it more as a 'eat your vegetables' situation: you might not like it
at first, but it's better in the long run. Even though I don't have a big
codebase in Rust yet, it keeps you from doing things that will come back to bite
you hard later.</p>
<h3>Generating C headers for Rust code: cbindgen</h3>
<p>With the Rust library working, the next step was taking the Rust code and generate C headers describing the
functions and structs we expose with the <code>#[no_mangle]</code> attribute in Rust
(these are defined in the <a href="https://github.com/luizirber/sourmash-rust/blob/ead9ae0ed3b2d16c9e3b8379919f3bfd2efd21ae/src/ffi.rs"><code>ffi.rs</code></a> module in <code>sourmash-rust</code>).
This attribute tells the Rust compiler to generate names that are compatible
with the C ABI, and so can be called from other languages that implement FFI
mechanisms. FFI (the foreign function interface) is quite low-level,
and pretty much defines things that C can represent: integers, floats, pointers
and structs. It doesn't support higher level concepts like objects or generics,
so in a sense it looks like a feature funnel.
This might sound bad, but ends up being something that other languages can
understand without needing too much extra functionality in their runtimes,
which means that most languages have support to calling code through an FFI.</p>
<p>Writing the C header by hand is possible, but is very error prone.
A better solution is to use <a href="https://github.com/eqrion/cbindgen"><code>cbindgen</code></a>,
a program that takes Rust code and generate a C header file automatically.
<code>cbindgen</code> is developed primarily to generate the C headers for <a href="https://github.com/servo/webrender/">webrender</a>,
the GPU-based renderer for servo,
so it's pretty likely that if it can handle a complex codebase it will work
just fine for the majority of projects.</p>
<h3>Interfacing with Python: CFFI and Milksnake</h3>
<p>Once we have the C headers, we can use the FFI to
call Rust code in Python. Python has a FFI module in the standard library: <code>ctypes</code>,
but the Pypy developers also created CFFI, which has more features.</p>
<p>The C headers generated by cbindgen can be interpreted by CFFI to generate
a low-level Python interface for the code. This is the equivalent of declaring
the functions/methods and structs/classes in a <code>pxd</code> file (in the Cython
world): while the code is now usable in Python, it is not well adapted to
the features and idioms available in the language.</p>
<p>Milksnake is the package developed by Sentry that takes care of running cargo
for the Rust compilation and generating the CFFI boilerplate,
making it easy to load the low-level CFFI bindings in Python.
With this low-level binding available we can now write something more Pythonic
(the <code>pyx</code> file in Cython), and I ended up just renaming the <code>_minhash.pyx</code> file
back to <code>minhash.py</code> and doing one-line fixes to replace the Cython-style code
with the equivalent CFFI calls.</p>
<p>All of these changes should be transparent to the Python code, and to guarantee
that I made sure that all the current tests that we have (both for the Python
module and the command line interface) are still working after the changes.
It also led to finding some quirks in the implementation,
and even improvements in the current C++ code (because we were moving a lot of
data from C++ to Python).</p>
<h2>Where I see this going</h2>
<p>It seems it worked as an experiment,
and I presented a <a href="https://github.com/luizirber/2018-python-rust">poster</a> at <a href="https://gccbosc2018.sched.com/event/FEWp/b23-oxidizing-python-writing-extensions-in-rust">GCCBOSC 2018</a> and <a href="https://scipy2018.scipy.org/ehome/index.php?eventid=299527&tabid=712461&cid=2233543&sessionid=21618890&sessionchoice=1&">SciPy 2018</a> that
was met with excitement by many people.
Knowing that it is possible,
I want to reiterate some points why Rust is pretty exciting for bioinformatics
and science in general.</p>
<h3>Bioinformatics as libraries (and command line tools too!)</h3>
<p>Bioinformatics is an umbrella term for many different methods, depending on
what analysis you want to do with your data (or model).
In this sense, it's distinct from other scientific areas where it is possible
to rely on a common set of libraries (numpy in linear algebra, for example), since a
library supporting many disjoint methods tend to grow too big and hard to
maintain.</p>
<p>The environment also tends to be very diverse, with different languages being
used to implement the software. Because it is hard to interoperate,
the methods tend to be implemented in command line programs that are stitched
together in pipelines, a workflow describing how to connect the input and output of many different tools to
generate results.
Because the basic unit is a command-line tool,
pipelines tend to rely on standard operating system abstractions like
files and pipes to make the tools communicate with each other. But since tools
might have input requirements distinct from what the previous tool provides,
many times it is necessary to do format conversion or other adaptations to make the
pipeline work.</p>
<p>Using tools as blackboxes, controllable through specific parameters at the
command-line level, make exploratory analysis and algorithm reuse harder:
if something needs to be investigated the user needs to resort to perturbations
of the parameters or the input data, without access to the more feature-rich and
meaningful abstraction happening inside the tool.</p>
<p>Even if many languages are used for writing the software, most of the time there
is some part written in C or C++ for performance reasons, and these tend to be
the core data structures of the computational method. Because it is not easy to
package your C/C++ code in a way that other people can readily use it,
most of this code is reinvented over and over again, or is copy and pasted into
codebases and start diverging over time. Rust helps solve this problem with the
integrated package management, and due to the FFI it can also be reused inside
other programs written in other languages.</p>
<p>sourmash is not going to be Rust-only and abandon Python,
and it would be crazy to do so when it has so many great exploratory tools
for scientific discovery. But now we can also use our method in other languages
and environment, instead of having our code stuck in one language.</p>
<h3>Don't rewrite it all!</h3>
<p>I could have gone all the way and rewrite sourmash in Rust<sup id="sf-sourmash-rust-3-back"><a class="simple-footnote" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-3" title="and risk being kicked out of the lab =P">3</a></sup>, but it would be incredibly disruptive for
the current sourmash users and it would take way longer to pull off. Because
Rust is so focused in supporting existing code, you can do a slow transition and
reuse what you already have while moving into more and more Rust code.
A great example is this one-day effort by Rob Patro to bring <a href="https://github.com/COMBINE-lab/cqf-rust">CQF</a> (a C
codebase) into Rust, using <code>bindgen</code> (a generator of C bindings for Rust).
Check <a href="https://blog.luizirber.org/2018/08/27/sourmash-wasm/">the Twitter thread</a> for more =]</p>
<h3>Good scientific citizens</h3>
<p>There is another MinHash implementation already written in Rust, <a href="https://github.com/onecodex/finch-rs">finch</a>.
Early in my experiment I got an email from them asking if I wanted to work
together, but since I wanted to learn the language I kept doing my thing. (They
were totally cool with this, by the way). But the fun thing is that Rust has a
pair of traits called <a href="https://doc.rust-lang.org/rust-by-example/conversion/from_into.html"><code>From</code> and <code>Into</code></a> that you can implement for your
type, and so I <a href="https://github.com/luizirber/sourmash-rust/pull/1">did that</a> and now we can have interoperable
implementations. This synergy allows <code>finch</code> to use <code>sourmash</code> methods,
and vice versa.</p>
<p>Maybe this sounds like a small thing, but I think it is really exciting. We can
stop having incompatible but very similar methods, and instead all benefit from
each other advances in a way that is supported by the language.</p>
<h2>Next time!</h2>
<p>Turns out Rust supports WebAssembly as a target,
so... what if we run sourmash in the browser?
That's what I'm covering in the <a href="https://blog.luizirber.org/2018/08/27/sourmash-wasm/">next blog post</a>,
so stay tuned =]</p>
<h2>Comments?</h2>
<ul>
<li><a href="https://social.lasanha.org/@luizirber/100602525575698239">Thread on Mastodon</a></li>
<li><a href="https://www.reddit.com/r/rust/comments/99vakd/blog_post_converting_c_to_rust_and_interoperate/">Thread on reddit</a></li>
<li><a href="https://twitter.com/luizirber/status/1032779995129597952">Thread on Twitter</a></li>
</ul>
<!-- rust libs -->

<!-- why rust -->

<!-- WASM and demos -->

<!-- python and FFI -->

<!-- rust examples -->

<!-- cbindgen -->

<!-- rust for pythonistas -->

<!-- understanding rust -->

<!-- rust and bio -->

<!-- rust error handling -->

<!-- other notes

- Implement Default trait for defaults (less verbose than ::new...)
  https://doc.rust-lang.org/std/default/trait.Default.html

--><hr /><h2>Footnotes</h2><ol><li id="sf-sourmash-rust-1"><p>The creator of the language is known to keep making up different
explanations for the <a href="https://www.reddit.com/r/rust/comments/27jvdt/internet_archaeology_the_definitive_endall_source/">name of the language</a>,
but in this case "oxidation" refers to the chemical process that creates
rust, and rust is the closest thing to metal (metal being the hardware).
There are many terrible puns in the Rust community. <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-1-back">&#8617;</a></p></li><li id="sf-sourmash-rust-2"><p>Even more now that it hit 1.0,
it is a really nice language <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-2-back">&#8617;</a></p></li><li id="sf-sourmash-rust-3"><p>and risk
being kicked out of the lab =P <a class="simple-footnote-back" href="https://blog.luizirber.org/atom.xml?tag=python#sf-sourmash-rust-3-back">&#8617;</a></p></li></ol>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://blog.luizirber.org/2018/08/23/sourmash-rust/">
	    por luizirber em
23 de August de 2018 &#224;s 20:00	</a>
      </p>
    </div>
  </div>



        </div>
      <div class="channelgroup">

      <h3>
        <a href="https://humberto.io/pt-br/tags/python/"
	   title="python on Humberto Rocha">
Humberto Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="https://humberto.io/pt-br/blog/tldr-leitura-e-escrita-de-unicode-em-arquivos-com-python-2-e-3/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://humberto.io/pt-br/blog/tldr-leitura-e-escrita-de-unicode-em-arquivos-com-python-2-e-3/">
TLDR: Leitura e escrita de Unicode em arquivos com Python 2 e 3	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Conversando no Telegram com o M&#225;rio S&#233;rgio sobre problemas que surgem ao migrar c&#243;digo entre vers&#245;es do Python me veio a ideia de escrever este tldr para ajudar quem precisa fazer leitura ou escrita de arquivos que contenham texto com caracteres Unicode que n&#227;o est&#227;o presentes na tabela ASCII como caracteres acentuados, alfabetos diferentes do romano e emoji, atrav&#233;s de um c&#243;digo que funcione em ambas vers&#245;es.
No Python 2 n&#227;o existe uma distin&#231;&#227;o entre byte e string, o que faz com que c&#243;digos que lidam com entrada e sa&#237;da sem o devido cuidado com codifica&#231;&#227;o e decodifica&#231;&#227;o funcionem sem nenhum erro aparente.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://humberto.io/pt-br/blog/tldr-leitura-e-escrita-de-unicode-em-arquivos-com-python-2-e-3/">
23 de August de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 19, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/usando-ipad-pro-como-laptop-principal/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/wj8lVwuHrjk/">
Usando iPad Pro como laptop principal	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Ap&#243;s ler alguns blogpost sobre usar o iPad como computador principal e conversar com um amigo que trabalha no Google que usa em caso como &ldquo;main laptop&rdquo;, resolvi estudar os apps para iOS que eu teria que usar para atender a minha demanda do dia a dia como gestor e desenvolvedor.
Como sempre a Apple faz um &#243;timo trabalho nos seus produtos, sempre pensando na simplicidade de uso do seu cliente final, ou seja, isso ajuda o onboard em qualquer dispositivo/software deles.<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/wj8lVwuHrjk" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/wj8lVwuHrjk/">
19 de August de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>August 10, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://humberto.io/pt-br/tags/python/"
	   title="python on Humberto Rocha">
Humberto Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="https://humberto.io/pt-br/blog/enviando-e-recebendo-emails-com-python/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://humberto.io/pt-br/blog/enviando-e-recebendo-emails-com-python/">
Enviando e recebendo emails com Python	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Um dia na ter&#231;a do Python no Calango Hacker Clube surgiu uma d&#250;vida de como ler emails do Gmail para poder categorizar as mensagens e automatizar o processo de leitura dos emails usando Python. Esta d&#250;vida motivou esta postagem que tem o objetivo de ajudar a todos que tiverem d&#250;vidas de como come&#231;ar a interagir com sistemas de troca de emails utilizando Python.
Esta postagem tem como alvo o p&#250;blico iniciante mas tamb&#233;m pode ser &#250;til para quem j&#225; possu&#237; experi&#234;ncia na linguagem mas nunca tinha trabalhado diretamente com envio e recebimento de emails.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://humberto.io/pt-br/blog/enviando-e-recebendo-emails-com-python/">
10 de August de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 28, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://paulohrpinheiro.xyz"
	   title="Paulo Henrique Rodrigues Pinheiro">
Blog do PauloHRPinheiro	</a>
      </h3>


    <div class="entrygroup"
         id="https://paulohrpinheiro.xyz/texts/python/2018-07-28-data-science-do-zero-conexoes-com-nossas-conexoes.html"
	   lang="pt-br"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-07-28-data-science-do-zero-conexoes-com-nossas-conexoes.html">
Continuando o livro Data Science do Zero	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Agora implementamos a busca por pessoas que possuam conex&#245;es com nossas conex&#245;es      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-07-28-data-science-do-zero-conexoes-com-nossas-conexoes.html">
28 de July de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 22, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://nullonerror.org/"
	   title="NULL on error">
Rodrigo Delduca	</a>
      </h3>


    <div class="entrygroup"
         id="https://nullonerror.org/2018/07/22/o-codigo-mais-bonito-que-ja-escrevi"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/rfQ2b_ck7N4/">
O c&#243;digo mais &#8220;bonito&#8221; que j&#225; escrevi f&#8217;#{self.ego}&#8217;	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Inspirado pelo projeto <a href="https://deepmind.com/blog/alphago-zero-learning-scratch/">AlphaGo</a>, um projeto que aprende a jogar Go sozinho usando <em>machine learning</em>, decidi criar um projeto semelhante, e o jogo escolhido foi&#8230; <em>O jogo da velha</em>!</p>

<p><img alt="hein?" class="center" src="https://nullonerror.org/public/2018-07-22-o-codigo-mais-bonito-que-ja-escrevi/old-lady.jpg" /></p>

<p>Pois &#233;&#8230;</p>

<h3 id="o-c&#243;digo">O c&#243;digo</h3>

<p>Antes de tudo eu precisava de uma grande quantidade de partidas para treinar a rede neural. Para isso, criei um pequeno <em>script</em> que gera jogas aleat&#243;rias com seus respectivos passos e resultado, eis o tal c&#243;digo:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">players</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">players</span><span class="p">)</span>
    <span class="n">player</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="n">players</span><span class="p">[:]</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">board</span><span class="o">.</span><span class="n">flatten</span><span class="p">())))</span>

        <span class="n">slots</span> <span class="o">=</span> <span class="p">(</span><span class="n">board</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">available_slots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">slots</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">available_slots</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'3'</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">board</span> <span class="o">==</span> <span class="n">player</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="nb">any</span><span class="p">()</span> <span class="o">|</span> <span class="n">mask</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="nb">any</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mask</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>
            <span class="k">break</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'0'</span><span class="p">)</span>

        <span class="n">picked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">available_slots</span><span class="p">)</span>
        <span class="n">board</span><span class="p">[</span><span class="n">picked</span> <span class="o">/</span> <span class="mi">3</span><span class="p">][</span><span class="n">picked</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
        <span class="n">next_player</span><span class="p">,</span> <span class="n">player</span> <span class="o">=</span> <span class="n">player</span><span class="p">,</span> <span class="n">next_player</span>
</code></pre></div></div>

<h3 id="passo-a-passo">Passo a passo</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">board</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">int</span><span class="p">)</span>  <span class="c"># Cria um "tabuleiro" 3x3 inicializado com zero.</span>
<span class="n">players</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c"># Cria os jogadores.</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">players</span><span class="p">)</span>  <span class="c"># Embaralha os jogadores.</span>
<span class="n">player</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="n">players</span><span class="p">[:]</span>  <span class="c"># Ap&#243;s embaralhar, separamos os jogadores j&#225; sorteados.</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>  <span class="c"># Imprime quem est&#225; jogando.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">board</span><span class="o">.</span><span class="n">flatten</span><span class="p">())))</span>  <span class="c"># Imprime o estado atual do tabuleiro.</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Filtra pelas posi&#231;&#245;es livres do tabuleiro.</span>
<span class="n">slots</span> <span class="o">=</span> <span class="p">(</span><span class="n">board</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">available_slots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">slots</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># Caso n&#227;o haja nenhuma posi&#231;&#227;o livre, declara empate e termina o `loop`.</span>
<span class="k">if</span> <span class="n">available_slots</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'3'</span><span class="p">)</span>
    <span class="k">break</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Esse trecho &#233; um pouco mais complexo, e gra&#231;as ao numpy</span>
<span class="c"># a verifica&#231;&#227;o do jogador vitoriosos &#233; mais simplificada.</span>

<span class="c"># Cria uma m&#225;scara em rela&#231;&#227;o o jogador atual e o tabuleiro.</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">board</span> <span class="o">==</span> <span class="n">player</span>

<span class="c"># Verifica a condi&#231;&#227;o de vit&#243;ria na horizontal e/ou vertical.</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="nb">any</span><span class="p">()</span> <span class="o">|</span> <span class="n">mask</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="nb">any</span><span class="p">()</span>

<span class="c"># Verifica a condi&#231;&#227;o de vit&#243;ria na diagonal.</span>
<span class="n">out</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">mask</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>

<span class="c"># Caso haja uma condi&#231;&#227;o que satisfa&#231;a a vit&#243;ria, imprime o jogador vitorioso.</span>
<span class="k">if</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">player</span><span class="p">))</span>
    <span class="k">break</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ningu&#233;m ganhou, o jogo continua.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'0'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Escolhe uma posi&#231;&#227;o do tabuleiro que esteja livre.</span>
<span class="n">picked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">available_slots</span><span class="p">)</span>

<span class="c"># Atribui o n&#250;mero do jogador ao lugar do tabuleiro sorteado.</span>
<span class="n">board</span><span class="p">[</span><span class="n">picked</span> <span class="o">/</span> <span class="mi">3</span><span class="p">][</span><span class="n">picked</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>

<span class="c"># Troca quem joga na pr&#243;xima intera&#231;&#227;o.</span>
<span class="n">next_player</span><span class="p">,</span> <span class="n">player</span> <span class="o">=</span> <span class="n">player</span><span class="p">,</span> <span class="n">next_player</span>
</code></pre></div></div>

<h3 id="a-sa&#237;da">A sa&#237;da</h3>

<p>O <em>script</em> escreve na sa&#237;da <code class="highlighter-rouge">stdout</code> o resultado de cada intera&#231;&#227;o, o formato de sa&#237;da &#233; este:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PTTTTTTTTTR
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">P</code> - Representa o jogador, sendo <strong>1</strong> ou <strong>2</strong>.</li>
  <li><code class="highlighter-rouge">T</code> - Indica o estado de cada posi&#231;&#227;o do tabuleiro, <strong>0</strong> caso esteja livre; <strong>1</strong> ou <strong>2</strong>* caso esteja preenchido.</li>
  <li><code class="highlighter-rouge">R</code> - Indica o resultado,  <strong>0</strong> caso ainda n&#227;o haja uma vit&#243;ria, <strong>3</strong> caso seja um empate ou <strong>1</strong> ou <strong>2</strong> caso um dos jogadores tenha vencido.</li>
</ul>

<h3 id="a-partida">A partida</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python generator.py

10000000000
20020000000
10021000000
20021200000
10021200100
20221200100
10221201100
20221201120
11221201121
</code></pre></div></div>

<p>No caso acima, o jogador  <strong>1</strong> iniciou a partida e acabou sendo o vitorioso. Vejamos outra partida:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python generator.py

20000000000
10000100000
20000120000
10000121000
20002121000
11002121000
21202121000
11202121100
21222121100
11222121113
</code></pre></div></div>

<p>Nessa partida o jogador <strong>2</strong> come&#231;ou e terminou em empate.</p>

<h3 id="pr&#243;ximos-passos">Pr&#243;ximos passos</h3>

<p>N&#227;o sei bem ao certo se irei usar <a href="https://keon.io/deep-q-learning/">deep reinforcement learning (deep Q-learning)</a> #recomendo ou algum outro m&#233;todo para este projeto, fiquem atentos aos pr&#243;ximos cap&#237;tulos.</p><div class="feedflare">
<a href="http://feeds.feedburner.com/~ff/NullOnError?a=rfQ2b_ck7N4:HIsDpg4Gbi8:yIl2AUoC8zA"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=yIl2AUoC8zA" /></a> <a href="http://feeds.feedburner.com/~ff/NullOnError?a=rfQ2b_ck7N4:HIsDpg4Gbi8:qj6IDK7rITs"><img border="0" src="http://feeds.feedburner.com/~ff/NullOnError?d=qj6IDK7rITs" /></a>
</div><img alt="" height="1" src="http://feeds.feedburner.com/~r/NullOnError/~4/rfQ2b_ck7N4" width="1" />Inspirado pelo projeto AlphaGo, um projeto que aprende a jogar Go sozinho usando machine learning, decidi criar um projeto semelhante, e o jogo escolhido foi&#8230; O jogo da velha!      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/NullOnError/~3/rfQ2b_ck7N4/">
	    por Rodrigo Delduca (rodrigodelduca@gmail.com) em
22 de July de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 16, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://blog.ricbit.com/"
	   title="Brain Dump">
Ricbit	</a>
      </h3>


    <div class="entrygroup"
         id="tag:blogger.com,1999:blog-6306509703738480474.post-671651719953727094"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://blog.ricbit.com/2018/07/as-figurinhas-dos-vingadores-sao.html">
As Figurinhas dos Vingadores s&#227;o Honestas? (parte 1)	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<div dir="ltr">O Brasil &#233; um pa&#237;s muito estranho. Uma das in&#250;meras bizarrices brasileiras &#233; que temos <b>tabus tempor&#225;rios</b>. Por exemplo, homem se vestir de mulher &#233; tabu (vai acabar com a fam&#237;lia, fim dos tempos, etc), mas no carnaval pode! Da mesma maneira, adulto comprando &#225;lbum de figurinhas &#233; tabu (precisa crescer, largar os brinquedos, etc.), mas em &#233;poca de Copa pode!<br /><br /><div class="separator"><a href="https://1.bp.blogspot.com/-UuOjTgBhRzQ/W0DqQ1SIkuI/AAAAAAACz8U/LxLLASl26z8nGA59MCrfF_D2wFHA7QGyQCLcBGAs/s1600/figurinhas.jpg"><img border="0" height="250" src="https://1.bp.blogspot.com/-UuOjTgBhRzQ/W0DqQ1SIkuI/AAAAAAACz8U/LxLLASl26z8nGA59MCrfF_D2wFHA7QGyQCLcBGAs/s320/figurinhas.jpg" width="320" /></a></div><br />Sempre que chega &#233;poca de Copa eu fico espantado com a dedica&#231;&#227;o que meus amigos tem para completar o &#225;lbum com os jogadores. E pensando um pouco no fen&#244;meno, me veio a d&#250;vida: quanto dinheiro voc&#234; precisa para terminar um &#225;lbum desses?<br /><br />Resolvi fazer um experimento para tentar calcular esse valor. Mas, ao inv&#233;s de usar o &#225;lbum da Copa, escolhi completar o &#225;lbum dos Vingadores, j&#225; que &#233; um universo que eu tenho mais afinidade. Os valores originais s&#227;o os seguintes:<br /><br /><ul><li>O <b>&#225;lbum</b> em si custa R$&nbsp;6.90, e voc&#234; precisa de 180 figurinhas para completar.&nbsp;</li><li>Cada <b>pacotinho</b> com 4 figurinhas custa R$&nbsp;1.20.</li><li>Existe um <b>kit</b> com&nbsp;<a href="https://photos.app.goo.gl/Wu7p4zEJdmMShLS48">15 pacotinhos</a>&nbsp;que voc&#234; pode comprar com desconto por R$&nbsp;13.90. Mas &#233; dif&#237;cil de achar: eu s&#243; encontrei na loja&nbsp;<a href="https://www.livrariacultura.com.br/c/geek">Geek</a> na av. Paulista.</li><li>Por fim, voc&#234; sempre pode pedir <b>figurinhas avulsas</b> no <a href="https://figurinhas.abril.com.br/">site da editora</a> (nesse caso voc&#234; pode comprar at&#233; 40 figurinhas com pre&#231;o individual&nbsp;de R$&nbsp;0.30, mais o frete de R$&nbsp;10.00).</li></ul><br />Se voc&#234; for uma pessoa sem imagina&#231;&#227;o, de cara j&#225; tem uma estrat&#233;gia f&#225;cil para completar o &#225;lbum: &#233; s&#243; pedir tudo pelo correio. Nesse caso, basta comprar o &#225;lbum e mais 180 figurinhas em 5 fretes, num total de R$110.90. <br /><br />Tem como gastar menos que isso? Para descobrir, temos que analisar as figurinhas! <br /><br /><h3>A Distribui&#231;&#227;o das Figurinhas</h3><br />Para descobrir a distribui&#231;&#227;o das figurinhas, eu comprei ##t=106## pacotinhos (ou seja, ##n=106\times 4=424## figurinhas), e anotei o conte&#250;do de cada um deles (os dados originais est&#227;o no <a href="https://docs.google.com/spreadsheets/d/1PMrtdJ3_mQF1dwjWQTvIVhtz1K3Vi7xxJITIRTtlgqg/edit?usp=sharing">google docs</a>). A primeira coisa que fiz foi tra&#231;ar o histograma para ver o jeit&#227;o dos dados: <br /><br /><div class="separator"><a href="https://1.bp.blogspot.com/-Kc4xVh0wJhQ/Wz_hIgAFJRI/AAAAAAACz7s/KoCmgUppw3EgkhSnoA6lKuO3yLG0bckrwCLcBGAs/s1600/histogram.png"><img border="0" height="204" src="https://1.bp.blogspot.com/-Kc4xVh0wJhQ/Wz_hIgAFJRI/AAAAAAACz7s/KoCmgUppw3EgkhSnoA6lKuO3yLG0bckrwCLcBGAs/s320/histogram.png" width="320" /></a></div>Pelo histograma d&#225; para ver que faltam nove figurinhas para completar meu &#225;lbum (s&#227;o os nove buracos no histograma). Por outro lado tem tr&#234;s figurinhas que repetiram 6 vezes, o que indica que possivelmente esse &#225;lbum n&#227;o &#233; honesto, j&#225; que algumas figurinhas s&#227;o mais f&#225;ceis que outras.<br /><br />Ou... talvez n&#227;o? <b>A intui&#231;&#227;o humana &#233; notoriamente falha em intuir probabilidades</b>, de repente essa impress&#227;o de que algumas figurinhas s&#227;o mais f&#225;ceis &#233; falsa. O jeito correto de decidir isso &#233; fazendo um <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">teste de hip&#243;tese</a>. O teste em si &#233; simples, mas eu vou fazer em c&#226;mera lenta caso algu&#233;m nunca tenha visto. <br /><br />Para come&#231;ar, precisamos de uma <a href="https://en.wikipedia.org/wiki/Null_hypothesis">hip&#243;tese nula</a> ##H_0## e um <a href="https://en.wikipedia.org/wiki/Statistical_significance">n&#237;vel de signific&#226;ncia</a> ##\alpha##. <br /><br />Nossa hip&#243;tese nula ##H_0## &#233; que as figurinhas tem <b>distribui&#231;&#227;o uniforme</b> e s&#227;o <b>independentes</b>. O teste vai nos falar se esse hip&#243;tese precisa ser rejeitada. O n&#237;vel de signific&#226;ncia n&#243;s podemos escolher, mas escolher o ##\alpha## &#233; uma arte: voc&#234; precisa levar em conta o n&#250;mero de amostras, e as taxas aceit&#225;veis de falsos positivos e falsos negativos. Usualmente, ##\alpha##=5% funciona bem. <br /><br />Qual o significado desses par&#226;metros? Fica simples de entender com um exemplo: suponha que todas as 424 figurinhas que eu comprei vieram repetidas. Em uma distribui&#231;&#227;o &#233; uniforme, isso n&#227;o &#233; imposs&#237;vel, mas &#233; extremamente improv&#225;vel: a chance &#233; de 1 em ##180^{424}\sim 1.7\times 10^{956}##. Esse valor &#233; maior que o n&#250;mero de &#225;tomos no universo (muito maior!), ent&#227;o a chance de ter acontecido ao acaso &#233; quase nula. <br /><br />Se eu tirasse 424 figurinhas repetidas, eu teria bastante convic&#231;&#227;o de que as figurinhas n&#227;o s&#227;o uniformes. Quando fazemos um teste de hip&#243;tese, &#233; essa ideia que estamos tentando capturar: os dados que coletamos s&#227;o t&#227;o raros que n&#227;o poderiam ter acontecido na pr&#225;tica? A chance de terem acontecido ao acaso &#233; menor que ##\alpha##=5%? Se for, ent&#227;o talvez a hip&#243;tese ##H_0## seja falsa.<br /><div class="separator"><a href="https://4.bp.blogspot.com/-EsKisoypt2Y/W0Ky70TIKeI/AAAAAAACz8o/hzdWjEi8KJ0WEwExQsA731JWMCJE4EpowCLcBGAs/s1600/figurinha_repetida.jpg"><img border="0" height="250" src="https://4.bp.blogspot.com/-EsKisoypt2Y/W0Ky70TIKeI/AAAAAAACz8o/hzdWjEi8KJ0WEwExQsA731JWMCJE4EpowCLcBGAs/s320/figurinha_repetida.jpg" width="320" /></a></div><br />Existem v&#225;rios testes de hip&#243;tese poss&#237;veis. Como queremos checar se nossas amostras seguem uma distribui&#231;&#227;o dada (uniforme), ent&#227;o o teste mais natural a se fazer &#233; o <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">teste do ##\chi^2##</a> (pronuncia-se quiquadrado), que serve justamente para verificar se duas distribui&#231;&#245;es s&#227;o iguais. <br /><br />Voc&#234; come&#231;a o teste do ##\chi^2## separando suas amostras em categorias. No nosso caso, o mais natural seria fazer cada figurinha ser uma categoria, mas isso n&#227;o vai funcionar. O motivo &#233; que o teste do ##\chi^2##, estritamente falando, s&#243; funciona com infinitas amostras. Como &#233; imposs&#237;vel coletar infinitas amostras, n&#243;s assumimos que o resultado n&#227;o muda muito de "infinitas amostras" para "muitas amostras". <br /><br />Mas quantas amostras s&#227;o "muitas amostras"? Em geral, a regra usada &#233; que ##np&gt;5##, onde ##n## &#233; o n&#250;mero de amostras e ##p## &#233; a menor probabilidade de uma amostra estar em uma categoria. Vamos fazer as contas: se cada figurinha &#233; uma amostra, e as 180 figurinhas s&#227;o uniformes, ent&#227;o ##p=1/180##. Como tenho ##n=424## figurinhas, ent&#227;o ##np=424/180\sim 2.35##. Oops, 2.35 &#233; menor que 5, ent&#227;o 180 categorias &#233; muito.<br /><div><br /></div><div>Vamos reduzir ent&#227;o. Eu vou escolher ##c=5## categorias, porque 180 divide certinho por 5. Cada categoria vai ter ##180/5=36## figurinhas, logo ##p=1/36## e ##np=424/36\sim 11.77##, agora sim! O histograma com cinco categorias &#233; assim:</div><div><br /></div><div class="separator"><a href="https://2.bp.blogspot.com/-Y6sGK_XOw7o/W0DTOcQF7GI/AAAAAAACz8I/LQr7WYvUTTcFFgNGcWgVKqVUlpbHn91DgCLcBGAs/s1600/uniform.png"><img border="0" height="209" src="https://2.bp.blogspot.com/-Y6sGK_XOw7o/W0DTOcQF7GI/AAAAAAACz8I/LQr7WYvUTTcFFgNGcWgVKqVUlpbHn91DgCLcBGAs/s320/uniform.png" width="320" /></a></div><div><br /></div><div>Agora n&#243;s vamos tabelar nossas amostras. A linha <i>Observado</i> mostra quantas amostras n&#243;s coletamos em cada categoria, a linha <i>Esperado</i> mostra quantas amostras uma distribui&#231;&#227;o ideal teria (no caso uniforme, todas s&#227;o iguais a ##n/c=424/5=84.8##):<br /><br /></div><div class="post-table"><table><tbody><tr></tr><tr><th></th><th>Categoria 1</th><th>Categoria 2</th><th>Categoria 3</th><th>Categoria 4</th><th>Categoria 5</th></tr><tr><td><b>Observado</b></td><td>75</td><td>90</td><td>80</td><td>95</td><td>84</td></tr><tr><td><b>Esperado</b></td><td>84.8</td><td>84.8</td><td>84.8</td><td>84.8</td><td>84.8</td></tr></tbody></table></div><div><br /></div><div>Podemos calcular o ##\chi^2## agora. A intui&#231;&#227;o do teste &#233; simples, vamos calcular qual o quadrado da diferen&#231;a entre o observado e o esperado, e normalizar. Se esse n&#250;mero for muito grande, ent&#227;o tem algo errado. Calculando pela f&#243;rmula, temos:<br /><br />$$\chi^2=\sum\frac{(Y_i-E_i)^2}{E_i}\sim 2.957$$<br />Esse valor, 2.957 &#233; grande ou &#233; pequeno? Para decidir isso precisamos primeiro calcular quantos <a href="https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)">graus de liberdade</a> tem esse modelo. O n&#250;mero de graus de liberdade &#233; o n&#250;mero de par&#226;metros que estamos estimando. Como nossa tabela tem 5 categorias, ent&#227;o o n&#250;mero de graus de liberdade &#233; 4.<br /><br />Opa! Se s&#227;o 5 categorias, n&#227;o tinha que ser 5 graus de liberdade? &#201; verdade que estamos tentando estimar ##Y_1##, ##Y_2##, ##Y_3##, ##Y_4## e ##Y_5##. Mas n&#243;s sabemos que a soma de todos eles &#233; ##n##, ent&#227;o se tivermos os quatro primeiros, o quinto &#233; s&#243; calcular!<br /><br />Em tempos idos esse era o momento em que voc&#234; precisava sacar do bolso uma tabela de ##\chi^2## (como curiosidade, coloquei online a <a href="https://drive.google.com/file/d/1Ex81nVxpF44jh9yEbeMjWXRBD8mWKDqi/view?usp=sharing">tabela que eu usava na Poli</a>). Mas hoje em dia voc&#234; pode ir direto no Mathematica para descobrir o valor de ##\chi^2## com ##\alpha##=5% e quatro graus de liberdade:<br /><pre class="prettyprint">InverseCDF[ChiSquareDistribution[4], 1 - 0.05]<br />&gt;&gt; 9.48773<br /></pre><br />Como 2.957 &#233; menor que 9.488, ent&#227;o n&#227;o podemos rejeitar a hip&#243;tese de que as figurinhas s&#227;o uniformes e independentes, e conclu&#237;mos que <b>sim, as figurinhas provavelmente s&#227;o honestas</b>. <br /><br />Alguns de voc&#234;s ir&#227;o chiar, eu sei. "Mas veja, algumas figurinhas sa&#237;ram repetidas seis vezes, outras n&#227;o apareceram nenhuma vez! N&#227;o tem como isso ser uniforme, claramente tem figurinhas que s&#227;o mais f&#225;ceis!".<br /><br />Bem, se voc&#234; ainda estiver na d&#250;vida, voc&#234; pode comprar mais pacotinhos para deixar o teste mais robusto. Ao inv&#233;s disso, eu vou usar s&#243; as figurinhas que eu tenho para ir direto na raiz da d&#250;vida: afinal de contas, &#233; normal tirar muitas figurinhas repetidas?<br /><br /><h3>A An&#225;lise das Repetidas</h3><br />A intui&#231;&#227;o nos diz que, em uma distribui&#231;&#227;o uniforme, todas as figurinhas tem que aparecer mais ou menos com a mesma frequ&#234;ncia. S&#243; que esse &#233; mais um caso onde <b>a intui&#231;&#227;o &#233; falha</b>! Quem l&#234; o blog h&#225; mais tempo deve lembrar de um <a href="http://blog.ricbit.com/2010/11/sorteios-e-aniversarios.html">post sobre o paradoxo do anivers&#225;rio</a>, que diz exatamente isso: mesmo em distribui&#231;&#245;es uniformes, a chance de colis&#245;es &#233; muito alta.<br /><br />Podemos usar esse fato para tentar um novo teste de hip&#243;tese. Dessa vez, vamos contar quantas repetidas n&#243;s temos para cada figurinha, e separ&#225;-las por n&#250;mero de repeti&#231;&#245;es. O histograma da quantidade de figurinhas repetidas fica assim:<br /><br /><div class="separator"><a href="https://2.bp.blogspot.com/-cIFBJOyNxHs/W0Lps4JpHLI/AAAAAAACz80/tiauGREj_-UrK9E50yeeNJOAB0-H9bB_wCLcBGAs/s1600/repetidas.png"><img border="0" height="209" src="https://2.bp.blogspot.com/-cIFBJOyNxHs/W0Lps4JpHLI/AAAAAAACz80/tiauGREj_-UrK9E50yeeNJOAB0-H9bB_wCLcBGAs/s320/repetidas.png" width="320" /></a></div><br />O histograma foi tra&#231;ado da quantidade de figurinhas repetidas:<br /><br /><div class="post-table"><table><tbody><tr></tr><tr><th><b>Quantidade de repeti&#231;&#245;es</b></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr><tr><td><b>Figurinhas</b></td><td>9</td><td>41</td><td>50</td><td>48</td><td>24</td><td>5</td><td>3</td></tr></tbody></table></div><div><br /></div>O &#225;lbum tem 180 figurinhas, ent&#227;o a soma da segunda linha vale 180. Do total de figurinhas, nove delas n&#227;o apareceram, tr&#234;s apareceram 6 vezes, e a maioria apareceu entre 1 e 3 vezes.<br /><br />O formato do histograma parece familiar n&#233;? Se n&#243;s soub&#233;ssemos qual a &#233; a f&#243;rmula exata para o n&#250;mero de figurinhas repetidas em uma distribui&#231;&#227;o uniforme, poder&#237;amos usar o teste do ##\chi^2## para ver se a hip&#243;tese ainda se mant&#233;m. S&#243; que agora n&#227;o tem jeito, para descobrir a f&#243;rmula precisamos fazer as contas. Pule a caixa azul se voc&#234; tem medo de combinat&#243;ria:<br /><br /><div class="caixa-azul">O truque para usar <a href="https://en.wikipedia.org/wiki/Symbolic_method_(combinatorics)">combinat&#243;ria anal&#237;tica</a> numerada (<i>labelled</i>) &#233; sempre tentar achar um isomorfismo entre o seu problema e uma lista de inteiros. Para o nosso caso, imagine o seguinte experimento: temos ##n## bolinhas numeradas de ##1## a ##n##, e temos tamb&#233;m ##m## caixinhas, cada caixa representando uma figurinha. A bolinha representa a ordem em que eu comprei a figurinha. Se eu atirar as bolinhas em caixas aleat&#243;rias, tenho um problema isom&#243;rfico a comprar figurinhas aleat&#243;rias.<br /><br />Por exemplo: se a bolinha 5 cair na caixa 32, ent&#227;o significa que a quinta figurinha que eu comprei foi a de n&#250;mero 32. Se no fim do experimento a caixa 32 tiver seis bolinhas, ent&#227;o eu tenho a figurinha 32 repetida seis vezes.<br /><br />No nosso experimento, as caixinhas s&#227;o diferentes umas das outras, ent&#227;o vamos usar o operador ##\text{SEQ}_m(z)## para modelar as caixinhas. A ordem das bolinhas dentro da caixinha n&#227;o importa (tanto faz se dissermos que a caixa 32 tem as bolinhas 3, 5, 9, 10 e 15; ou se tiver as bolinhas 9, 5, 3, 15, e 10, &#233; a mesma coisa). Ent&#227;o dentro das caixinhas, usaremos o operador ##\text{SET}(z)##. O experimento completo &#233; ##\text{SEQ}_m(\text{SET}(z))##.<br /><br />Digamos que estamos interessados em saber quantas caixinhas v&#227;o terminar com ##s## bolinhas. Um jeito de medir isso &#233; colocar um marcador nas caixinhas com ##s## elementos. Para isso, n&#243;s tiramos as das caixinhas os conjuntos de ##s## elementos, e colocamos eles de volta com o marcador, digamos que o marcador seja ##u##. Ent&#227;o o experimento para medir ##s## repetidas &#233; ##\text{SEQ}_m(\text{SET}(z)-\text{SET}_s(z)+u \text{SET}_s(z))##.<br /><br />Os experimentos v&#227;o mapear para <a href="https://en.wikipedia.org/wiki/Generating_function#Exponential_generating_function_(EGF)">fun&#231;&#245;es geradoras exponenciais</a> de duas vari&#225;veis. Das tabelas de combinat&#243;ria anal&#237;tica:<br />$$\begin{align*}<br />\text{SEQ}_m(z) &amp;= z^m \\<br />\text{SET}(z) &amp;= e^z \\<br />\text{SET}_s(z) &amp;= \frac{z^s}{s!}\\<br />\text{SEQ}_m(\text{SET}(z)-\text{SET}_s(z)+u \text{SET}_s(z)) &amp;=<br />\left(e^z-\frac{z^s}{s!}+u \frac{z^s}{s!}\right)^m \\<br />&amp;= \left(e^z+ (u-1) \frac{z^s}{s!}\right)^m<br />\end{align*}$$ <br />Se abrirmos essa fun&#231;&#227;o geradora em s&#233;rie, ent&#227;o o coeficiente do termo ##z^n u^k## indica quantas combina&#231;&#245;es poss&#237;veis de ##n## bolinhas v&#227;o ter ##k## caixinhas com ##s## bolinhas repetidas (como a fun&#231;&#227;o geradora &#233; exponencial, voc&#234; precisa multiplicar o coeficiente por ##n!## para ter o valor real). Se chamarmos esse coeficiente de ##R_s(n, k)##, ent&#227;o temos:<br />$$\sum_{n}\sum_{k}R_s(n,k) z^n u^k = \left(e^z+ (u-1) \frac{z^s}{s!}\right)^m $$<br />Vamos listar com cuidado o que temos. ##n! R_s(n,k)## &#233; n&#250;mero de combina&#231;&#245;es poss&#237;veis com ##k## caixinhas contendo exatamente ##s## bolinhas. Logo, de todas as combina&#231;&#245;es poss&#237;veis de ##n## bolinhas, existem ##\sum k n! R_s(n,k)## caixinhas com ##s## bolinhas.<br /><br />Por outro lado, o n&#250;mero total de combina&#231;&#245;es de ##n## bolinhas em ##m## caixinhas &#233; ##m^n##. Como cada combina&#231;&#227;o dessas tem ##m## caixinhas, ent&#227;o o n&#250;mero total de caixinhas que podem ser preenchidas em todas as combina&#231;&#245;es &#233; ##m^{n+1}##.<br /><br />Juntando as duas contagens, a probabilidade de um caixinha tem ##s## bolinhas em ##n## arremessos &#233;:<br />$$p_s(n)=\sum_{k&gt;0}\frac{k \;n!}{m^{n+1}}R_s(n, k)$$<br />Mas olha s&#243;! N&#243;s podemos conseguir essa somat&#243;ria derivando a fun&#231;&#227;o geradora em rela&#231;&#227;o a ##u##, e depois setando ##u=1##.<br />$$\left.\frac{\partial}{\partial u}\sum_{n}\sum_{k}R_s(n,k) z^n u^k \right|_{u=1}=\sum_n \sum_{k}k R_s(n,k) z^n$$<br />Agora &#233; s&#243; fazer as contas:<br />$$\begin{align*}p_s(n)<br />&amp;=\sum_k \frac{n!}{m^{n+1}}k R_s(n, k) \\<br />&amp;=\frac{n!}{m^{n+1}} [z^n] \left.\frac{\partial}{\partial u}\sum_{n}\sum_{k}R_s(n,k) z^n u^k \right|_{u=1}\\<br />&amp;=\frac{n!}{m^{n+1}} [z^n] \left.\frac{\partial}{\partial u}\left(e^z+ (u-1) \frac{z^s}{s!}\right)^m&nbsp;&nbsp;\right|_{u=1}\\<br />&amp;=\frac{n!}{m^{n+1}} [z^n] \left. m\left(e^z+ (u-1) \frac{z^s}{s!}\right)^{m-1} \frac{z^s}{s!} \right|_{u=1}\\<br />&amp;=\frac{n!}{m^{n+1}} [z^n]&nbsp; m\left(e^z\right)^{m-1} \frac{z^s}{s!} \\<br />&amp;=\frac{n!}{s!\;m^n} [z^n]z^s e^{z(m-1)}\\<br />\end{align*}$$ <br /><div>Abrindo a exponencial em s&#233;rie:</div>$$\begin{align*}p_s(n)<br />&amp;=\frac{n!}{s!\;m^{n}} [z^n]z^s\sum_{k\ge 0}\frac{(z(m-1))^k}{k!} \\ &amp;=\frac{n!}{s!\;m^{n}} [z^n]\sum_{k\ge 0}\frac{z^{k+s}(m-1)^k}{k!} \\ &amp;=\frac{n!}{s!\;m^{n}} [z^n]\sum_{p\ge s}\frac{z^p(m-1)^{p-s}}{(p-s)!} \\ &amp;=\frac{n!}{s!\;m^{n}}\; \frac{(m-1)^{n-s}}{(n-s)!} \\ &amp;=\frac{n!}{s!(n-s)!}\; \frac{(m-1)^{n-s}}{m^{n}} \\ &amp;={{n}\choose{s}}\frac{(m-1)^{n-s}}{m^{n}} \\ \end{align*}$$ <br />Essa &#233; a solu&#231;&#227;o exata, em forma fechada, que quer&#237;amos! Mas tem uma massagem que podemos fazer que vai ajudar a entender por que essa f&#243;rmula &#233; assim. Em geral ##n## &#233; bem maior que ##m##, ent&#227;o vamos reescrever ##m## de modo que ##n=\lambda m##, e calcular o limite quando ##n## &#233; muito grande: $$\begin{align*}\lim_{n\to\infty}p_s(n) &amp;=\lim_{n\to\infty}\frac{n!}{s!(n-s)!}\; \frac{(n/\lambda-1)^{n-s}}{(n/\lambda)^{n}} \\ &amp;=\lim_{n\to\infty}\frac{n!}{s!(n-s)!}\; \left(\frac{n-\lambda}{\lambda}\right)^{n-s} \left(\frac{\lambda}{n}\right)^{n}\\ &amp;=\lim_{n\to\infty}\frac{n!}{s!(n-s)!}\; \lambda^{s} \left(\frac{n-\lambda}{n}\right)^{n-s}\left(\frac{1}{n}\right)^{s} \\ &amp;=\lim_{n\to\infty}\frac{n!\;\lambda^{s}}{s!(n-s)!\;n^{s}}\; \left(1-\frac{\lambda}{n}\right)^{n-s}\\ &amp;=\lim_{n\to\infty}\left(\frac{\lambda^{s}}{s!}\right) \left(\frac{n!}{(n-s)!\;n^s}\right) \left(1-\frac{\lambda}{n}\right)^{n} \left(1-\frac{\lambda}{n}\right)^{-s} \\ \end{align*}$$ O limite do produto &#233; o produto dos limites, desde que todos existam e sejam finitos, ent&#227;o vamos conferir um por um. O primeiro termo &#233; constante, easy. No segundo, o numerador &#233; um polin&#244;mio de grau ##n##, o denominador &#233; um polin&#244;mio de grau ##n##, ent&#227;o a fra&#231;&#227;o &#233; constante e vale 1, j&#225; que os coeficientes iniciais ambos valem 1. O terceiro &#233; a defini&#231;&#227;o de ##e^{-\lambda}##. No quarto a segunda fra&#231;&#227;o vai para zero, ent&#227;o o total tende a 1. Combinando tudo: $$\lim_{n\to\infty}p_s(n)= e^{-\lambda}\frac{\lambda^s}{s!}$$ Ah&#225;, &#233; uma distribui&#231;&#227;o de Poisson! </div><br />N&#227;o foi &#224; toa que aquele histograma das figurinhas repetidas parecia familiar, elas seguem uma <a href="https://en.wikipedia.org/wiki/Poisson_distribution">distribui&#231;&#227;o de Poisson</a>! Em retrospecto at&#233; faz sentido. Se a distribui&#231;&#227;o das figurinhas &#233; uniforme, ent&#227;o em um longo per&#237;odo de tempo, cada figurinha deve ter uma taxa de apari&#231;&#227;o constante (igual a ##\lambda=n/m##). Se a taxa &#233; constante ao longo do tempo, ent&#227;o a quantidade de figurinhas em um pequeno intervalo tem que seguir a distribui&#231;&#227;o de Poisson.<br /><br />Agora falta pouco para conseguir usar o teste do ##\chi^2## nas repetidas. Precisamos primeiro separar as amostras em categorias. O natural seria usar uma categoria por quantidade de repetidas, mas em teoria, um cara muito azarado poderia ter 424 figurinhas repetidas, e nesse caso o produto ##np## seria muito, muito menor que 5. Vamos ent&#227;o aglutinar todas as categorias de 6 repetidas em diante em um grupo s&#243;. A tabela fica assim:<br /><br /><div class="post-table"><table><tbody><tr></tr><tr><th><b>Quantidade de repeti&#231;&#245;es</b></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6 ou mais</th></tr><tr><td><b>Figurinhas, medido</b></td><td>9</td><td>41</td><td>50</td><td>48</td><td>24</td><td>5</td><td>3</td></tr><tr><td><b>Figurinhas, te&#243;rico</b></td><td>17.1</td><td>40.2</td><td>47.4</td><td>37.2</td><td>21.9</td><td>10.3</td><td>5.9</td></tr></tbody></table></div><br />Agora podemos calcular o ##\chi^2## medido e o te&#243;rico, lembrando que temos 6 graus de liberdade e ##\alpha## valendo 5%: $$\chi^2=\sum\frac{(Y_i-E_i)^2}{E_i}\sim 11.5275$$ <br /><pre class="prettyprint">InverseCDF[ChiSquareDistribution[6], 1 - 0.05]<br />&gt;&gt; 12.59<br /></pre>Conclus&#227;o: como 11.53 &#233; menor que 12.59, ent&#227;o novamente n&#227;o podemos rejeitar a hip&#243;tese de que as figurinhas s&#227;o uniformes e independentes, e conclu&#237;mos que <b>sim, as figurinhas provavelmente s&#227;o honestas</b>. &#201; verdade que tem muitas repetidas, mas o n&#250;mero de repetidas est&#225; dentro do esperado. <br /><br /><h3>Quanto gastar para completar?</h3><br />No p&#341;oximo post, vamos finalmente calcular qual o minimo de dinheiro que voc&#234; precisa gastar para completar o &#225;lbum. Stay tuned! <br /></div></div><div class="blogger-post-footer">
</div>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://blog.ricbit.com/2018/07/as-figurinhas-dos-vingadores-sao.html">
	    por Ricardo Bittencourt (noreply@blogger.com) em
16 de July de 2018 &#224;s 19:11	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>July 09, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://paulohrpinheiro.xyz"
	   title="Paulo Henrique Rodrigues Pinheiro">
Blog do PauloHRPinheiro	</a>
      </h3>


    <div class="entrygroup"
         id="https://paulohrpinheiro.xyz/texts/python/2018-07-09-mockando-o-que-tah-meio-mockado.html"
	   lang="pt-br"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-07-09-mockando-o-que-tah-meio-mockado.html">
Mockando o que t&#225; meio mockado	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Um mock especial para Python unittest      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://paulohrpinheiro.xyz/texts/python/2018-07-09-mockando-o-que-tah-meio-mockado.html">
09 de July de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>June 28, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="http://brunorocha.org/"
	   title="BrunoRocha.org | Python web development | Tag pyplanet | feed">
Bruno Cezar Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="http://brunorocha.org/python/flask/announcing-the-first-flask-conference-in-brazil-august-2018.html"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://brunorocha.org/python/flask/announcing-the-first-flask-conference-in-brazil-august-2018.html">
Announcing the first Flask Conference in Brazil - August 2018	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
<p>Hello,</p>
<p>The first Flask conference will be held in S&#227;o Paulo, Brazil, on August 24 and 25, 2018.</p>
<p>It will be a day of tutorial and a day of lectures for over 160 people.</p>
<p>At this moment the organization is in search of sponsorship to enable the coming of one of the core-developers to be Keynote of this event.</p>
<p>According to StackShare [1] more than 1.6k of companies are using Flask, large companies like Uber, Netflix, Cloudify, Lift, Red Hat and many others rely on Flask to serve web applications and APIs.</p>
<p>We believe it is time for Flask to have its annual conference and we are starting in S&#227;o Paulo Brazil and we hope this idea will spread to other places in the world!</p>
<p>Please help!</p>
<p>We need sponsorship:
Help us by sharing the link below with companies that can support the event:</p>
<p><a href="https://2018.flask.python.org.br/FlaskConf2018-sponsorship-en.pdf">https://2018.flask.python.org.br/FlaskConf2018-sponsorship-en.pdf</a></p>
<p>Submit lectures (or vote in the lectures) - * The event is in Brazil but participants from anywhere in the world are warmly welcomed! And lectures in English will also be interesting!</p>
<p><a href="https://speakerfight.com/events/flaskconf-2018/">https://speakerfight.com/events/flaskconf-2018/</a></p>
<p>Come to Flask Conf 2018!</p>
<p><a href="https://www.eventbrite.com/e/flask-conf-registration-46990838864">https://www.eventbrite.com/e/flask-conf-registration-46990838864</a></p>
<p>Flask Conf 2018
<a href="https://2018.flask.python.org.br/">https://2018.flask.python.org.br/</a></p>
<p>[1] <a href="https://stackshare.io/flask/in-stacks/">https://stackshare.io/flask/in-stacks/</a></p>      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://brunorocha.org/python/flask/announcing-the-first-flask-conference-in-brazil-august-2018.html">
	    por Bruno Rocha em
28 de June de 2018 &#224;s 19:07	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>June 19, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://humberto.io/pt-br/tags/python/"
	   title="python on Humberto Rocha">
Humberto Rocha	</a>
      </h3>


    <div class="entrygroup"
         id="https://humberto.io/pt-br/blog/tldr-dependencias-dev-python-no-ubuntu/"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://humberto.io/pt-br/blog/tldr-dependencias-dev-python-no-ubuntu/">
TLDR: Depend&#234;ncias Dev Python no Ubuntu	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Algumas bibliotecas do python como a que usamos para conversar um banco SQLite s&#227;o na pr&#225;tica um encapsulamento de um bin&#225;rio externo. Nestes casos precisamos que eles estejam instalados em nosso sistema operacional para que determinado pacote python funcione.
Quando isso acontece, recebemos erros como este:
ImproperlyConfigured: Error loading either pysqlite2 or sqlite3 modules (tried in that order): No module named _sqlite3 Para resolver estes problemas basta instalar esta depend&#234;ncia externa que normalmente o sistema j&#225; reconfigura tudo para voc&#234;, mas para quem trabalha m&#250;ltiplas vers&#245;es do python e com pyenv &#233; preciso recompilar todas as vers&#245;es do python toda vez que lembra de uma depend&#234;ncia externa.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://humberto.io/pt-br/blog/tldr-dependencias-dev-python-no-ubuntu/">
19 de June de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>June 15, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://avelino.run/blog/"
	   title="Blogs on Avelino">
Thiago Avelino	</a>
      </h3>


    <div class="entrygroup"
         id="https://avelino.run/realizando-sonho-de-trabalhar-full-time-com-open-source/"
	   lang="en-us"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/UoZC4n3zJtU/">
Realizando sonho de trabalhar full time com Open Source	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
&#201; extremamente comum ver amigos que come&#231;am a contribuir com open source quererem arrumar um &#8220;emprego&#8221; para passar o dia contribuindo com o projeto (em geral, deixando o Github verdinho&hellip;). Ser&#225; que &#233; realmente legal, como muitos imaginam, trabalhar para uma empresa para s&#243; contribuir com open source?
Costumo dizer que contribuir com open source &#233; viciante, faz voc&#234; passar horas e horas entendendo o projeto que algu&#233;m (ou alguma empresa) idealizou, at&#233; que chega o momento de mandar o primeiro PR (pull request, patch e etc) e defender sua implementa&#231;&#227;o.<img alt="" height="1" src="http://feeds.feedburner.com/~r/pyavelino/~4/UoZC4n3zJtU" width="1" />      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="http://feedproxy.google.com/~r/pyavelino/~3/UoZC4n3zJtU/">
15 de June de 2018 &#224;s 00:00	</a>
      </p>
    </div>
  </div>


        </div>
        </div>
      <div class="daygroup">
      <h2>June 05, 2018</h2>

      <div class="channelgroup">

      <h3>
        <a href="https://www.vinta.com.br/blog/category/python/"
	   title="Vinta's Blog Python Tag">
Vinta Software	</a>
      </h3>


    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/46Don't forget the stamps: testing email content in Django46"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2017/dont-forget-stamps-testing-email-content-django/">
Don't forget the stamps: testing email content in Django	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
When developing a web app how often do you check the emails you send are all working properly? Not as often as your web pages, right? That's ok, don't feel guilty, emails are hard to test and they are often someone's else responsibility to write and take care. This doesn't mean we should give up on them. There are some things we can do to prevent e      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2017/dont-forget-stamps-testing-email-content-django/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/73Taming Irreversibility with Feature Flags (in Python)73"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/taming-irreversibility-feature-flags-python/">
Taming Irreversibility with Feature Flags (in Python)	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Feature Flags are a very simple technique to make features of your application quickly toggleable. The way it works is, everytime we change some behavior in our software, a logical branch is created and this new behavior is only accessible if some specific configuration variable is set or, in certain cases, if the application context respects some      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/taming-irreversibility-feature-flags-python/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/71Dealing with resource-consuming tasks on Celery71"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/dealing-resource-consuming-tasks-celery/">
Dealing with resource-consuming tasks on Celery	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
In this post, we will talk about how you can optimize your Celery tasks and avoid certain kind of problems related to resource-consuming tasks. If you are new to Celery or want to know more about it before reading this, you might wanna check first this post with an overview about Celery and this one with some more advanced tips and tricks.

When w      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/dealing-resource-consuming-tasks-celery/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/69Celery in the wild: tips and tricks to run async tasks in the real world69"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2018/celery-wild-tips-and-tricks-run-async-tasks-real-world/">
Celery in the wild: tips and tricks to run async tasks in the real world	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
This post is aimed at people with some experience writing async taks, if you are starting on Celery you might want to read this other post I wrote before starting on this one. 

The thing about async tasks is that the hard part is not how to run them [although it can be fairly complicated to understand the architecture and set up things when you      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2018/celery-wild-tips-and-tricks-run-async-tasks-real-world/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="65Celery: an overview of the architecture and how it works65"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2017/celery-overview-archtecture-and-how-it-works/">
Celery: an overview of the architecture and how it works	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Asynchronous task queues are tools to allow pieces of a software program to run in a separate machine/process. It is often used in web architectures as way to delegate long lasting tasks while quickly answering requests. The delegated task can trigger an action such as sending an email to the user or simply update data internally in the system whe      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2017/celery-overview-archtecture-and-how-it-works/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/64[pt-BR] PythonBrasil[13] Talks64"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2017/pt-br-pythonbrasil13-talks/">
[pt-BR] PythonBrasil[13] Talks	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Vinhemos para a Python Brasil novamente. Dessa vez aprovamos 6 palestras. Indo desde Python para uso cient&#237;fico at&#233; t&#233;cnicas para salvar grandes projetos.      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2017/pt-br-pythonbrasil13-talks/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/54PyCon US 2017: the biggest Python Event in the World54"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2017/pycon-us-2017-the-biggest-python-event/">
PyCon US 2017: the biggest Python Event in the World	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Pycon 2017 happened in Oregon, Portland! If you wanted to discuss anything about Python, that was the place to be. It was the biggest Python event of the world, it lasted from May 17th to May 25th. I got to see talks from some important names on it, like Lisa Guo and Katy Huff, both of them are using Python to make great things! Lisa is using on In      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2017/pycon-us-2017-the-biggest-python-event/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>




    <div class="entrygroup"
         id="https://www.vinta.com.br/python/feed/48Advanced Django querying: sorting events by date48"
	   lang="en"
>

<!-- google_ad_section_start -->
      <h4
>
        <a href="https://www.vinta.com.br/blog/2017/advanced-django-querying-sorting-events-date/">
Advanced Django querying: sorting events by date	</a>
      </h4>

    <div class="entry">
      <div class="content"
>
Imagine the situation where our application has events (scheduled tasks, appointments, python conferences across the world) happening in different moments of time. Almost anything with a date attached to it. We want to display them in a simple list to the user. Given we are in February 2017 (the date this post was written), what would be the best w      </div>
<!-- google_ad_section_end -->

      <p class="date">
        <a href="https://www.vinta.com.br/blog/2017/advanced-django-querying-sorting-events-date/">
05 de June de 2018 &#224;s 12:49	</a>
      </p>
    </div>
  </div>



</div>

</div>


<div class="sidebar">
    <h2>Participantes</h2>
    <ul>
        <li>
	  <a href="http://blog.aboutwilson.net/feeds/python.rss.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  class="message" title="internal server error">AboutWilson.net</a>
        </li>
        <li>
	  <a href="http://blog.alienretro.com/category/python-2/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.alienretro.com"  class="message" title="404: not found">Alien Retro</a>
        </li>
        <li>
	  <a href="http://allissonazevedo.com/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  title="">Allison Azevedo</a>
        </li>
        <li>
	  <a href="http://aprenda-python.blogspot.com/atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://aprenda-python.blogspot.com/"  title="Aprenda Python">Aprenda Python</a>
        </li>
        <li>
	  <a href="http://aimotion.blogspot.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://aimotion.blogspot.com/"  title="Artificial Intelligence in Motion">Artificial Intelligence in Motion</a>
        </li>
        <li>
	  <a href="https://paulohrpinheiro.xyz/texts/python/feed.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://paulohrpinheiro.xyz"  title="Paulo Henrique Rodrigues Pinheiro">Blog do PauloHRPinheiro</a>
        </li>
        <li>
	  <a href="http://brunorocha.org/tag/pyplanet.atom" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://brunorocha.org/"  title="BrunoRocha.org | Python web development | Tag pyplanet | feed">Bruno Cezar Rocha</a>
        </li>
        <li>
	  <a href="http://catholabs.com/index.php/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://catholabs.com"  class="message" title="internal server error">Catho Labs</a>
        </li>
        <li>
	  <a href="https://christiano.me/category/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://christiano.me"  title="python | Christiano Anderson">Christiano Anderson</a>
        </li>
        <li>
	  <a href="http://www.diego-garcia.info/python.atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  class="message" title="404: not found">Diego Garcia</a>
        </li>
        <li>
	  <a href="http://feeds.feedburner.com/dmmartins" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://dmmartins.appspot.com/"  title="Diego Manenti Martins' blog">Diego Manenti Martins</a>
        </li>
        <li>
	  <a href="http://feeds.feedburner.com/dirceuinfopython" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pipes.yahoo.com/pipes/pipe.info?_id=4hrQ3vtp3RGmZZNH_w6H4A"  title="dirceu.info -&gt; python">Dirceu Tiegs</a>
        </li>
        <li>
	  <a href="http://blog.elcio.com.br/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  class="message" title="internal server error">Elcio Luiz Ferreira</a>
        </li>
        <li>
	  <a href="https://medium.com/feed/@ellisonleao" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://medium.com/@ellisonleao?source=rss-19283a30fdd1------2"  title="Stories by Ellison Le&#227;o on Medium">Ellison Le&#227;o</a>
        </li>
        <li>
	  <a href="https://ericstk.wordpress.com/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://ericstk.wordpress.com"  title="Aprendendo Python">Eric Hideki</a>
        </li>
        <li>
	  <a href="http://www.erico.com.br/blog/categories/python/RSS" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://www.erico.com.br"  title="Python">Erico Andrei</a>
        </li>
        <li>
	  <a href="http://livingintheshell.com/feeds/all.atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://livingintheshell.com/"  title="livingintheshell">Fernando Rocha</a>
        </li>
        <li>
	  <a href="http://blog.filipesaraiva.info/?feed=rss2&amp;tag=planeta-python-brasil" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.filipesaraiva.info"  title="planeta-python-brasil &#8211; Filipe Saraiva's blog">Filipe Saraiva</a>
        </li>
        <li>
	  <a href="http://blog.flavioribeiro.com/rss/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.flavioribeiro.com/"  title="Fl&#225;vio Ribeiro">Flavio Ribeiro</a>
        </li>
        <li>
	  <a href="http://pyinsci.blogspot.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pyinsci.blogspot.com/"  title="Python in Science">Fl&#225;vio Coelho</a>
        </li>
        <li>
	  <a href="https://f.souza.cc/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://f.souza.cc/"  title="Francisco Souza">Francisco Souza</a>
        </li>
        <li>
	  <a href="https://blog.luizirber.org/atom.xml?tag=python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://blog.luizirber.org/"  title="Gabbleblotchits">Gabbleblotchits</a>
        </li>
        <li>
	  <a href="http://gilenofilho.com.br/tag/python/rss/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  title="">Gileno Filho</a>
        </li>
        <li>
	  <a href="http://df.python.org.br/blog/feeds.atom" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://grupydf.github.io/"  title="Grupy-DF">Grupy-DF</a>
        </li>
        <li>
	  <a href="https://blog.labix.org/feed" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://blog.labix.org"  title="Labix Blog">Gustavo Niemeyer</a>
        </li>
        <li>
	  <a href="http://henriquebastos.net/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://henriquebastos.net/python-decouple-2-2-strict-separation-of-settings-from-code/python/"  class="message" title="404: not found">Henrique Bastos</a>
        </li>
        <li>
	  <a href="https://humberto.io/pt-br/tags/python/index.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://humberto.io/pt-br/tags/python/"  title="python on Humberto Rocha">Humberto Rocha</a>
        </li>
        <li>
	  <a href="http://techberto.wordpress.com/tag/python/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  title="">Inno::Blog</a>
        </li>
        <li>
	  <a href="http://www.programeempython.com.br/blog/feeds/rss/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  class="message" title="internal server error">Julio Cesar Eiras Melanda</a>
        </li>
        <li>
	  <a href="http://junglecoders.blogspot.be/feeds/posts/default/-/python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://junglecoders.blogspot.com/search/label/python"  title="JungleCoders">JungleCoders</a>
        </li>
        <li>
	  <a href="https://juracy.wordpress.com/tag/python/feed/atom/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://juracy.wordpress.com"  title="Python &#8211; Juracy Filho &#8211; Simplesmente eu">Juracy Filho</a>
        </li>
        <li>
	  <a href="http://kodumaro.blogspot.com/feeds/posts/default/-/Python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://kodumaro.blogspot.com/search/label/Python"  title="Kodumaro">Kodumaro</a>
        </li>
        <li>
	  <a href="https://lauro.wordpress.com/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://lauro.wordpress.com"  title="Lauro Moura">Lauro Moura</a>
        </li>
        <li>
	  <a href="https://lameiro.wordpress.com/tag/python/feed/atom/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://lameiro.wordpress.com"  title="Python &#8211; Blog do Lameiro">Leandro Lameiro</a>
        </li>
        <li>
	  <a href="https://linil.wordpress.com/category/python/feed/atom/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://linil.wordpress.com"  title="Python">Linil</a>
        </li>
        <li>
	  <a href="http://blog.ramgarlic.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.ramgarlic.com/"  title="Ramgarlic">Luciano Ramalho</a>
        </li>
        <li>
	  <a href="http://feeds.feedburner.com/MindBending-pt" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://mindbending.org/pt/"  title="Mind Bending em Portug&#234;s">Magnun Leno</a>
        </li>
        <li>
	  <a href="http://setanta.wordpress.com/tag/python/feed/atom" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://setanta.wordpress.com"  title="Setanta's Place">Marcelo Lira</a>
        </li>
        <li>
	  <a href="http://marrcandre.blogspot.com/feeds/posts/default/-/python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://marrcandre.blogspot.com/search/label/python"  title="marrcandr&#233;">Marco Andr&#233; Lopes Mendes</a>
        </li>
        <li>
	  <a href="https://medeubranco.wordpress.com/tag/python/feed/atom/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://medeubranco.wordpress.com"  title="Python &#8211; Me Deu Branco!">Marcos Daniel</a>
        </li>
        <li>
	  <a href="https://medium.com/@marcos.cantor" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="android-app://com.medium.reader/https/medium.com/@marcos.cantor"  class="message" title="404: not found">Marcos Stefani Rosa</a>
        </li>
        <li>
	  <a href="http://metapython.blogspot.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://metapython.blogspot.com/"  title="metapython">MetaPython</a>
        </li>
        <li>
	  <a href="http://claudiotorcato.wordpress.com/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://claudiotorcato.wordpress.com"  title="Mosaico Livre">Mosaico Livre</a>
        </li>
        <li>
	  <a href="http://nosleepforyou.blogspot.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://nosleepforyou.blogspot.com/"  title="No sleep for you">No sleep for you</a>
        </li>
        <li>
	  <a href="http://pythonologia.org/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pythonologia.org"  title="Pythonologia">Osvaldo Santana Neto</a>
        </li>
        <li>
	  <a href="https://pugpe.wordpress.com/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://pugpe.wordpress.com"  title="PUG-PE">PUG - PE</a>
        </li>
        <li>
	  <a href="https://powerpython.wordpress.com/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://powerpython.wordpress.com"  title="powerpython">PowerPython</a>
        </li>
        <li>
	  <a href="https://programandociencia.com/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://programandociencia.com"  title="python &#8211; Programando Ci&#234;ncia">Programando Ci&#234;ncia</a>
        </li>
        <li>
	  <a href="https://pythonhelp.wordpress.com/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://pythonhelp.wordpress.com"  title="python &#8211; Python Help">Python Help</a>
        </li>
        <li>
	  <a href="http://pythonnotes.blogspot.com/atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pythonnotes.blogspot.com/"  title="Python Notes">Python Notes</a>
        </li>
        <li>
	  <a href="http://pythonclub.com.br/feeds/all.atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pythonclub.com.br/"  title="PythonClub">PythonClub</a>
        </li>
        <li>
	  <a href="http://pythonidae.blogspot.com/atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://pythonidae.blogspot.com/"  title="Pythonidae">Pythonidae</a>
        </li>
        <li>
	  <a href="http://www.dieblinkenlights.com/search_rss?Subject%3Alist=python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://www.dieblinkenlights.com"  title="Dieblinkenlights">Ricardo Banffy</a>
        </li>
        <li>
	  <a href="http://blog.ricbit.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.ricbit.com/"  class="message" title="internal server error">Ricbit</a>
        </li>
        <li>
	  <a href="https://rodo.lpho.de/tags/python/index.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  title="">Rodolpho Eckhardt</a>
        </li>
        <li>
	  <a href="https://ramaral.wordpress.com/tag/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://ramaral.wordpress.com"  title="Python &#8211; Rodrigo Amaral">Rodrigo Amaral</a>
        </li>
        <li>
	  <a href="http://feeds.feedburner.com/NullOnError?format=xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://nullonerror.org/"  title="NULL on error">Rodrigo Delduca</a>
        </li>
        <li>
	  <a href="http://python-blog.blogspot.com/atom.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://python-blog.blogspot.com/"  title="Python, Zope and Plone Experiments">Ruda Filgueiras</a>
        </li>
        <li>
	  <a href="http://www.sergiomateus.ca/feeds/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a  class="message" title="internal server error">Sergio Mateus</a>
        </li>
        <li>
	  <a href="http://themindcaster.blogspot.com/feeds/posts/default" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://themindcaster.blogspot.com/"  title="The Mindcaster">The Mind Caster</a>
        </li>
        <li>
	  <a href="http://feeds.feedburner.com/pyavelino" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://avelino.run/blog/"  title="Blogs on Avelino">Thiago Avelino</a>
        </li>
        <li>
	  <a href="http://victorpoluceno.blogspot.com/feeds/posts/default/-/python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://victorpoluceno.blogspot.com/search/label/python"  title="Ni">Victor Poluceno</a>
        </li>
        <li>
	  <a href="https://www.vinta.com.br/python/feed/" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="https://www.vinta.com.br/blog/category/python/"  title="Vinta's Blog Python Tag">Vinta Software</a>
        </li>
        <li>
	  <a href="http://www.sergiofasilva.com/feed/python" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://www.sergiofasilva.com/tag/python"  title="Sergio Silva Blogue (python)">sergiofasilva.com</a>
        </li>
        <li>
	  <a href="http://blog.justen.eng.br/rss.xml" title="subscribe"> <img src="images/feed-icon-10x10.png" alt="(feed)"> </a> <a href="http://blog.justen.eng.br/"  title="Blog do @Turicas">&#193;lvaro J&#252;sten</a>
        </li>
    </ul>

    <p>
      <a href="http://wiki.python.org.br/planet/atom.xml" title="" style="border:0;text-decoration:none;">
      <img src="images/feed-icon-28x28.png" alt="Assine o feed" align="middle" border="0"/> Assine o feed
      </a>
    </p>

    <p><strong>&Uacute;ltima atualiza&ccedil;&atilde;o:</strong><br />19 de August de 2019 &#224;s 19:55</p>

    <p>Para solicitar a inclus&#227;o ou remo&#231;&#227;o de um blog neste Planet basta abrir um chamado no nosso <a href="https://github.com/pythonbrasil/apyb.gerenciamento/issues">Github</a></p>

</div>

<div class="footer">
	<p>Powered by: <a href="http://www.planetplanet.org/">Planet</a></p>
</div>
</body>

</html>
